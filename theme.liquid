
<!doctype html>
<html
 class="no-js{% if request.design_mode %} shopify-design-mode{% endif %}"
 lang="{{ request.locale.iso_code }}"
>
 <head>
 {%- render 'stylesheets' -%}

 {%- if settings.favicon != blank -%}
 <link
 rel="icon"
 type="image/png"
 href="{{ settings.favicon | image_url: width: 32, height: 32 }}"
 >
 {%- endif -%}

 {% comment %} This a way to wait for main content to load when navigating to a new page so that the view transitions can work consistently {% endcomment %}
 <link
 rel="expect"
 href="#MainContent"
 blocking="render"
 id="view-transition-render-blocker"
 >

 {%- render 'meta-tags' -%}
 {%- render 'fonts' -%}
 
 <link rel="preconnect" href="https://fonts.googleapis.com">
 <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
 
<link rel="preload" href="https://fonts.gstatic.com/s/montserrat/v26/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCtr6Hw5aXpsog.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="https://fonts.gstatic.com/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7BMSo3Sup8.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="https://fonts.gstatic.com/s/rubikwetpaint/v2/CHyfV8E1QdobPzfw3zQhFXVH_5e8.woff2" as="font" type="font/woff2" crossorigin>
 <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Dancing+Script:wght@700&family=Pacifico&family=Satisfy&family=Great+Vibes&family=Indie+Flower&family=Bebas+Neue&family=Rye&family=Creepster&family=Bungee:wght@400&family=Rubik+Wet+Paint&family=Bonheur+Royale&display=swap" rel="stylesheet">
 {%- render 'scripts' -%}
 {%- render 'theme-styles-variables' -%}
 {%- render 'color-schemes' -%}

 {% if request.design_mode %}
 {%- render 'theme-editor' -%}
 {% endif %}

 <script>
 (function(h,o,t,j,a,r){
 if (h.hj) return;
 h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
 h._hjSettings={hjid:6546658,hjsv:6};
 a=o.getElementsByTagName('head')[0];
 r=o.createElement('script');r.async=1;
 r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
 a.appendChild(r);
 })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
 </script>

 {% if product.handle == 'zdjecie-na-szkle-ramka-spotify' %}
 <script src="https://cdn.jsdelivr.net/npm/glfx@0.0.4/glfx.min.js"></script>
 {% endif %}

 <script src="https://browser.sentry-cdn.com/8.40.0/bundle.min.js" crossorigin="anonymous"></script>
 <script>
 // ‚úÖ Inicjalizuj Sentry po za≈Çadowaniu skryptu (synchronicznie)
 (function() {
 // Poczekaj a≈º Sentry bƒôdzie dostƒôpny (max 5 sekund)
 let attempts = 0;
 const maxAttempts = 50; // 50 pr√≥b √ó 100ms = 5 sekund
 
 function tryInit() {
 attempts++;
 
 if (typeof Sentry !== 'undefined' && typeof Sentry.init === 'function') {
 try {
 {% if customer %}
 Sentry.init({
 dsn: "https://562a1a160e90a597f0236fd8c6b13301@o4510439439925248.ingest.de.sentry.io/4510439517257808",
 environment: "production",
 tracesSampleRate: 0.1,
 beforeSend(event, hint) {
 // ‚úÖ FILTRUJ B≈ÅƒòDY VIEW TRANSITION - nie loguj do Sentry (tylko animacje, nie wp≈ÇywajƒÖ na funkcjonalno≈õƒá)
 if (event.exception && event.exception.values) {
 const firstException = event.exception.values[0];
 const errorMessage = firstException?.value || '';
 const errorType = firstException?.type || '';
 
 const isViewTransitionError = 
 errorMessage.includes('view transition') ||
 errorMessage.includes('ViewTransition') ||
 errorMessage.includes('Skipping view transition') ||
 errorMessage.includes('skipTransition') ||
 (errorType === 'AbortError' && errorMessage.includes('transition')) ||
 (errorType === 'AbortError' && errorMessage.toLowerCase().includes('skip'));
 
 if (isViewTransitionError) {
 console.debug('üîá [SENTRY] Ignorujƒô b≈ÇƒÖd view transition:', errorMessage);
 return null; // Nie wysy≈Çaj do Sentry
 }
 }
 
 // ‚úÖ Dodaj tag customify do wszystkich b≈Çƒôd√≥w
 if (event.tags) {
 event.tags.customify = 'true';
 } else {
 event.tags = { customify: 'true' };
 }
 if (event.user) {
 event.user.id = {{ customer.id | json }};
 event.user.email = {{ customer.email | json }};
 }
 return event;
 }
 });
 
 Sentry.setUser({
 id: {{ customer.id | json }},
 email: {{ customer.email | json }}
 });
 {% else %}
 Sentry.init({
 dsn: "https://562a1a160e90a597f0236fd8c6b13301@o4510439439925248.ingest.de.sentry.io/4510439517257808",
 environment: "production",
 tracesSampleRate: 0.1,
 beforeSend(event, hint) {
 // ‚úÖ FILTRUJ B≈ÅƒòDY VIEW TRANSITION - nie loguj do Sentry (tylko animacje, nie wp≈ÇywajƒÖ na funkcjonalno≈õƒá)
 if (event.exception && event.exception.values) {
 const firstException = event.exception.values[0];
 const errorMessage = firstException?.value || '';
 const errorType = firstException?.type || '';
 
 const isViewTransitionError = 
 errorMessage.includes('view transition') ||
 errorMessage.includes('ViewTransition') ||
 errorMessage.includes('Skipping view transition') ||
 errorMessage.includes('skipTransition') ||
 (errorType === 'AbortError' && errorMessage.includes('transition')) ||
 (errorType === 'AbortError' && errorMessage.toLowerCase().includes('skip'));
 
 if (isViewTransitionError) {
 console.debug('üîá [SENTRY] Ignorujƒô b≈ÇƒÖd view transition:', errorMessage);
 return null; // Nie wysy≈Çaj do Sentry
 }
 }
 
 // ‚úÖ Dodaj tag customify do wszystkich b≈Çƒôd√≥w
 if (event.tags) {
 event.tags.customify = 'true';
 } else {
 event.tags = { customify: 'true' };
 }
 return event;
 }
 });
 {% endif %}
 
 console.log('‚úÖ [SENTRY] Initialized successfully');
 window.__sentryInitialized = true;
 } catch (error) {
 console.error('‚ùå [SENTRY] Initialization error:', error);
 }
 } else if (attempts < maxAttempts) {
 // Spr√≥buj ponownie za 100ms
 setTimeout(tryInit, 100);
 } else {
 console.warn('‚ö†Ô∏è [SENTRY] Failed to load after ' + maxAttempts + ' attempts. Check Network tab for browser.sentry-cdn.com');
 }
 }
 
 // Rozpocznij pr√≥by inicjalizacji natychmiast
 tryInit();
 })();
 </script>

 <script>
 (function() {
 // ‚úÖ Przechwytuj nieobs≈Çu≈ºone b≈Çƒôdy JavaScript
 window.addEventListener('error', function(event) {
 const error = event.error || event;
 const errorMessage = error.message || event.message || 'Unknown error';
 const errorStack = error.stack || '';
 
 // ‚úÖ Sprawd≈∫ czy to b≈ÇƒÖd z motywu Shopify (aspectRatioHelper, processNewElements)
 const isThemeError = 
 errorMessage.includes('aspectRatioHelper') ||
 errorMessage.includes('processNewElements') ||
 errorMessage.includes('#aspectRatioHelper') ||
 errorStack.includes('aspectRatioHelper') ||
 errorStack.includes('processNewElements');
 
 if (isThemeError) {
 // ‚úÖ Zapobiegaj crashowi - loguj do Sentry ale nie przerywaj dzia≈Çania
 console.warn('‚ö†Ô∏è [THEME-ERROR-HANDLER] Przechwycono b≈ÇƒÖd z motywu Shopify:', errorMessage);
 
 // ‚úÖ Loguj do Sentry z pe≈Çnym kontekstem
 if (typeof Sentry !== 'undefined' && window.__sentryInitialized) {
 Sentry.withScope((scope) => {
 scope.setTag('customify', 'true');
 scope.setTag('error_type', 'theme_error');
 scope.setTag('error_source', 'shopify_theme');
 scope.setTag('theme_component', 'aspectRatioHelper');
 scope.setContext('theme_error', {
 errorMessage: errorMessage,
 errorStack: errorStack.substring(0, 1000), // Max 1000 chars
 url: window.location.href,
 userAgent: navigator.userAgent,
 timestamp: new Date().toISOString()
 });
 Sentry.captureException(error);
 });
 }
 
 // ‚úÖ Zapobiegaj domy≈õlnemu zachowaniu (nie pokazuj w konsoli jako nieobs≈Çu≈ºony b≈ÇƒÖd)
 event.preventDefault();
 return false;
 }
 
 // ‚úÖ Dla innych b≈Çƒôd√≥w - pozw√≥l Sentry je obs≈Çu≈ºyƒá normalnie
 return true;
 }, true); // useCapture = true (przechwytuj PRZED innymi handlerami)
 
 // ‚úÖ Przechwytuj nieobs≈Çu≈ºone promise rejections
 window.addEventListener('unhandledrejection', function(event) {
 const error = event.reason || event;
 const errorMessage = error?.message || String(error) || 'Unknown promise rejection';
 const errorStack = error?.stack || '';
 
 // ‚úÖ Sprawd≈∫ czy to b≈ÇƒÖd z motywu Shopify
 const isThemeError = 
 errorMessage.includes('aspectRatioHelper') ||
 errorMessage.includes('processNewElements') ||
 errorMessage.includes('#aspectRatioHelper') ||
 errorStack.includes('aspectRatioHelper') ||
 errorStack.includes('processNewElements');
 
 if (isThemeError) {
 console.warn('‚ö†Ô∏è [THEME-ERROR-HANDLER] Przechwycono promise rejection z motywu Shopify:', errorMessage);
 
 // ‚úÖ Loguj do Sentry
 if (typeof Sentry !== 'undefined' && window.__sentryInitialized) {
 Sentry.withScope((scope) => {
 scope.setTag('customify', 'true');
 scope.setTag('error_type', 'theme_promise_rejection');
 scope.setTag('error_source', 'shopify_theme');
 scope.setTag('theme_component', 'aspectRatioHelper');
 scope.setContext('theme_error', {
 errorMessage: errorMessage,
 errorStack: errorStack.substring(0, 1000),
 url: window.location.href,
 timestamp: new Date().toISOString()
 });
 Sentry.captureException(error);
 });
 }
 
 // ‚úÖ Zapobiegaj domy≈õlnemu zachowaniu
 event.preventDefault();
 }
 });
 
 console.log('‚úÖ [THEME-ERROR-HANDLER] Global error handler zainstalowany');
 
 // ‚úÖ VIEW TRANSITION ERROR HANDLER - Ignoruj b≈Çƒôdy animacji (nieistotne)
 // B≈Çƒôdy view transition to tylko animacje przej≈õƒá miƒôdzy stronami - nie wp≈ÇywajƒÖ na funkcjonalno≈õƒá
 window.addEventListener('error', function(event) {
 const error = event.error || event;
 const errorMessage = error.message || event.message || '';
 
 // ‚úÖ Sprawd≈∫ czy to b≈ÇƒÖd view transition
 const isViewTransitionError = 
 errorMessage.includes('view transition') ||
 errorMessage.includes('ViewTransition') ||
 errorMessage.includes('skipTransition') ||
 errorMessage.includes('Skipping view transition') ||
 error.name === 'AbortError' && errorMessage.includes('transition');
 
 if (isViewTransitionError) {
 // ‚úÖ Ignoruj - to tylko animacje, nie wp≈ÇywajƒÖ na funkcjonalno≈õƒá
 console.debug('üîá [VIEW-TRANSITION] Ignorujƒô b≈ÇƒÖd animacji:', errorMessage);
 event.preventDefault();
 return false; // Nie loguj do Sentry
 }
 }, true);
 
 // ‚úÖ VIEW TRANSITION PROMISE REJECTION HANDLER
 window.addEventListener('unhandledrejection', function(event) {
 const error = event.reason || event;
 const errorMessage = error?.message || String(error) || '';
 
 const isViewTransitionError = 
 errorMessage.includes('view transition') ||
 errorMessage.includes('ViewTransition') ||
 errorMessage.includes('skipTransition') ||
 errorMessage.includes('Skipping view transition') ||
 (error?.name === 'AbortError' && errorMessage.includes('transition'));
 
 if (isViewTransitionError) {
 // ‚úÖ Ignoruj - to tylko animacje
 console.debug('üîá [VIEW-TRANSITION] Ignorujƒô promise rejection animacji:', errorMessage);
 event.preventDefault();
 }
 });
 
 console.log('‚úÖ [VIEW-TRANSITION-HANDLER] View transition error handler zainstalowany');
 })();
 </script>

 <link rel="stylesheet" href="{{ 'customify.css' | asset_url }}">
 {% if product and product.handle == 'ramka-spotify' or product.handle == 'zdjecie-na-szkle-ramka-spotify' or product.handle == 'personalizowane-etui-na-telefon-z-twoim-zdjeciem' %}
 <link rel="stylesheet" href="https://unpkg.com/cropperjs@1.6.2/dist/cropper.min.css">
 {% endif %}

 {% if template contains 'product' %}
 {% if product.featured_image %}
 <link rel="preload" as="image" href="{{ product.featured_image | image_url: width: 800 }}">
 {% endif %}
 {% for media in product.media limit: 3 %}
 {% if media.media_type == 'image' %}
 <link rel="preload" as="image" href="{{ media | image_url: width: 800 }}">
 {% endif %}
 {% endfor %}
 {% endif %}

 <script>
 {% if customer %}
 // METODA 1: Shopify Liquid (customer object detected)
 window.ShopifyCustomer = {
 loggedIn: true,
 id: {{ customer.id | json }},
 email: {{ customer.email | json }},
 firstName: {{ customer.first_name | json }},
 lastName: {{ customer.last_name | json }}
 };
 console.log('‚úÖ [CUSTOMIFY LIQUID] Zalogowany u≈ºytkownik:', window.ShopifyCustomer);
 {% else %}
 // U≈ºytkownik niezalogowany
 window.ShopifyCustomer = null;
 console.log('üë§ [CUSTOMIFY LIQUID] U≈ºytkownik niezalogowany');
 {% endif %}
 </script>
 
 <script src="{{ 'customify.js' | asset_url }}" defer></script>
 {% if product and product.handle == 'ramka-spotify' or product.handle == 'zdjecie-na-szkle-ramka-spotify' or product.handle == 'personalizowane-etui-na-telefon-z-twoim-zdjeciem' %}
 <script src="https://unpkg.com/cropperjs@1.6.2/dist/cropper.min.js" defer></script>
 {% if product.handle == 'personalizowane-etui-na-telefon-z-twoim-zdjeciem' %}
 <script>
 // üì± Etui - wymu≈õ poprawne proporcje kontenera (559:1154)
 document.addEventListener('DOMContentLoaded', function() {
 function fixPhoneCaseAspectRatio() {
 const containers = document.querySelectorAll('#customify-app-container .phone-case-inner');
 console.log('üì± [PHONE-CASE] Found containers:', containers.length);
 containers.forEach((container, index) => {
 const parent = container.closest('.phone-case-preview');
 const previewArea = container.closest('#previewArea');
 const appContainer = container.closest('#customify-app-container');
 console.log(`üì± [PHONE-CASE] Container ${index} parent widths:`);
 console.log(` - container: ${container.offsetWidth}px`);
 console.log(` - phoneCasePreview: ${parent ? parent.offsetWidth + 'px' : 'N/A'}`);
 console.log(` - previewArea: ${previewArea ? previewArea.offsetWidth + 'px' : 'N/A'}`);
 console.log(` - appContainer: ${appContainer ? appContainer.offsetWidth + 'px' : 'N/A'}`);
 const width = container.offsetWidth;
 if (width > 0) {
 const correctHeight = width * (1154 / 559);
 console.log(`üì± [PHONE-CASE] Setting height: ${correctHeight}px (was: ${container.offsetHeight}px)`);
 container.style.height = correctHeight + 'px';
 container.style.paddingTop = '0';
 console.log(`üì± [PHONE-CASE] After fix: width=${container.offsetWidth}px, height=${container.offsetHeight}px`);
 } else {
 console.warn(`üì± [PHONE-CASE] Container ${index} has width=0, skipping`);
 }
 });
 }
 console.log('üì± [PHONE-CASE] Initializing aspect ratio fix...');
 fixPhoneCaseAspectRatio();
 window.addEventListener('resize', fixPhoneCaseAspectRatio);
 // Retry po za≈Çadowaniu obrazk√≥w
 setTimeout(fixPhoneCaseAspectRatio, 500);
 setTimeout(fixPhoneCaseAspectRatio, 1000);
 });
 </script>
 {% endif %}
 {% endif %}
 {% if product and product.handle == 'ramka-spotify' or product.handle == 'zdjecie-na-szkle-ramka-spotify' %}
 <script>
 // üéµ Spotify Text Overlay - aktualizacja tekstu w czasie rzeczywistym
 document.addEventListener('DOMContentLoaded', function() {
 const titleInput = document.getElementById('spotifyTitle');
 const artistInput = document.getElementById('spotifyArtist');
 // Teksty w preview
 const titleDisplayPreview = document.getElementById('spotifyTextTitlePreview');
 const artistDisplayPreview = document.getElementById('spotifyTextArtistPreview');
 // Teksty w result
 const titleDisplayResult = document.getElementById('spotifyTextTitle');
 const artistDisplayResult = document.getElementById('spotifyTextArtist');
 // Liczniki
 const titleCounter = document.getElementById('spotifyTitleCounter');
 const artistCounter = document.getElementById('spotifyArtistCounter');
 
 function updateSpotifyText() {
 const titleText = titleInput ? titleInput.value : '';
 const artistText = artistInput ? artistInput.value : '';
 
 // Aktualizuj tekst na ramce (preview)
 if (titleDisplayPreview) titleDisplayPreview.textContent = titleText;
 if (artistDisplayPreview) artistDisplayPreview.textContent = artistText;
 // Aktualizuj tekst na ramce (result)
 if (titleDisplayResult) titleDisplayResult.textContent = titleText;
 if (artistDisplayResult) artistDisplayResult.textContent = artistText;
 
 // Aktualizuj liczniki
 if (titleCounter && titleInput) {
 titleCounter.textContent = titleInput.value.length + '/' + titleInput.maxLength;
 }
 if (artistCounter && artistInput) {
 artistCounter.textContent = artistInput.value.length + '/' + artistInput.maxLength;
 }
 }
 
 // Nas≈Çuchuj zmian w polach
 if (titleInput) titleInput.addEventListener('input', updateSpotifyText);
 if (artistInput) artistInput.addEventListener('input', updateSpotifyText);
 
 // Inicjalizuj
 updateSpotifyText();
 console.log('üéµ [SPOTIFY TEXT] Initialized');
 });
 </script>
 {% endif %}
 <script>
 (function() {
 function applyCustomifyCartOverride() {
 const instance = window.__customify;
 if (!instance) {
 return false;
 }

 const proto = Object.getPrototypeOf(instance);
 if (!proto) {
 return false;
 }

 if (proto.__customifyHiddenPropsPatched) {
 return true;
 }

 proto.__customifyHiddenPropsPatched = true;

 proto.updateCartNoteAttributes = async function(noteAttributes) {
 console.log('üìù [CUSTOMIFY] Pomijam /cart/update.js ‚Äì atrybuty lƒÖdujƒÖ jako ukryte properties:', noteAttributes);
 return noteAttributes || {};
 };

 const originalShowError = proto.showError;
 proto.showError = function(message, type) {
 try {
 const rawMessage = message == null ? '' : String(message);
 const normalizedMessage = rawMessage.replace(/^‚ùå\s*/, '').trim();
 const validationMessages = [
 'Wybierz styl',
 'Nie wybra≈Çe≈õ rozmiaru',
 'Wgraj zdjƒôcie i wybierz styl'
 ];
 const isValidation = validationMessages.some(msg => normalizedMessage.includes(msg));
 if (isValidation && typeof window.__customifyProductStatsSendEvent === 'function') {
 window.__customifyProductStatsSendEvent('validation_error', {
 message: normalizedMessage,
 area: type || 'unknown'
 });
 }
 } catch (error) {
 console.warn('‚ö†Ô∏è [CUSTOMIFY] Validation tracking failed:', error?.message || error);
 }
 return originalShowError ? originalShowError.call(this, message, type) : undefined;
 };

 /**
 * Pobiera bazowƒÖ cenƒô produktu z window.ShopifyProduct (niezmienione ≈∫r√≥d≈Ço)
 */
 proto.getBasePriceFromShopify = function() {
 if (window.ShopifyProduct && window.ShopifyProduct.variants && window.ShopifyProduct.variants.length > 0) {
 // variants[0].price jest w groszach, konwertuj na z≈Çot√≥wki
 const priceInGrosz = parseFloat(window.ShopifyProduct.variants[0].price);
 const priceInZl = priceInGrosz / 100;
 console.log(`üí∞ [BASE-PRICE] Pobrano z window.ShopifyProduct: ${priceInZl} z≈Ç (${priceInGrosz} groszy)`);
 return priceInZl;
 }
 console.warn('‚ö†Ô∏è [BASE-PRICE] window.ShopifyProduct.variants nie dostƒôpne, u≈ºywam fallback');
 return null;
 };

 // üö® ROLLBACK: START - Nadpisanie updateProductPrice() dla produktu cyfrowego
 proto.updateProductPrice = function() {
 try {
 const isDigitalProduct = this.selectedProductType === 'digital';
 
 // Dla produktu cyfrowego: ZAWSZE 49 z≈Ç, NIE sumuj z cenƒÖ bazowƒÖ
 if (isDigitalProduct) {
 const digitalProductPrice = 49.00; // üö® ROLLBACK: Sta≈Ça cena produktu cyfrowego
 this.applyProductPriceDisplay(digitalProductPrice);
 this.schedulePriceConsistency(digitalProductPrice);
 console.log('üí∞ [PRICE] Digital product - fixed price: 49.00 z≈Ç (ignoring base price)');
 return;
 }
 
 // Dla produkt√≥w fizycznych: u≈ºyj oryginalnej logiki
 const priceElement = this.getPriceElement();
 if (!priceElement) {
 console.warn('‚ö†Ô∏è [PRICE] Price element not found with any selector');
 return;
 }

 console.log('‚úÖ [PRICE] Found price element:', priceElement, 'Text:', priceElement.textContent);

 // Pobierz oryginalnƒÖ bazowƒÖ cenƒô (zapamiƒôtaj przy pierwszym wywo≈Çaniu)
 if (!this.originalBasePrice) {
 // ‚úÖ U≈ºyj window.ShopifyProduct (niezmienione ≈∫r√≥d≈Ço) zamiast DOM
 this.originalBasePrice = this.getBasePriceFromShopify();
 
 if (this.originalBasePrice === null) {
 // Fallback: spr√≥buj z DOM je≈õli window.ShopifyProduct nie dostƒôpne
 const basePriceText = priceElement.textContent;
 this.originalBasePrice = this.extractBasePrice(basePriceText);
 
 if (this.originalBasePrice === null) {
 console.warn('‚ö†Ô∏è [PRICE] Could not get base price from Shopify or DOM, using fallback');
 this.originalBasePrice = 49.00;
 console.log(`üí∞ [PRICE] Using fallback base price: ${this.originalBasePrice} z≈Ç`);
 } else {
 console.log(`üí∞ [PRICE] Base price from DOM (fallback): ${this.originalBasePrice} z≈Ç`);
 }
 } else {
 console.log(`üí∞ [PRICE] Original base price saved: ${this.originalBasePrice} z≈Ç`);
 }
 }

 // Pobierz cenƒô rozmiaru
 const sizePrice = this.getSizePrice(this.selectedSize);
 
 // Dop≈Çata za ramkƒô (tylko plakat i wybrany kolor != none)
 const frameSelected = (this.selectedProductType === 'plakat') && (window.CustomifyFrame && window.CustomifyFrame.color && window.CustomifyFrame.color !== 'none');
 const frameSurcharge = frameSelected && this.selectedSize ? (this.framePricing[this.selectedSize] || 29) : 0;
 
 // üÜï Dop≈Çata za podstawkƒô (tylko szk≈Ço i wybrany typ != none)
 const standSelected = (this.selectedProductType === 'szklo') && (window.CustomifyStand && window.CustomifyStand.type && window.CustomifyStand.type !== 'none');
 const standSurcharge = standSelected ? (this.standPricing[window.CustomifyStand.type] || 0) : 0;
 
 // Oblicz ko≈ÑcowƒÖ cenƒô (oryginalna cena + rozmiar + ramka + podstawka)
 const finalPrice = this.originalBasePrice + sizePrice + frameSurcharge + standSurcharge;
 
 // Aktualizuj cenƒô na stronie
 this.applyProductPriceDisplay(finalPrice);
 this.schedulePriceConsistency(finalPrice);
 
 console.log(`üí∞ [PRICE] Updated: base ${this.originalBasePrice} + size ${sizePrice} + frame ${frameSurcharge} + stand ${standSurcharge} = ${finalPrice} z≈Ç`);
 } catch (error) {
 console.error('‚ùå [PRICE] Error updating product price:', error);
 }
 };
 // üö® ROLLBACK: END - Nadpisanie updateProductPrice()

 // üö® ROLLBACK: START - Nadpisanie updateCartPrice() dla produktu cyfrowego
 proto.updateCartPrice = function() {
 try {
 const isDigitalProduct = this.selectedProductType === 'digital';
 
 // Dla produktu cyfrowego: ZAWSZE 49 z≈Ç, NIE sumuj z cenƒÖ bazowƒÖ
 if (isDigitalProduct) {
 const digitalProductPrice = 49.00; // üö® ROLLBACK: Sta≈Ça cena produktu cyfrowego
 const cartPriceElement = document.getElementById('cartPriceValue');
 
 if (cartPriceElement) {
 cartPriceElement.textContent = `${digitalProductPrice.toFixed(2)} z≈Ç`;
 console.log('‚úÖ [CART-PRICE] Digital product - fixed price: 49.00 z≈Ç (ignoring base price)');
 this.showCartPrice();
 } else {
 console.warn('‚ö†Ô∏è [CART-PRICE] Cart price element not found');
 }
 return;
 }
 
 // Dla produkt√≥w fizycznych: u≈ºyj oryginalnej logiki
 // Sprawd≈∫ czy mamy wybrany rozmiar
 if (!this.selectedSize) {
 console.log('üîç [CART-PRICE] No selectedSize, hiding cart price');
 this.hideCartPrice();
 return;
 }

 // Pobierz oryginalnƒÖ bazowƒÖ cenƒô
 if (!this.originalBasePrice) {
 this.originalBasePrice = 49.00; // Fallback
 console.log(`üí∞ [CART-PRICE] Using fallback base price: ${this.originalBasePrice} z≈Ç`);
 }

 // Pobierz cenƒô rozmiaru
 const sizePrice = this.getSizePrice(this.selectedSize);
 
 // Dop≈Çata za ramkƒô (tylko plakat i wybrany kolor != none)
 const frameSelected = (this.selectedProductType === 'plakat') && (window.CustomifyFrame && window.CustomifyFrame.color && window.CustomifyFrame.color !== 'none');
 const frameSurcharge = frameSelected && this.selectedSize ? (this.framePricing[this.selectedSize] || 29) : 0;
 
 // üÜï Dop≈Çata za podstawkƒô (tylko szk≈Ço i wybrany typ != none)
 const standSelected = (this.selectedProductType === 'szklo') && (window.CustomifyStand && window.CustomifyStand.type && window.CustomifyStand.type !== 'none');
 const standSurcharge = standSelected ? (this.standPricing[window.CustomifyStand.type] || 0) : 0;
 
 // Oblicz ko≈ÑcowƒÖ cenƒô (bazowa + rozmiar + ramka + podstawka)
 const finalPrice = this.originalBasePrice + sizePrice + frameSurcharge + standSurcharge;

 // Znajd≈∫ element ceny w koszyku
 const cartPriceElement = document.getElementById('cartPriceValue');

 if (cartPriceElement) {
 cartPriceElement.textContent = `${finalPrice.toFixed(2)} z≈Ç`;
 console.log('‚úÖ [CART-PRICE] Cart price updated:', finalPrice.toFixed(2), 'z≈Ç');
 console.log('üñºÔ∏è [FRAME] Cart price components:', {
 base: this.originalBasePrice,
 sizePrice,
 frameSelected,
 frame: window.CustomifyFrame?.color || 'none',
 frameSurcharge,
 standSelected,
 stand: window.CustomifyStand?.type || 'none',
 standSurcharge
 });

 // Poka≈º element ceny
 this.showCartPrice();
 } else {
 console.warn('‚ö†Ô∏è [CART-PRICE] Cart price element not found');
 }
 } catch (error) {
 console.error('‚ùå [CART-PRICE] Error updating cart price:', error);
 }
 };
 // üö® ROLLBACK: END - Nadpisanie updateCartPrice()

 // üö® ROLLBACK: START - Nadpisanie showResult() dla produktu cyfrowego (ukryj rozmiary)
 proto.showResult = async function(imageUrl) {
 console.log('üéØ [CUSTOMIFY] showResult called, hiding actionsArea and stylesArea');
 
 const isDigitalProduct = this.selectedProductType === 'digital';
 
 // ‚úÖ ZABEZPIECZENIE: Sprawd≈∫ czy resultImage istnieje, je≈õli nie - znajd≈∫ ponownie
 if (!this.resultImage) {
 console.warn('‚ö†Ô∏è [CUSTOMIFY] resultImage not found, searching again...');
 this.resultImage = document.getElementById('resultImage');
 if (!this.resultImage) {
 console.error('‚ùå [CUSTOMIFY] resultImage element not found in DOM!');
 return; // Nie kontynuuj je≈õli element nie istnieje
 }
 }
 
 // ‚úÖ TYLKO BACKEND WATERMARK (PNG z Sharp) - BEZ CANVAS FALLBACK!
 // Je≈õli backend watermark nie istnieje = b≈ÇƒÖd transformacji (nie powinno siƒô zdarzyƒá)
 let imageToShow = imageUrl; // Domy≈õlnie orygina≈Ç (bez watermarku - tylko do podglƒÖdu)
 
 // Sprawd≈∫ czy mamy watermarkedImageUrl z backendu (z response transform.js)
 if (this.watermarkedImageUrl) {
 console.log('‚úÖ [CUSTOMIFY] U≈ºywam backend watermarkedImageUrl (Sharp PNG, 92% quality)');
 imageToShow = this.watermarkedImageUrl;
 } else {
 // ‚ùå BRAK BACKEND WATERMARK = B≈ÅƒÑD (transformacja siƒô nie powiod≈Ça)
 console.error('‚ùå [CUSTOMIFY] Brak backend watermarkedImageUrl - transformacja failnƒô≈Ça!');
 console.error('‚ùå [CUSTOMIFY] Pokazujƒô orygina≈Ç bez watermarku (tylko podglƒÖd - NIE MO≈ªNA dodaƒá do koszyka)');
 imageToShow = imageUrl; // Pokazujemy orygina≈Ç bez watermarku (tylko podglƒÖd)
 }
 
 // ‚úÖ Vercel Blob: u≈ºyj proxy (CORS blokuje bezpo≈õrednie ≈Çadowanie - inspiracja z ramka-spotify u≈ºywajƒÖcej img)
 if (imageToShow && imageToShow.includes('blob.vercel-storage.com')) {
 imageToShow = 'https://customify-s56o.vercel.app/api/proxy-image?url=' + encodeURIComponent(imageToShow);
 }
 // üì± Phone case: poka≈º resultArea (jak inne produkty) - cena i przycisk wewnƒÖtrz
 if (this.isPhonePhotoCaseProduct && this.isPhonePhotoCaseProduct()) {
 const resultBg = document.getElementById('phoneCaseResultBg');
 if (resultBg) resultBg.style.backgroundImage = `url(${imageToShow})`;
 if (this.resultImage) this.resultImage.src = imageToShow;
 this.resultArea.style.display = 'block';
 } else {
 // Normal products: use resultImage and show resultArea
 if (this.resultImage) {
 this.resultImage.src = imageToShow;
 }
 this.resultArea.style.display = 'block';
 }
 
 console.log('üé® [CUSTOMIFY] Obraz ustawiony:', imageToShow?.substring(0, 100) + '...');
 
 // üö® ROLLBACK: START - Ukryj rozmiary dla produktu cyfrowego
 if (isDigitalProduct) {
 this.sizeArea.style.display = 'none';
 console.log('üì¶ [DIGITAL] Size area hidden in showResult() for digital product');
 } else {
 this.sizeArea.style.display = 'block';
 console.log('üéØ [CUSTOMIFY] Size area visible on top (outside resultArea)');
 }
 // üö® ROLLBACK: END - Ukryj rozmiary dla produktu cyfrowego
 
 // UKRYJ przyciski "Przekszta≈Çƒá z AI" i "Resetuj" (g≈Ç√≥wne actionsArea)
 this.actionsArea.style.display = 'none';
 console.log('üéØ [CUSTOMIFY] actionsArea hidden:', this.actionsArea.style.display);
 
 // UKRYJ style po przekszta≈Çceniu
 this.stylesArea.style.display = 'none';
 console.log('üéØ [CUSTOMIFY] stylesArea hidden:', this.stylesArea.style.display);
 
 // Zmie≈Ñ kolory przycisk√≥w po wygenerowaniu AI
 this.swapButtonColors();
 
 // UKRYJ pole upload po przekszta≈Çceniu
 this.uploadArea.style.display = 'none';
 console.log('üéØ [CUSTOMIFY] uploadArea hidden:', this.uploadArea.style.display);
 
 // ‚úÖ POKA≈ª CENƒò NAD PRZYCISKIEM po wygenerowaniu AI
 this.updateCartPrice();
 };
 // üö® ROLLBACK: END - Nadpisanie showResult()

 proto.addToCart = async function() {
 // ‚úÖ POKA≈ª LOADING od razu - dodawanie do koszyka mo≈ºe trwaƒá
 this.showCartLoading();
 
 console.log('üõí [CUSTOMIFY] addToCart called with:', {
 transformedImage: !!this.transformedImage,
 selectedStyle: this.selectedStyle,
 selectedSize: this.selectedSize,
 selectedProductType: this.selectedProductType
 });

 // üö® ROLLBACK: START - Pomijaj rozmiar dla produktu cyfrowego
 const isDigitalProduct = this.selectedProductType === 'digital';
 
 if (!isDigitalProduct) {
 console.log('üîç [CUSTOMIFY] Checking selectedSize:', this.selectedSize);
 if (!this.selectedSize) {
 console.log('‚ùå [CUSTOMIFY] No selectedSize, showing error');
 this.showError('Nie wybra≈Çe≈õ rozmiaru');
 this.hideCartLoading();
 return;
 }
 console.log('‚úÖ [CUSTOMIFY] selectedSize OK, proceeding with price calculation');
 } else {
 console.log('‚úÖ [CUSTOMIFY] Digital product - skipping size requirement');
 }
 // üö® ROLLBACK: END - Pomijaj rozmiar dla produktu cyfrowego

 // üö® ROLLBACK: START - Cena dla produktu cyfrowego (STA≈ÅA 49 z≈Ç, NIE sumuje siƒô z cenƒÖ bazowƒÖ)
 const isDigitalProductForPrice = this.selectedProductType === 'digital';
 const digitalProductPrice = 49.00; // üö® ROLLBACK: Sta≈Ça cena produktu cyfrowego
 
 let finalPrice;
 if (isDigitalProductForPrice) {
 // Produkt cyfrowy: ZAWSZE 49 z≈Ç, NIE zale≈ºy od ceny bazowej produktu
 finalPrice = digitalProductPrice;
 console.log('üí∞ [CUSTOMIFY] Digital product - using fixed price: 49.00 z≈Ç (ignoring base price)');
 } else {
 // Produkt fizyczny: cena bazowa + rozmiar + ramka + podstawka
 const basePrice = this.originalBasePrice || 49.00;
 const sizePrice = this.getSizePrice(this.selectedSize);
 const frameSelected = (this.selectedProductType === 'plakat') && (window.CustomifyFrame && window.CustomifyFrame.color && window.CustomifyFrame.color !== 'none');
 console.log('üîç [CUSTOMIFY] Frame debug:', { 
 frameSelected, 
 selectedSize: this.selectedSize, 
 framePricing: this.framePricing,
 framePricingValue: this.framePricing?.[this.selectedSize]
 });
 const frameSurcharge = frameSelected && this.selectedSize ? (this.framePricing?.[this.selectedSize] || 29) : 0;
 
 // üÜï Dop≈Çata za podstawkƒô (tylko szk≈Ço i wybrany typ != none)
 const standSelected = (this.selectedProductType === 'szklo') && (window.CustomifyStand && window.CustomifyStand.type && window.CustomifyStand.type !== 'none');
 const standSurcharge = standSelected ? (this.standPricing[window.CustomifyStand.type] || 0) : 0;
 
 finalPrice = basePrice + sizePrice + frameSurcharge + standSurcharge;
 console.log('üí∞ [CUSTOMIFY] Physical product - price calculation:', { basePrice, sizePrice, frameSurcharge, standSurcharge, finalPrice });
 }
 // üö® ROLLBACK: END - Cena dla produktu cyfrowego

 console.log('üí∞ [CUSTOMIFY] Price calculation:', {
 isDigitalProduct: isDigitalProductForPrice,
 originalBasePrice: this.originalBasePrice,
 finalPrice: finalPrice,
 size: this.selectedSize,
 productType: this.selectedProductType
 });

 if (!this.transformedImage) {
 this.showError('Brak przekszta≈Çconego obrazu');
 return;
 }

 if (!this.selectedStyle) {
 this.showError('Wybierz styl');
 return;
 }

 console.log('üõí [CUSTOMIFY] Starting addToCart process...');
 this.hideError();
 this.showCartLoading();

 try {
 const productId =
 document.querySelector('[data-product-id]')?.getAttribute('data-product-id') ||
 document.querySelector('form[action*="/cart/add"] input[name="id"]')?.value ||
 window.ShopifyAnalytics?.meta?.product?.id ||
 null;

 console.log('üÜî [CUSTOMIFY] Original product ID:', productId);

 if (!finalPrice || finalPrice <= 0) {
 console.error('‚ùå [CUSTOMIFY] Invalid finalPrice:', finalPrice);
 this.showError('B≈ÇƒÖd obliczania ceny. Spr√≥buj ponownie.');
 return;
 }

 let originalImage;
 if (this.uploadedFile) {
 originalImage = await this.fileToBase64(this.uploadedFile);
 } else if (this.originalImageFromGallery) {
 originalImage = this.originalImageFromGallery;
 } else {
 originalImage = this.transformedImage;
 console.warn('‚ö†Ô∏è [CUSTOMIFY] No original image available, using transformed image as fallback');
 }

 // üéµ SPOTIFY: Komponuj finalny obraz z maskƒÖ i tekstami
 let finalTransformedImage = this.transformedImage;
 let watermarkedImageUrl = this.watermarkedImageUrl || null;
 let needsBackendWatermark = false;
 
 // üì± ETUI: wyciƒôty kadr (jak ramka Spotify)
 if (this.isPhonePhotoCaseProduct() && this.phonePhotoCropConfirmed && this.phonePhotoCropDataUrl) {
 finalTransformedImage = this.phonePhotoCropDataUrl;
 watermarkedImageUrl = null;
 needsBackendWatermark = true;
 }
 
 if (this.isSpotifyProduct()) {
 console.log('üéµ [SPOTIFY] Composing final image with mask and texts...');
 try {
 const composedImages = await this.composeSpotifyImage();
 console.log('‚úÖ [SPOTIFY] Images composed - PNG:', composedImages.png.length, 'Preview:', composedImages.preview.length);
 
 // üéµ Upload PNG (do druku - przezroczysty) na Vercel Blob
 console.log('üéµ [SPOTIFY] Uploading PNG (for print) to Vercel Blob...');
 const uploadPngResponse = await fetch('https://customify-s56o.vercel.app/api/upload-temp-image', {
 method: 'POST',
 headers: { 'Content-Type': 'application/json' },
 body: JSON.stringify({
 imageData: composedImages.png,
 filename: `spotify-print-${Date.now()}.png`
 })
 });
 
 if (!uploadPngResponse.ok) {
 throw new Error('Failed to upload PNG to Vercel Blob');
 }
 
 const uploadPngResult = await uploadPngResponse.json();
 console.log('‚úÖ [SPOTIFY] PNG uploaded:', uploadPngResult.url);
 
 // üéµ Upload JPEG z szarym t≈Çem (do koszyka - podglƒÖd)
 console.log('üéµ [SPOTIFY] Uploading JPEG preview to Vercel Blob...');
 const uploadPreviewResponse = await fetch('https://customify-s56o.vercel.app/api/upload-temp-image', {
 method: 'POST',
 headers: { 'Content-Type': 'application/json' },
 body: JSON.stringify({
 imageData: composedImages.preview,
 filename: `spotify-preview-${Date.now()}.jpg`
 })
 });
 
 if (!uploadPreviewResponse.ok) {
 throw new Error('Failed to upload preview to Vercel Blob');
 }
 
 const uploadPreviewResult = await uploadPreviewResponse.json();
 console.log('‚úÖ [SPOTIFY] Preview uploaded:', uploadPreviewResult.url);
 
 // PNG (przezroczysty) idzie do druku, JPEG (szare t≈Ço) do koszyka
 finalTransformedImage = uploadPngResult.url; // Do druku
 this.spotifyPreviewUrl = uploadPreviewResult.url; // Do koszyka
 
 // Dla spotify - backend musi dodaƒá watermark do skomponowanego obrazu
 watermarkedImageUrl = null;
 needsBackendWatermark = true;
 } catch (err) {
 console.error('‚ùå [SPOTIFY] Failed to compose/upload image:', err);
 this.showError('Nie uda≈Ço siƒô przygotowaƒá obrazu. Spr√≥buj ponownie.', 'cart');
 this.hideCartLoading();
 return;
 }
 }
 
 // ‚úÖ TYLKO BACKEND WATERMARK - ju≈º jest na Vercel Blob, nie trzeba uploadowaƒá ponownie!
 if (!watermarkedImageUrl && !needsBackendWatermark) {
 console.error('‚ùå [CUSTOMIFY] Brak backend watermarkedImageUrl - nie mo≈ºna dodaƒá do koszyka!');
 alert('WystƒÖpi≈Ç b≈ÇƒÖd podczas generowania obrazu. Spr√≥buj wygenerowaƒá obraz ponownie klikajƒÖc "Przekszta≈Çƒá z AI".');
 this.hideCartLoading();
 return; // Blokada dodania do koszyka
 }
 
 if (watermarkedImageUrl) {
 console.log('‚úÖ [CUSTOMIFY] U≈ºywam backend watermarkedImageUrl (ju≈º na Vercel Blob):', watermarkedImageUrl.substring(0, 100));
 } else {
 console.log('üéµ [SPOTIFY] Backend doda watermark do skomponowanego obrazu');
 }

 // üñºÔ∏è Pobierz informacje o ramce (plakat)
 const selectedFrame = (this.selectedProductType === 'plakat' && window.CustomifyFrame && window.CustomifyFrame.color)
 ? window.CustomifyFrame.color
 : 'none';
 const frameSelected = selectedFrame !== 'none';
 const frameSurcharge = frameSelected && this.selectedSize ? (this.framePricing?.[this.selectedSize] || 29) : 0;
 
 // üÜï Pobierz informacje o podstawce (szk≈Ço)
 const selectedStand = (this.selectedProductType === 'szklo' && window.CustomifyStand && window.CustomifyStand.type)
 ? window.CustomifyStand.type
 : 'none';
 const standSelected = selectedStand !== 'none';
 const standSurcharge = standSelected ? (this.standPricing[selectedStand] || 0) : 0;

 const productData = {
 originalImage: originalImage,
 transformedImage: finalTransformedImage, // üéµ Dla spotify: PNG przezroczysty do druku
 watermarkedImage: watermarkedImageUrl,
 watermarkedImageUrl: watermarkedImageUrl, // üéµ null dla spotify
 needsBackendWatermark: needsBackendWatermark, // üéµ true dla spotify
 watermarkedImageBase64: needsBackendWatermark ? null : (this.watermarkedImageBase64 || null),
 spotifyPreviewUrl: this.spotifyPreviewUrl || null, // üéµ JPEG z szarym t≈Çem do koszyka
 style: this.selectedStyle,
 size: isDigitalProduct ? 'digital' : this.selectedSize, // üö® ROLLBACK: Dla produktu cyfrowego u≈ºyj 'digital'
 productType: this.selectedProductType || 'canvas',
 originalProductTitle: document.querySelector('h1, .product-title, .view-product-title')?.textContent?.trim() || 'Produkt',
 originalProductId: productId,
 finalPrice: finalPrice,
 frameColor: selectedFrame, // ‚úÖ Ramka (plakat)
 frameSurcharge: frameSurcharge, // ‚úÖ Dop≈Çata za ramkƒô
 standType: selectedStand, // üÜï Podstawka (szk≈Ço)
 standSurcharge: standSurcharge // üÜï Dop≈Çata za podstawkƒô
 };

 console.log('üõí [CUSTOMIFY] Creating product with data:', productData);
 console.log('üõí [CUSTOMIFY] transformedImage type:', typeof this.transformedImage);
 console.log('üõí [CUSTOMIFY] transformedImage length:', this.transformedImage?.length);
 console.log('üõí [CUSTOMIFY] transformedImage is base64?', this.transformedImage?.startsWith('data:'));
 console.log('üõí [CUSTOMIFY] transformedImage is URL?', this.transformedImage?.startsWith('http'));
 console.log('üõí [CUSTOMIFY] transformedImage preview:', this.transformedImage?.substring(0, 200));

 const response = await fetch('https://customify-s56o.vercel.app/api/products', {
 method: 'POST',
 headers: { 'Content-Type': 'application/json' },
 body: JSON.stringify(productData)
 });

 console.log('üõí [CUSTOMIFY] API response status:', response.status);
 const result = await response.json();
 console.log('üõí [CUSTOMIFY] API response:', result);
 console.log('üîç [CUSTOMIFY] result.vercelBlobUrl:', result.vercelBlobUrl);
 console.log('üîç [CUSTOMIFY] result.vercelBlobUrl type:', typeof result.vercelBlobUrl);
 console.log('üîç [CUSTOMIFY] result.vercelBlobUrl startsWith http?', result.vercelBlobUrl?.startsWith('http'));
 console.log('üîç [CUSTOMIFY] result.permanentImageUrl:', result.permanentImageUrl);
 console.log('üîç [CUSTOMIFY] this.transformedImage:', this.transformedImage);

 // üîç Pobierz URL bez watermarku z historii generacji (Vercel Blob)
 let cleanImageUrl = null;
 try {
 const debugInfo = result.saveGenerationDebug;
 if (debugInfo && debugInfo.blobPath && debugInfo.generationId) {
 const blobBaseUrl = 'https://vzwqqb14qtsxe2wx.public.blob.vercel-storage.com';
 const normalizedPath = debugInfo.blobPath.startsWith('/')
 ? debugInfo.blobPath.slice(1)
 : debugInfo.blobPath;
 const blobUrl = `${blobBaseUrl}/${normalizedPath}`;
 console.log('üîç [CUSTOMIFY] Fetching generation JSON for clean image:', blobUrl);

 const generationResponse = await fetch(blobUrl);
 if (generationResponse.ok) {
 const generationData = await generationResponse.json();
 const generationsArray = generationData?.generations || [];
 const matchedGeneration = generationsArray.find((gen) => gen.id === debugInfo.generationId);
 const candidateUrl = matchedGeneration?.imageUrl || matchedGeneration?.transformedImage || null;

 if (candidateUrl && typeof candidateUrl === 'string' && candidateUrl.startsWith('http')) {
 cleanImageUrl = candidateUrl;
 console.log('‚úÖ [CUSTOMIFY] Clean image URL found:', cleanImageUrl.substring(0, 120) + '...');
 } else {
 console.warn('‚ö†Ô∏è [CUSTOMIFY] Clean image URL not found in generation JSON for generationId:', debugInfo.generationId);
 }
 } else {
 console.warn('‚ö†Ô∏è [CUSTOMIFY] Failed to fetch generation JSON:', generationResponse.status, generationResponse.statusText);
 }
 }
 } catch (cleanUrlError) {
 console.error('‚ö†Ô∏è [CUSTOMIFY] Error while resolving clean image URL:', cleanUrlError);
 }

 if (result.success) {
 this.showSuccess('‚úÖ ' + (result.message || 'Produkt zosta≈Ç utworzony!'));
 console.log('‚úÖ [CUSTOMIFY] Product created:', result.product);

 if (result.variantId) {
 console.log('üõí [CUSTOMIFY] Attempting to add to cart with Variant ID:', result.variantId);
 console.log('üõí [CUSTOMIFY] Product ID:', result.productId);
 console.log('üõí [CUSTOMIFY] Variant ID type:', typeof result.variantId);
 console.log('üõí [CUSTOMIFY] Variant ID length:', result.variantId.toString().length);

 // üö® ROLLBACK: START - Nazwa typu produktu z obs≈ÇugƒÖ cyfrowego
 const productTypeName = this.selectedProductType === 'plakat' 
 ? 'Plakat' 
 : this.selectedProductType === 'szklo'
 ? 'Nadruk na szkle' // üÜï Szk≈Ço
 : this.selectedProductType === 'digital'
 ? 'Produkt cyfrowy'
 : 'Obraz na p≈Ç√≥tnie';
 // üö® ROLLBACK: END - Nazwa typu produktu
 const selectedFrame = (this.selectedProductType === 'plakat' && window.CustomifyFrame && window.CustomifyFrame.color)
 ? window.CustomifyFrame.color
 : 'none';
 const frameLabelMap = { none: 'brak', black: 'czarna', white: 'bia≈Ça', wood: 'drewno' };
 const frameLabel = frameLabelMap[selectedFrame] || 'brak';
 
 // üÜï Mapowanie dla podstawki (szk≈Ço)
 const standLabelMap = { none: 'brak', wood: 'podstawka drewniana', led: 'podstawka drewniana z LED' };
 const standLabel = standLabelMap[selectedStand] || 'brak';

 console.log('üñºÔ∏è [CUSTOMIFY FRAME DEBUG]:', {
 selectedProductType: this.selectedProductType,
 'window.CustomifyFrame': window.CustomifyFrame,
 selectedFrame: selectedFrame,
 frameLabel: frameLabel,
 'window.CustomifyStand': window.CustomifyStand,
 selectedStand: selectedStand,
 standLabel: standLabel
 });

 const shortOrderId = result.shortOrderId || (result.orderId ? result.orderId.split('-').pop() : Date.now().toString());

 // üö® ROLLBACK: START - Properties dla produktu cyfrowego
 const visibleProperties = {
 'Rozmiar': isDigitalProduct ? 'Plik do pobrania' : this.getSizeDimension(this.selectedSize),
 'Rodzaj wydruku': productTypeName,
 'Ramka': isDigitalProduct ? 'brak' : (this.selectedProductType === 'szklo' ? `podstawka - ${standLabel}` : `ramka - ${frameLabel}`),
 'Order ID': shortOrderId
 };
 // üö® ROLLBACK: END - Properties dla produktu cyfrowego

 const hiddenProperties = {
 // ‚úÖ "Styl AI" usuniƒôte - nie pokazywane w koszyku (u≈ºytkownik widzi tylko "Rodzaj wydruku")
 };

 if (result.orderId) {
 hiddenProperties['_Order ID Full'] = result.orderId;
 console.log('‚úÖ [CUSTOMIFY] _Order ID Full added to hiddenProperties:', result.orderId);
 } else {
 console.error('‚ùå [CUSTOMIFY] result.orderId is missing!', {
 hasResult: !!result,
 resultKeys: result ? Object.keys(result) : [],
 orderId: result?.orderId,
 shortOrderId: result?.shortOrderId
 });
 }
 
 // ‚úÖ BEZ WATERMARKU - dla admina do realizacji zam√≥wienia (kr√≥tki ~100 znak√≥w, nie base64!)
 // Priorytet: cleanImageUrl (BEZ watermarku z historii) > vercelBlobUrl/permanentImageUrl (BEZ watermarku) > this.transformedImage (BEZ watermarku)
 // ‚ùå NIE U≈ªYWAJ watermarkedImageUrl - to jest Z watermarkiem!
 let finalAdminUrl = null;
 if (cleanImageUrl && cleanImageUrl.startsWith('http')) {
 finalAdminUrl = cleanImageUrl;
 } else if (result.vercelBlobUrl && result.vercelBlobUrl.startsWith('http')) {
 finalAdminUrl = result.vercelBlobUrl; // ‚úÖ BEZ watermarku (z /api/products response)
 } else if (result.permanentImageUrl && result.permanentImageUrl.startsWith('http')) {
 finalAdminUrl = result.permanentImageUrl; // ‚úÖ BEZ watermarku (z /api/products response)
 } else if (this.transformedImage && this.transformedImage.startsWith('http')) {
 finalAdminUrl = this.transformedImage; // ‚úÖ BEZ watermarku (z localStorage lub transformacji)
 }
 // ‚ùå NIE MA FALLBACK DO watermarkedImageUrl - admin MUSI mieƒá obraz BEZ watermarku!

 if (finalAdminUrl) {
 hiddenProperties['_AI_Image_URL'] = finalAdminUrl;
 }

 if (cleanImageUrl && cleanImageUrl.startsWith('http')) {
 hiddenProperties['_AI_Image_Clean_URL'] = cleanImageUrl; // Dodatkowy link BEZ watermarku
 }
 if (productId) {
 // ‚úÖ PowiƒÖ≈º wygenerowany produkt z oryginalnym produktem ≈∫r√≥d≈Çowym (do statystyk zakup√≥w)
 hiddenProperties['_Original Product ID'] = String(productId);
 }
 // NIE dodawaj base64 - przekracza limit URL!

 const cartProperties = Object.assign({}, visibleProperties, hiddenProperties);

 console.log('üõí [CUSTOMIFY CART PROPERTIES VISIBLE]:', visibleProperties);
 console.log('üîí [CUSTOMIFY CART PROPERTIES HIDDEN]:', hiddenProperties);

 const params = new URLSearchParams();
 params.append('id', result.variantId);
 params.append('quantity', '1');

 Object.entries(cartProperties).forEach(([key, value]) => {
 if (value != null) {
 params.append(`properties[${key}]`, value);
 // ‚úÖ LOGOWANIE: Sprawd≈∫ czy _Order ID Full jest dodawane
 if (key === '_Order ID Full') {
 console.log('‚úÖ [CUSTOMIFY] _Order ID Full added to URL params:', value);
 }
 }
 });

 const cartUrl = `/cart/add?${params.toString()}`;
 const fullUrl = window.location.origin + cartUrl;
 console.log('üõí [CUSTOMIFY] Cart URL length:', cartUrl.length, 'chars');
 console.log('üõí [CUSTOMIFY] Full URL length:', fullUrl.length, 'chars');
 
 if (fullUrl.length > 2048) {
 console.error('‚ùå [CUSTOMIFY] URL TOO LONG:', fullUrl.length, 'chars (max 2048)');
 this.hideCartLoading();
 this.showError('URL zbyt d≈Çugi - usu≈Ñ niekt√≥re w≈Ça≈õciwo≈õci lub skontaktuj siƒô z supportem');
 return;
 }

 // ‚úÖ U≈ºyj cart/add.js (POST) zamiast GET - lepsza obs≈Çuga b≈Çƒôd√≥w Shopify
 const cartRoot = (window.Shopify && window.Shopify.routes && window.Shopify.routes.root) || '/';
 const addToCartUrl = cartRoot + 'cart/add.js';
 const addPayload = {
 items: [{
 id: parseInt(result.variantId, 10),
 quantity: 1,
 properties: cartProperties
 }]
 };
 console.log('üõí [CUSTOMIFY] Adding via cart/add.js POST:', addToCartUrl);
 try {
 const addResponse = await fetch(addToCartUrl, {
 method: 'POST',
 headers: { 'Content-Type': 'application/json' },
 body: JSON.stringify(addPayload)
 });
 const addResult = await addResponse.json();
 if (addResponse.ok && addResult.items && addResult.items.length > 0) {
 console.log('‚úÖ [CUSTOMIFY] Added to cart successfully');
 this.hideCartLoading();
 window.location.href = cartRoot + 'cart';
 } else {
 const errMsg = addResult.description || addResult.message || 'Nie uda≈Ço siƒô dodaƒá do koszyka';
 console.error('‚ùå [CUSTOMIFY] Cart add error:', addResult);
 this.hideCartLoading();
 this.showError('‚ùå ' + errMsg);
 }
 } catch (addErr) {
 console.error('‚ùå [CUSTOMIFY] Cart add fetch error:', addErr);
 this.hideCartLoading();
 this.showError('‚ùå B≈ÇƒÖd dodawania do koszyka. Spr√≥buj ponownie.');
 }
 }
 } else {
 console.error('‚ùå [CUSTOMIFY] Product creation failed:', result);
 this.hideCartLoading();
 this.showError('‚ùå B≈ÇƒÖd podczas tworzenia produktu: ' + (result.error || 'Nieznany b≈ÇƒÖd'));
 }
 } catch (error) {
 console.error('‚ùå [CUSTOMIFY] Add to cart error:', error);
 this.hideCartLoading();

 let errorMessage = '‚ùå B≈ÇƒÖd po≈ÇƒÖczenia z serwerem';

 if (error.name === 'AbortError') {
 errorMessage = '‚ùå Przekroczono limit czasu. Spr√≥buj ponownie.';
 } else if (error.message.includes('Failed to fetch')) {
 errorMessage = '‚ùå B≈ÇƒÖd sieci. Sprawd≈∫ po≈ÇƒÖczenie internetowe.';
 } else if (error.message.includes('NetworkError')) {
 errorMessage = '‚ùå B≈ÇƒÖd sieci. Spr√≥buj ponownie za chwilƒô.';
 } else {
 errorMessage = '‚ùå B≈ÇƒÖd: ' + error.message;
 }

 this.showError(errorMessage);
 }
 };

 return true;
 }

 function initOverride() {
 if (!applyCustomifyCartOverride()) {
 setTimeout(initOverride, 50);
 }
 }

 if (document.readyState === 'loading') {
 document.addEventListener('DOMContentLoaded', initOverride);
 } else {
 initOverride();
 }
 })();
 </script>

 <script>
 document.addEventListener('DOMContentLoaded', function() {
 // Ukryj produkty z "rozmiar" w URL (kolekcje)
 const rozmiarProducts = document.querySelectorAll('.custom-collection-card[href*="rozmiar"]');
 rozmiarProducts.forEach(product => {
 product.style.display = 'none';
 });
 
 // Ukryj produkty z "cyfrowy" w URL (kolekcje)
 const cyfrowyProducts = document.querySelectorAll('.custom-collection-card[href*="cyfrowy"]');
 cyfrowyProducts.forEach(product => {
 product.style.display = 'none';
 });
 
 const recommendationsRozmiar = document.querySelectorAll('.product-recommendations a[href*="rozmiar"]');
 recommendationsRozmiar.forEach(product => {
 product.style.display = 'none';
 });
 
 // Ukryj produkty z "cyfrowy" w rekomendacjach
 const recommendationsCyfrowy = document.querySelectorAll('.product-recommendations a[href*="cyfrowy"]');
 recommendationsCyfrowy.forEach(product => {
 product.style.display = 'none';
 });
 
 const totalHidden = rozmiarProducts.length + cyfrowyProducts.length + recommendationsRozmiar.length + recommendationsCyfrowy.length;
 console.log('üîí [PRODUCT HIDING] Ukryto', totalHidden, 'produkt√≥w AI (kolekcje + rekomendacje)');
 
 // ‚úÖ NOWE: Dla produktu akwarela (ID: 15475649675589 lub handle zawiera 'akwarela') - ukryj wszystkie style opr√≥cz akwareli
 if (window.ShopifyProduct && (window.ShopifyProduct.id === 15475649675589 || window.ShopifyProduct.id === '15475649675589' || (window.ShopifyProduct.handle && window.ShopifyProduct.handle.includes('akwarela')) || window.location.pathname.includes('akwarela'))) {
 console.log('üé® [WATERCOLOR] Produkt akwarela wykryty (ID:', window.ShopifyProduct.id, 'handle:', window.ShopifyProduct.handle, ') - ukrywanie wszystkich styl√≥w opr√≥cz akwareli');
 const allStyleCards = document.querySelectorAll('.customify-style-card');
 allStyleCards.forEach(card => {
 const styleName = card.getAttribute('data-style');
 if (styleName && styleName !== 'akwarela') {
 card.style.display = 'none';
 console.log('üîí [WATERCOLOR] Ukryto styl:', styleName);
 } else if (styleName === 'akwarela') {
 console.log('‚úÖ [WATERCOLOR] Pozostawiono styl akwareli widoczny');
 }
 });
 }
 });
 </script>

 <style>
 /* TYLKO JEDEN MIEJSCE - bez duplikat√≥w */
 .media-gallery__grid {
 grid-template-rows: 400px 120px !important;
 grid-template-columns: 120px 120px !important;
 height: 524px !important;
 }
 
 /* OGRANICZ ROZMIAR MODALA ZDJƒòƒÜ */
 .product-media-container__zoom-button {
 /* Usu≈Ñ full screen - poka≈º mniejszy modal */
 }
 
 /* Modal z ograniczonym rozmiarem */
 .media-gallery__modal,
 .product-media-modal,
 [data-modal],
 .modal {
 max-width: 80vw !important;
 max-height: 80vh !important;
 width: auto !important;
 height: auto !important;
 margin: auto !important;
 position: fixed !important;
 top: 50% !important;
 left: 50% !important;
 transform: translate(-50%, -50%) !important;
 z-index: 9999 !important;
 background: white !important;
 border-radius: 8px !important;
 box-shadow: 0 10px 30px rgba(0,0,0,0.3) !important;
 overflow: hidden !important;
 }
 
 /* Obraz w modalu - WYPE≈ÅNIA CA≈ÅY KONTENER BEZ BIA≈ÅYCH P√ìL */
 .media-gallery__modal img,
 .product-media-modal img,
 [data-modal] img,
 .modal img {
 width: 100% !important;
 height: 100% !important;
 object-fit: cover !important;
 object-position: center !important;
 }
 
 /* FIX: Zdjƒôcia w galerii - WYPE≈ÅNIAJƒÑ CA≈ÅY KONTENER */
 .product-media__image {
 width: 100% !important;
 height: 100% !important;
 object-fit: cover !important;
 object-position: center !important;
 max-height: none !important;
 }
 
 /* FIX: Kontener zdjƒôcia */
 .product-media {
 width: 100% !important;
 height: 100% !important;
 display: flex !important;
 align-items: center !important;
 justify-content: center !important;
 }
 
 /* Overlay */
 .media-gallery__overlay,
 .product-media-overlay,
 [data-overlay],
 .modal-overlay {
 position: fixed !important;
 top: 0 !important;
 left: 0 !important;
 width: 100vw !important;
 height: 100vh !important;
 background: rgba(0,0,0,0.8) !important;
 z-index: 9998 !important;
 }
 
 /* OGRANICZ SZEROKO≈öƒÜ TYLKO STRON PRODUKT√ìW - DESKTOP ONLY */
 @media (min-width: 769px) {
 .product-information__grid {
 max-width: 1400px !important;
 margin: 0 auto !important;
 padding: 0 20px !important;
 /* FIX: Stabilny grid layout - eliminuje skakanie */
 display: grid !important;
 grid-template-columns: 35% 65% !important; /* Obrazek 35%, Aplikacja 65% */
 gap: 24px !important;
 align-items: start !important;
 width: 100% !important;
 background: #f3f5f6 !important; /* SZARE T≈ÅO dla grid */
 padding: 20px !important;
 border-radius: 0 !important;
 min-height: 600px !important; /* Stabilna wysoko≈õƒá */
 }
 }
 
 /* FIX: Stabilne wymiary dla kontener√≥w - DESKTOP ONLY */
 @media (min-width: 769px) {
 .product-information__media {
 grid-column: 1 !important;
 width: 100% !important;
 min-height: 500px !important; /* Stabilna wysoko≈õƒá zdjƒôƒá */
 box-sizing: border-box !important;
 background: white !important;
 padding: 20px !important;
 border-radius: 0 !important;
 box-shadow: 0 2px 8px rgba(0,0,0,0.1) !important;
 }
 
 .product-details {
 grid-column: 2 !important;
 min-height: 500px !important; /* Stabilna wysoko≈õƒá aplikacji */
 background: white !important;
 padding: 20px !important;
 border-radius: 0 !important;
 box-shadow: 0 2px 8px rgba(0,0,0,0.1) !important;
 }
 }
 
 /* MOBILE: Elastyczne wymiary */
 @media (max-width: 768px) {
 .product-information__media,
 .product-details {
 grid-column: 1 !important;
 width: 100% !important;
 min-height: auto !important; /* Elastyczna wysoko≈õƒá na mobile */
 box-sizing: border-box !important;
 background: white !important;
 padding: 15px !important;
 border-radius: 0 !important;
 box-shadow: 0 2px 8px rgba(0,0,0,0.1) !important;
 margin-bottom: 15px !important;
 }
 }
 
 /* FIX: Stabilne wymiary dla zdjƒôƒá produktu - DESKTOP ONLY */
 @media (min-width: 769px) {
 .product__media img,
 .product__media .product__media-item img,
 .media-gallery__image img {
 width: 100% !important;
 height: 100% !important;
 min-height: 400px !important; /* Stabilna wysoko≈õƒá obrazk√≥w */
 object-fit: cover !important;
 object-position: center !important;
 background: #f8f9fa !important; /* Placeholder podczas ≈Çadowania */
 }
 }
 
 /* MOBILE: Elastyczne wymiary zdjƒôƒá */
 @media (max-width: 768px) {
 .product__media img,
 .product__media .product__media-item img,
 .media-gallery__image img {
 width: 100% !important;
 height: auto !important; /* Elastyczna wysoko≈õƒá na mobile */
 min-height: 200px !important; /* Mniejsza minimalna wysoko≈õƒá */
 max-height: 400px !important; /* Maksymalna wysoko≈õƒá */
 object-fit: cover !important;
 object-position: center !important;
 background: #f8f9fa !important;
 }
 }
 
 /* FIX: Stabilne wymiary dla ceny produktu - DESKTOP ONLY */
 @media (min-width: 769px) {
 .product-price,
 product-price,
 .price,
 [class*="price"] {
 min-height: 60px !important; /* Stabilna wysoko≈õƒá ceny */
 display: flex !important;
 align-items: center !important;
 font-size: 1.4rem !important;
 font-weight: 700 !important;
 color: #000000 !important; /* CZARNY KOLOR */
 margin: 8px 0 !important; /* ZMNIEJSZONO: z 20px na 8px */
 }
 }
 
 /* MOBILE: Elastyczne wymiary ceny */
 @media (max-width: 768px) {
 .product-price,
 product-price,
 .price,
 [class*="price"] {
 min-height: auto !important; /* Elastyczna wysoko≈õƒá na mobile */
 display: flex !important;
 align-items: center !important;
 font-size: 1.2rem !important; /* Mniejszy font na mobile */
 font-weight: 700 !important;
 color: #000000 !important; /* CZARNY KOLOR */
 margin: 5px 0 !important; /* Mniejsze marginesy na mobile */
 }
 }
 
 /* FIX: Zmniejsz pionowe rozmiary dla ceny w aplikacji Customify - DESKTOP ONLY */
 @media (min-width: 769px) {
 #customify-app-container product-price,
 #customify-app-container .product-price,
 #customify-app-container .price,
 #customify-app-container [class*="price"] {
 margin: 4px 0 !important; /* Jeszcze mniejsze marginesy w aplikacji */
 min-height: 40px !important; /* Mniejsza wysoko≈õƒá w aplikacji */
 text-align: left !important; /* WYJUSTOWANIE DO LEWEJ */
 }
 }
 
 /* MOBILE: Elastyczne wymiary ceny w aplikacji */
 @media (max-width: 768px) {
 #customify-app-container product-price,
 #customify-app-container .product-price,
 #customify-app-container .price,
 #customify-app-container [class*="price"] {
 margin: 2px 0 !important; /* Jeszcze mniejsze marginesy na mobile */
 min-height: auto !important; /* Elastyczna wysoko≈õƒá na mobile */
 font-size: 1.1rem !important; /* Mniejszy font na mobile */
 text-align: left !important; /* WYJUSTOWANIE DO LEWEJ NA MOBILE */
 }
 }
 
 /* INFORMACJA O NAJNI≈ªSZEJ CENIE - DODANA POD CENƒÑ */
 product-price::after {
 content: 'Najni≈ºsza cena z ostatnich 30 dni';
 display: block;
 color: #2d5a27 !important; /* CIEMNO ZIELONY KOLOR */
 font-size: 0.75rem !important; /* MNIEJSZA CZCIONKA */
 font-weight: 400 !important;
 margin-top: 4px !important;
 }
 
 /* FIX: Wewnƒôtrzny kontener ceny - wyr√≥wnanie do lewej */
 #customify-app-container product-price [ref="priceContainer"] {
 text-align: left !important;
 width: 100% !important;
 justify-self: flex-start !important;
 align-self: flex-start !important;
 }
 
 /* FIX: Skeleton loaders - eliminuje skakanie podczas ≈Çadowania */
 .product-information__media.loading {
 background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%) !important;
 background-size: 200% 100% !important;
 animation: loading-shimmer 1.5s infinite !important;
 }
 
 .product-details.loading {
 background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%) !important;
 background-size: 200% 100% !important;
 animation: loading-shimmer 1.5s infinite !important;
 }
 
 .product__media img.loading {
 background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%) !important;
 background-size: 200% 100% !important;
 animation: loading-shimmer 1.5s infinite !important;
 }
 
 @keyframes loading-shimmer {
 0% {
 background-position: -200% 0;
 }
 100% {
 background-position: 200% 0;
 }
 }
 
 /* FIX: Ukryj skeleton po za≈Çadowaniu */
 .product-information__media:not(.loading),
 .product-details:not(.loading),
 .product__media img:not(.loading) {
 animation: none !important;
 background: white !important;
 }
 
 /* Responsive - tablet */
 @media (max-width: 768px) {
 .product-information__grid {
 max-width: 768px !important;
 padding: 0 15px !important;
 grid-template-columns: 1fr !important; /* Jedna kolumna na mobile */
 min-height: auto !important;
 background: #f3f5f6 !important;
 gap: 15px !important;
 }
 }
 
 /* Responsive - mobile */
 @media (max-width: 480px) {
 .product-information__grid {
 max-width: 100% !important;
 padding: 0 10px !important;
 }
 
 .product-information__media,
 .product-details {
 min-height: 250px !important;
 }
 
 /* FIX: Bardzo ma≈Çe ekrany - jeszcze bardziej zwarte */
 #customify-app-container {
 padding: 10px !important;
 }
 
 .customify-title {
 font-size: 1rem !important;
 margin: 10px 0 !important;
 }
 
 .customify-size-buttons {
 grid-template-columns: 1fr 1fr !important;
 gap: 6px !important;
 }
 
 .customify-size-btn {
 font-size: 0.8rem !important;
 padding: 6px 4px !important;
 min-height: 40px !important;
 }
 
 .customify-style-grid {
 grid-template-columns: 1fr 1fr !important;
 gap: 8px !important;
 }
 
 .customify-btn {
 font-size: 0.9rem !important;
 padding: 12px 16px !important;
 }
 }
 
 /* Drag & Drop Zone - dzia≈Ça na wszystkich urzƒÖdzeniach */
 .customify-drop-zone {
 border: 2px dashed #9ca3af !important; /* ZMNIEJSZONA RAMKA: z 3px na 2px */
 border-radius: 8px !important;
 background: transparent !important; /* USUNIƒòTO SZARE T≈ÅO */
 padding: 20px 30px !important; /* ZMNIEJSZONO PADDING PIONOWY: z 50px na 20px */
 text-align: center !important;
 transition: all 0.3s ease !important;
 cursor: pointer !important;
 min-height: 100px !important; /* ZMNIEJSZONO WYSOKO≈öƒÜ: z 150px na 100px */
 display: flex !important;
 align-items: center !important;
 justify-content: center !important;
 }
 
 .customify-drop-zone:hover {
 border-color: #6c757d !important;
 background: transparent !important; /* USUNIƒòTO SZARE T≈ÅO Z HOVER */
 }
 
 /* Usage Counter Styles */
 .usage-counter {
 padding: 12px 16px !important;
 border-radius: 8px !important;
 margin: 15px 0 !important;
 font-size: 0.95rem !important;
 font-weight: 600 !important;
 text-align: center !important;
 box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
 }
 
 .usage-counter-green {
 background: #d4edda !important;
 color: #155724 !important;
 border: 1px solid #c3e6cb !important;
 }
 
 .usage-counter-blue {
 background: #d1ecf1 !important;
 color: #0c5460 !important;
 border: 1px solid #bee5eb !important;
 }
 
 .usage-counter-red {
 background: #f8d7da !important;
 color: #721c24 !important;
 border: 1px solid #f5c6cb !important;
 }
 
 .customify-drop-zone.dragover {
 border-color: #6c757d !important;
 background: transparent !important; /* USUNIƒòTO SZARE T≈ÅO Z DRAGOVER */
 }
 
 .drop-zone-content {
 display: flex !important;
 flex-direction: column !important;
 align-items: center !important;
 gap: 12px !important;
 }
 
 .drop-zone-text {
 font-size: 1.1rem !important;
 color: #374151 !important;
 font-weight: 500 !important;
 margin: 0 !important;
 }
 
 .drop-zone-separator {
 font-size: 0.9rem !important;
 color: #9ca3af !important;
 margin: 0 !important;
 }
 
 .customify-upload-btn {
 background: #9ca3af !important; /* JA≈öNIEJSZY KOLOR */
 color: white !important;
 border: none !important;
 padding: 10px 20px !important;
 border-radius: 6px !important;
 font-size: 0.9rem !important;
 font-weight: 500 !important;
 cursor: pointer !important;
 transition: all 0.3s ease !important;
 margin: 0 !important;
 }
 
 .customify-upload-btn:hover {
 background: #6b7280 !important; /* CIEMNIEJSZY HOVER */
 transform: translateY(-1px) !important;
 }
 
 /* FIX: Mobile styles dla aplikacji Customify - wyr√≥wnanie do lewej */
 @media (max-width: 768px) {
 /* Aplikacja Customify na mobile */
 #customify-app-container {
 text-align: left !important;
 padding: 15px !important;
 }
 
 /* Rozmiary - wyr√≥wnanie do lewej */
 .customify-size-selector {
 text-align: left !important;
 margin-bottom: 15px !important;
 }
 
 .customify-size-selector h4 {
 text-align: left !important;
 margin: 0 0 10px 0 !important;
 }
 
 .customify-size-buttons {
 justify-content: flex-start !important;
 grid-template-columns: repeat(3, 1fr) !important;
 gap: 8px !important;
 }
 
 /* Tytu≈Ç aplikacji - wyr√≥wnanie do lewej */
 .customify-title {
 text-align: left !important;
 font-size: 1.1rem !important;
 margin: 15px 0 !important;
 }
 
 /* Upload area - wyr√≥wnanie do lewej */
 .customify-upload-area {
 text-align: left !important;
 padding-top: 0 !important; /* USUNIƒòTO G√ìRNY PADDING */
 }
 
 .customify-upload-hint {
 text-align: left !important;
 margin: 8px 0 0 0 !important;
 font-size: 0.75rem !important; /* ZMNIEJSZONA CZCIONKA */
 color: #666 !important;
 line-height: 1.3 !important;
 }
 
 /* Style grid - wyr√≥wnanie do lewej */
 .customify-style-grid {
 grid-template-columns: repeat(2, 1fr) !important;
 gap: 10px !important;
 justify-content: flex-start !important;
 }
 
 .customify-style-card {
 text-align: left !important;
 }
 
 .style-info {
 text-align: left !important;
 }
 
 /* Wynik - wyr√≥wnanie do lewej */
 .customify-result {
 text-align: left !important;
 }
 
 .customify-result h4 {
 text-align: left !important;
 }
 
 .customify-result img {
 width: 100%;
 height: auto;
 }

 /* Tekst na obrazie (pilota≈º) */
 .customify-text-overlay-panel {
 display: none;
 margin-top: 16px;
 padding: 14px;
 border: 1px solid #e9ecef;
 border-radius: 10px;
 background: #f9fafb;
 }
 .customify-text-overlay-panel h5 {
 margin: 0 0 10px 0;
 font-size: 1rem;
 }
 .customify-text-overlay-panel .text-overlay-row {
 display: flex;
 align-items: center;
 gap: 8px;
 margin-bottom: 10px;
 }
 .text-overlay-counter {
 font-size: 0.8rem;
 color: #6b7280;
 }
 .customify-text-overlay-panel .text-overlay-group {
 display: flex;
 flex-wrap: wrap;
 gap: 8px;
 margin-bottom: 10px;
 }
 .text-overlay-hint {
 font-size: 0.85rem;
 color: #6b7280;
 margin: 6px 0 0 0;
 }
 /* Toggle "Dodaj napis" ‚Äì sp√≥jny z product-type, ale bez hover/pod≈õwietlenia */
 #textOverlayToggleBtn {
 flex: 1 1 0;
 min-width: 0;
 width: 100%;
 padding: 12px 14px;
 border: 1px solid #666666 !important;
 background: #fff !important;
 color: #333 !important;
 text-align: center;
 display: inline-flex;
 justify-content: center;
 align-items: center;
 font-weight: 500;
 font-size: 0.9rem;
 }
 #textOverlayToggleBtn:hover,
 #textOverlayToggleBtn:focus,
 #textOverlayToggleBtn:active {
 border: 1px solid #666666 !important;
 background: #fff !important;
 color: #333 !important;
 box-shadow: none !important;
 }
 #textOverlayToggleBtn.active {
 border: 1px solid #666666 !important;
 background: #fff !important;
 color: #333 !important;
 box-shadow: none !important;
 }
 /* Wymuszone obramowanie pola tekstu (jak pole newslettera) */
 .customify-text-overlay-panel .text-overlay-input-wrapper {
 display: block !important;
 width: 100% !important;
 border: 1px solid #d1d5db !important;
 border-radius: 8px !important;
 background: #f5f5f5 !important;
 padding: 8px 10px !important;
 box-shadow: none !important;
 box-sizing: border-box !important;
 }
 .customify-text-overlay-panel .text-overlay-input {
 border: none !important;
 outline: none !important;
 background: transparent !important;
 width: 100% !important;
 font-size: 0.95rem !important;
 color: #111 !important;
 box-sizing: border-box !important;
 min-height: 26px !important;
 }
 .customify-text-overlay-panel .text-overlay-input-wrapper {
 border: 1px solid #cfd4dc !important;
 border-radius: 8px !important;
 padding: 8px 10px !important;
 background: #f5f5f5 !important;
 box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.04) !important;
 display: block !important;
 width: 100% !important;
 box-sizing: border-box !important;
 }
 .customify-text-overlay-panel .text-overlay-input {
 border: none !important;
 border-radius: 0 !important;
 padding: 0 !important;
 font-size: 0.95rem !important;
 font-family: 'Montserrat', 'Poppins', 'Inter', Arial, sans-serif !important;
 width: 100% !important;
 background: transparent !important;
 color: #111 !important;
 box-sizing: border-box !important;
 outline: none !important;
 display: block !important;
 min-height: 26px !important;
 }
 .customify-text-overlay-panel .text-overlay-input::placeholder {
 color: rgba(17, 17, 17, 0.45) !important;
 }
 /* Desktop: mocniejsze obramowanie i kontrast dla pola i select√≥w */
 @media (min-width: 769px) {
 .customify-text-overlay-panel .text-overlay-input-wrapper,
 .customify-text-overlay-panel .text-overlay-select {
 border: 1.5px solid #b4bcc8 !important;
 box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.08) !important;
 background: #f7f7f8 !important;
 }
 }
 .customify-text-overlay-panel .text-overlay-select {
 width: 100% !important;
 padding: 10px !important;
 border: 1px solid #d1d5db !important;
 border-radius: 8px !important;
 background: #fff !important;
 font-size: 0.95rem !important;
 font-family: 'Montserrat', 'Poppins', 'Inter', Arial, sans-serif !important;
 color: #111 !important;
 box-sizing: border-box !important;
 outline: none !important;
 min-height: 42px !important;
 }
 .customify-text-overlay-panel .text-overlay-actions {
 display: flex;
 gap: 10px;
 align-items: stretch;
 }
 .customify-text-overlay-panel .text-overlay-actions button {
 flex: 1 1 0 !important;
 min-width: 0 !important;
 text-align: center !important;
 display: inline-flex !important;
 justify-content: center !important;
 align-items: center !important;
 width: auto !important;
 margin: 0 !important;
 font-family: 'Montserrat', 'Poppins', 'Inter', Arial, sans-serif !important;
 }
 .text-overlay-actions button {
 flex: 1 1 0;
 min-width: 0;
 text-align: center;
 }
 
 /* Cena - wyr√≥wnanie do lewej */
 .customify-cart-price {
 text-align: left !important;
 margin: 10px 0 !important;
 }
 
 /* Komunikat b≈Çƒôdu transformacji - pe≈Çna szeroko≈õƒá nad przyciskami */
 #errorMessageTransform {
 width: 100% !important;
 margin-bottom: 10px !important;
 }
 
 /* Ukryj t≈Ço i margines gdy element jest ukryty */
 .customify-error[style*="display: none"],
 .customify-error[style*="display:none"],
 .customify-error[style*="display:none;"],
 .customify-error[style*="display: none;"] {
 background-color: transparent !important;
 margin: 0 !important;
 padding: 0 !important;
 height: 0 !important;
 overflow: hidden !important;
 border: none !important;
 }
 
 /* Dodatkowa ochrona - ukryj wszystkie ukryte elementy b≈Çƒôd√≥w */
 .customify-error:not(:has(*)) {
 /* Je≈õli element jest pusty i ukryty, usu≈Ñ wszystkie style */
 }
 
 /* Gdy element ma display: none, usu≈Ñ wszystkie style wizualne */
 .customify-error {
 transition: all 0.2s ease;
 }
 
 .customify-error[style*="display: none"] *,
 .customify-error[style*="display:none"] * {
 display: none !important;
 }
 
 /* Przyciski - wyr√≥wnanie do lewej */
 .customify-actions {
 text-align: left !important;
 margin-top: 15px !important;
 }
 
 .customify-btn {
 width: 100% !important;
 margin: 5px 0 !important;
 }
 
 /* Accordion - wyr√≥wnanie do lewej */
 .product-details-accordion {
 text-align: left !important;
 }
 
 .accordion-header {
 text-align: left !important;
 }
 
 .accordion-content {
 text-align: left !important;
 }
 
 /* Loading states - wyr√≥wnanie do lewej */
 .customify-cart-loading {
 text-align: left !important;
 }
 
 .loading-text,
 .loading-stage {
 text-align: left !important;
 }
 }
 
 /* FIX: POKA≈ª WSZYSTKIE ELEMENTY STOPKI ZAMIAST POPOVER */
 .terms-policies-popover {
 position: static !important;
 display: block !important;
 visibility: visible !important;
 opacity: 1 !important;
 transform: none !important;
 box-shadow: none !important;
 border: none !important;
 background: transparent !important;
 padding: 0 !important;
 margin: 0 !important;
 max-width: none !important;
 width: auto !important;
 height: auto !important;
 z-index: auto !important;
 }
 
 .policy_list {
 display: flex !important;
 flex-wrap: wrap !important;
 gap: 15px !important;
 margin: 0 !important;
 padding: 0 !important;
 list-style: none !important;
 }
 
 .policy_list li {
 margin: 0 !important;
 padding: 0 !important;
 }
 
 .policy_list a {
 color: inherit !important;
 text-decoration: none !important;
 font-size: 0.75rem !important;
 transition: opacity 0.2s ease !important;
 }
 
 .policy_list a:hover {
 opacity: 0.7 !important;
 }
 
 /* UKRYJ PRZYCISK POPOVER - POKA≈ª TYLKO LISTƒò */
 .policy-list-trigger {
 display: none !important;
 }
 
 /* RESPONSIVE - MOBILE */
 @media (max-width: 768px) {
 .policy_list {
 flex-direction: column !important;
 gap: 8px !important;
 }
 }

 /* EXPANDABLE DESCRIPTION USUNIƒòTE - opisy produkt√≥w sƒÖ teraz pe≈Çne */

 /* ACCORDION POD PRZYCISKAMI - STYL MINIMALISTYCZNY */
 .product-details-accordion {
 display: block !important;
 margin-top: 24px;
 border-top: none;
 padding-top: 0;
 }

 .accordion-item {
 border-bottom: none;
 margin-bottom: 0;
 }

 .accordion-header {
 display: flex;
 justify-content: space-between;
 align-items: center;
 padding: 16px 0;
 cursor: pointer;
 font-weight: 400;
 color: #000;
 font-size: 1rem;
 transition: all 0.2s ease;
 user-select: none;
 background: transparent;
 border-bottom: 1px solid #e5e5e5;
 margin-bottom: 0;
 width: 100%;
 box-sizing: border-box;
 }

 .accordion-header:hover {
 color: #000;
 }

 .accordion-title {
 display: flex;
 align-items: center;
 gap: 12px;
 flex: 1;
 }

 .accordion-icon {
 font-size: 1.5rem;
 font-weight: 300;
 transition: transform 0.3s ease;
 color: #000;
 flex-shrink: 0;
 line-height: 1;
 display: inline-block;
 }

 .accordion-item.expanded .accordion-icon {
 transform: rotate(45deg);
 color: #000;
 }

 .accordion-item.expanded .accordion-header {
 border-bottom-color: #e5e5e5;
 color: #000;
 }

 .accordion-content {
 max-height: 0;
 overflow: hidden;
 transition: max-height 0.4s ease;
 color: #666;
 font-size: 0.9rem;
 line-height: 1.6;
 padding: 0 20px;
 }

 .accordion-item.expanded .accordion-content {
 max-height: 5000px; /* Zwiƒôkszono dla rozbudowanych sekcji z obrazkami */
 padding: 16px 0;
 background: transparent;
 border: none;
 margin-bottom: 0;
 overflow: visible;
 }

 .accordion-content ul {
 margin: 8px 0;
 padding-left: 20px;
 }

 .accordion-content li {
 margin: 6px 0;
 }

 .accordion-content strong {
 color: #333;
 font-weight: 600;
 }

 .accordion-step {
 display: flex;
 align-items: flex-start;
 gap: 12px;
 margin: 12px 0;
 padding: 12px;
 background: #f9f9f9;
 border-radius: 8px;
 }

 .accordion-step-number {
 background: #d32f2f;
 color: white;
 width: 28px;
 height: 28px;
 border-radius: 50%;
 display: flex;
 align-items: center;
 justify-content: center;
 font-weight: 700;
 font-size: 0.9rem;
 flex-shrink: 0;
 }

 .accordion-step-content {
 flex: 1;
 }

 .accordion-size-grid {
 display: grid;
 grid-template-columns: repeat(2, 1fr);
 gap: 12px;
 margin-top: 12px;
 }

 .accordion-size-item {
 background: #f9f9f9;
 padding: 12px;
 border-radius: 8px;
 border: 2px solid #e5e5e5;
 transition: all 0.2s ease;
 }

 .accordion-size-item:hover {
 border-color: #d32f2f;
 background: #fff;
 }

 .accordion-size-name {
 font-weight: 700;
 color: #333;
 font-size: 1rem;
 }

 .accordion-size-dimensions {
 color: #666;
 font-size: 0.85rem;
 margin: 4px 0;
 }

 .accordion-size-price {
 color: #000000; /* CZARNY KOLOR */
 font-weight: 700;
 font-size: 1.1rem;
 }

 .accordion-size-description {
 color: #999;
 font-size: 0.8rem;
 margin-top: 4px;
 }

 /* Style dla obrazk√≥w wizualizacyjnych w akordeon */
 .accordion-product-visual {
 display: flex;
 justify-content: center;
 margin: 16px auto;
 max-width: 400px;
 }

 .accordion-visual-item {
 background: #fff;
 border: 2px solid #e5e5e5;
 border-radius: 12px;
 overflow: hidden;
 transition: all 0.3s ease;
 width: 100%;
 }

 .accordion-visual-item:hover {
 border-color: #d32f2f;
 box-shadow: 0 4px 12px rgba(211, 47, 47, 0.15);
 transform: translateY(-2px);
 }

 .accordion-visual-image {
 width: 100%;
 height: auto;
 display: block;
 }

 .accordion-visual-label {
 padding: 12px;
 text-align: center;
 font-weight: 600;
 color: #333;
 font-size: 0.95rem;
 background: #f8f9fa;
 border-top: 2px solid #e5e5e5;
 }

 @media (max-width: 768px) {
 .product-details-accordion {
 margin-top: 16px;
 }

 .accordion-product-visual {
 max-width: 100%;
 }

 .accordion-header {
 font-size: 1.05rem; /* üö® ROLLBACK: Zwiƒôkszono rozmiar czcionki dla nazw sekcji (mobile) */
 padding: 14px 16px;
 }

 .accordion-content {
 font-size: 0.85rem;
 padding: 0 16px;
 }

 .accordion-item.expanded .accordion-content {
 max-height: 5000px; /* Zwiƒôkszono dla rozbudowanych sekcji z obrazkami (mobile) */
 padding: 14px 16px;
 overflow: visible; /* Pozw√≥l na pe≈Çne wy≈õwietlenie tre≈õci */
 }

 .accordion-title {
 gap: 10px;
 }

 .accordion-size-grid {
 grid-template-columns: 1fr;
 }

 .accordion-step {
 padding: 10px;
 }
 }
 
 /* ANIMOWANE STRZA≈ÅKI WSKAZUJƒÑCE W D√ì≈Å */
 .arrow-down {
 text-align: center;
 margin: 0; /* USUNIƒòTO WSZYSTKIE MARGINESY */
 animation: bounce-arrows 4s infinite; /* WOLNIEJ: z 2s na 4s */
 }
 
 .arrow-down span {
 font-size: 2rem;
 color: #dc3545;
 font-weight: bold;
 display: inline-block;
 animation: bounce-individual 3s infinite ease-in-out; /* WOLNIEJ: z 1.5s na 3s */
 }
 
 .arrow-down span:nth-child(1) {
 animation-delay: 0s;
 }
 
 .arrow-down span:nth-child(2) {
 animation-delay: 0.2s;
 }
 
 .arrow-down span:nth-child(3) {
 animation-delay: 0.4s;
 }
 
 @keyframes bounce-arrows {
 0%, 20%, 50%, 80%, 100% {
 transform: translateY(0);
 }
 40% {
 transform: translateY(-5px); /* MNIEJ: z -10px na -5px */
 }
 60% {
 transform: translateY(-2px); /* MNIEJ: z -5px na -2px */
 }
 }
 
 @keyframes bounce-individual {
 0%, 20%, 50%, 80%, 100% {
 transform: translateY(0);
 opacity: 1;
 }
 40% {
 transform: translateY(-8px); /* MNIEJ: z -15px na -8px */
 opacity: 0.9; /* MNIEJ: z 0.8 na 0.9 */
 }
 60% {
 transform: translateY(-4px); /* MNIEJ: z -8px na -4px */
 opacity: 0.95; /* MNIEJ: z 0.9 na 0.95 */
 }
 }
 
 /* Mobile - mniejsze strza≈Çki */
 @media (max-width: 768px) {
 .arrow-down {
 margin: 0; /* USUNIƒòTO WSZYSTKIE MARGINESY NA MOBILE */
 }
 
.arrow-down span {
    font-size: 1.5rem;
  }
}

/* Ukryj sekcjƒô BuyButtons dla konkretnego szablonu (≈ºƒÖdanie u≈ºytkownika) */
#BuyButtons-ProductForm-template--28524657639749__main > div {
  display: none !important;
}
</style>

 <script>
 // FIX: Przenie≈õ aplikacjƒô NATYCHMIAST - eliminuje skakanie
 document.addEventListener('DOMContentLoaded', function() {
 const app = document.getElementById('customify-app-container');
 const prodInfo = document.querySelector('[id^="ProductInformation-"]');
 const placeholder = document.getElementById('customify-placeholder');
 
 if (app && prodInfo) {
 // Dodaj na koniec ProductInformation NATYCHMIAST
 prodInfo.appendChild(app);
 
 // Ukryj placeholder je≈õli istnieje
 if (placeholder) {
 placeholder.remove();
 }
 } else {
 // Fallback: je≈õli nie ma ProductInformation, spr√≥buj ponownie po kr√≥tkim czasie
 setTimeout(function() {
 const app = document.getElementById('customify-app-container');
 const prodInfo = document.querySelector('[id^="ProductInformation-"]');
 const placeholder = document.getElementById('customify-placeholder');
 
 if (app && prodInfo) {
 prodInfo.appendChild(app);
 if (placeholder) {
 placeholder.remove();
 }
 }
 }, 50);
 }
 });
 
 // FUNKCJA NAPRAWY POWIƒòKSZONEGO ZDJƒòCIA W DIALOGU
 function fixDialogImages() {
 const dialog = document.querySelector('dialog[open]');
 if (!dialog) return;
 
 // Znajd≈∫ wszystkie zdjƒôcia w dialogu
 const allImages = dialog.querySelectorAll('img');
 let largestImg = null;
 let largestWidth = 0;
 
 allImages.forEach(img => {
 const width = img.clientWidth;
 if (width > largestWidth) {
 largestWidth = width;
 largestImg = img;
 }
 });
 
 if (!largestImg) return;
 
 // Wymu≈õ poprawne style - WYPE≈ÅNIA CA≈ÅY KONTENER
 largestImg.style.setProperty('object-fit', 'cover', 'important');
 largestImg.style.setProperty('max-height', 'none', 'important');
 largestImg.style.setProperty('height', '100%', 'important');
 largestImg.style.setProperty('width', '100%', 'important');
 largestImg.style.setProperty('object-position', 'center', 'important');
 
 // Styluj kontener
 if (largestImg.parentElement) {
 largestImg.parentElement.style.setProperty('height', '100%', 'important');
 }
 
 }
 
 // FUNKCJA UKRYWANIA STAREJ SEKCJI POLITYK
 function hideOldPolicySection() {
 // Ukryj ca≈Çy popover z politykami
 const policyPopover = document.querySelector('.footer-utilities__group--left anchored-popover-component');
 if (policyPopover) {
 policyPopover.style.display = 'none';
 policyPopover.style.visibility = 'hidden';
 policyPopover.style.opacity = '0';
 policyPopover.style.height = '0';
 policyPopover.style.overflow = 'hidden';
 }
 
 // Ukryj element "Preferencje dotyczƒÖce plik√≥w cookie"
 const cookieLink = document.querySelector('a[href="/policies/#shopifyReshowConsentBanner"]');
 if (cookieLink) {
 cookieLink.style.display = 'none';
 cookieLink.style.visibility = 'hidden';
 cookieLink.style.opacity = '0';
 cookieLink.style.height = '0';
 cookieLink.style.overflow = 'hidden';
 
 const parentLi = cookieLink.closest('li');
 if (parentLi) {
 parentLi.style.display = 'none';
 parentLi.style.visibility = 'hidden';
 parentLi.style.opacity = '0';
 parentLi.style.height = '0';
 parentLi.style.overflow = 'hidden';
 }
 
 }
 }

 // FUNKCJA DODAWANIA NAWIGACJI NA STRONACH POLITYK
 function addPolicyNavigation() {
 // Dodaj nawigacjƒô do stopki (przed popoverem)
 const footerLeft = document.querySelector('.footer-utilities__group--left');
 if (!footerLeft) {
 return;
 }
 
 const policyPopover = footerLeft.querySelector('anchored-popover-component');
 if (!policyPopover) {
 return;
 }
 
 // Sprawdzam czy nawigacja ju≈º istnieje
 if (document.querySelector('.policy-nav-container-footer')) {
 return;
 }
 
 // Stw√≥rz aktywnƒÖ nawigacjƒô
 const navContainer = document.createElement('div');
 navContainer.className = 'policy-nav-container-footer';
 navContainer.style.cssText = `
 background: #f8f9fa;
 border: 1px solid #e9ecef;
 border-radius: 8px;
 padding: 15px 20px;
 margin-top: 30px;
 text-align: center;
 font-size: 0.9rem;
 `;
 
 const navTitle = document.createElement('div');
 navTitle.textContent = 'üîó Szybka nawigacja:';
 navTitle.style.cssText = `
 color: #666;
 margin-bottom: 10px;
 font-weight: 500;
 `;
 
 const navLinks = document.createElement('div');
 navLinks.className = 'policy-nav-links';
 navLinks.style.cssText = `
 display: flex;
 flex-wrap: wrap;
 justify-content: center;
 gap: 15px;
 `;
 
 const links = [
 { text: 'Polityka Prywatno≈õci', url: '/policies/privacy-policy' },
 { text: 'Polityka Zwrot√≥w', url: '/policies/refund-policy' },
 { text: 'Dane Kontaktowe', url: '/pages/kontakt' },
 { text: 'Warunki Us≈Çug', url: '/policies/terms-of-service' },
 { text: 'Polityka Wysy≈Çki', url: '/policies/shipping-policy' }
 ];
 
 links.forEach(link => {
 const linkEl = document.createElement('a');
 linkEl.href = link.url;
 linkEl.textContent = link.text;
 linkEl.style.cssText = `
 color: #666;
 text-decoration: none;
 font-weight: 500;
 padding: 8px 16px;
 border-radius: 6px;
 transition: all 0.3s ease;
 display: inline-block;
 border: 1px solid transparent;
 `;
 
 linkEl.addEventListener('mouseenter', function() {
 this.style.color = '#333';
 this.style.backgroundColor = '#fff';
 this.style.borderColor = '#666';
 this.style.transform = 'translateY(-2px)';
 this.style.boxShadow = '0 4px 8px rgba(0,0,0,0.1)';
 });
 
 linkEl.addEventListener('mouseleave', function() {
 this.style.color = '#666';
 this.style.backgroundColor = 'transparent';
 this.style.borderColor = 'transparent';
 this.style.transform = 'translateY(0)';
 this.style.boxShadow = 'none';
 });
 
 navLinks.appendChild(linkEl);
 });
 
 navContainer.appendChild(navTitle);
 navContainer.appendChild(navLinks);
 
 // Wstaw nawigacjƒô przed popoverem w stopce
 footerLeft.insertBefore(navContainer, policyPopover);
 
 }

 function fixGalleryProportions() {
 const galleryGrid = document.querySelector('.media-gallery__grid');
 if (!galleryGrid) return;
 
 // ZAWSZE uruchamiaj galeriƒô w stylu Etsy na stronach produktu
 createEtsyGallery(galleryGrid);
 }
 
 // ETSY-STYLE GALLERY (miniaturki poni≈ºej)
 function createEtsyGallery(galleryGrid) {
 // Sprawd≈∫ czy ju≈º utworzono
 if (galleryGrid.classList.contains('etsy-gallery-initialized')) {
 return;
 }
 
 // Wymu≈õ layout flexbox pionowy (g√≥ra-d√≥≈Ç)
 galleryGrid.style.setProperty('display', 'flex', 'important');
 galleryGrid.style.setProperty('flex-direction', 'column', 'important');
 galleryGrid.style.setProperty('gap', '16px', 'important');
 galleryGrid.style.setProperty('height', 'auto', 'important');
 galleryGrid.style.setProperty('width', '100%', 'important');
 
 // Pobierz wszystkie elementy listy (oryginalne media)
 const allImages = Array.from(galleryGrid.querySelectorAll('li'));
 if (allImages.length === 0) return;
 
 // Zapisz URL wszystkich obrazk√≥w PRZED usuniƒôciem element√≥w
 const imageUrls = allImages.map(li => {
 const img = li.querySelector('img');
 if (!img) return null;
 // Spr√≥buj wyciƒÖgnƒÖƒá URL z currentSrc, src lub srcset
 const direct = img.currentSrc || img.src || '';
 if (direct) return direct;
 const srcset = img.getAttribute('srcset') || '';
 if (srcset) {
 // We≈∫ najwiƒôkszy URL z srcset
 const candidates = srcset.split(',').map(s => s.trim().split(' ')[0]).filter(Boolean);
 return candidates[candidates.length - 1] || null;
 }
 return null;
 }).filter(url => url !== null && url !== '');
 
 if (imageUrls.length === 0) {
 console.warn('‚è≥ [ETSY] Brak gotowych obraz√≥w (lazy-load). Spr√≥bujƒô ponownie p√≥≈∫niej.');
 return; // Nie usuwaj oryginalnych element√≥w dop√≥ki nie mamy URLi
 }

 // Zmienna do ≈õledzenia aktualnego indexu (globalna dla ca≈Çej galerii)
 let currentIndex = 0;
 
 // NAJPIERW stw√≥rz kontener dla g≈Ç√≥wnego obrazu (bƒôdzie potrzebny w event listenerach)
 let mainImageContainer = galleryGrid.querySelector('.etsy-main-image');
 if (!mainImageContainer) {
 mainImageContainer = document.createElement('div');
 mainImageContainer.className = 'etsy-main-image';
 mainImageContainer.style.cssText = `
 width: 100%;
 position: relative;
 aspect-ratio: 1 / 1;
 background: #f5f5f5;
 border-radius: 8px;
 overflow: hidden;
 `;
 
 // Dodaj g≈Ç√≥wny obraz
 const firstImage = allImages[0]?.querySelector('img');
 if (firstImage) {
 const mainImg = document.createElement('img');
 mainImg.src = firstImage.src;
 mainImg.alt = 'G≈Ç√≥wne zdjƒôcie produktu';
 mainImg.style.cssText = `
 width: 100%;
 height: 100%;
 object-fit: cover;
 cursor: default;
 `;
 
 // Wy≈ÇƒÖcz zoom/modal na g≈Ç√≥wnym obrazie
 mainImg.addEventListener('click', (e) => {
 e.preventDefault();
 e.stopPropagation();
 }, true);
 
 mainImageContainer.appendChild(mainImg);
 }
 
 // Wy≈ÇƒÖcz r√≥wnie≈º klikniƒôcie w kontener (ale przepu≈õƒá klikniƒôcia strza≈Çek)
 mainImageContainer.addEventListener('click', (e) => {
 // Pozw√≥l na klikniƒôcia przycisk√≥w nawigacji
 if (e.target.closest && e.target.closest('.etsy-nav-btn')) {
 return;
 }
 e.preventDefault();
 e.stopPropagation();
 }, true);
 
 // Licznik zdjƒôƒá
 const counter = document.createElement('div');
 counter.className = 'etsy-counter';
 counter.textContent = `1 / ${imageUrls.length}`;
 counter.style.cssText = `
 position: absolute;
 bottom: 16px;
 right: 16px;
 background: rgba(0, 0, 0, 0.7);
 color: white;
 padding: 6px 12px;
 border-radius: 16px;
 font-size: 14px;
 `;
 mainImageContainer.appendChild(counter);
 
 // Strza≈Çka LEWA na g≈Ç√≥wnym obrazie
 const prevBtn = document.createElement('button');
 prevBtn.innerHTML = '‚Äπ';
 prevBtn.className = 'etsy-nav-btn prev';
 prevBtn.style.cssText = `
 position: absolute;
 left: 16px;
 top: 50%;
 transform: translateY(-50%);
 width: 40px;
 height: 40px;
 background: rgba(255, 255, 255, 0.9);
 border: none;
 border-radius: 50%;
 cursor: pointer;
 font-size: 28px;
 font-weight: bold;
 display: flex;
 align-items: center;
 justify-content: center;
 box-shadow: 0 2px 8px rgba(0,0,0,0.2);
 transition: all 0.2s ease;
 z-index: 10;
 `;
 
 // Strza≈Çka PRAWA na g≈Ç√≥wnym obrazie
 const nextBtn = document.createElement('button');
 nextBtn.innerHTML = '‚Ä∫';
 nextBtn.className = 'etsy-nav-btn next';
 nextBtn.style.cssText = `
 position: absolute;
 right: 16px;
 top: 50%;
 transform: translateY(-50%);
 width: 40px;
 height: 40px;
 background: rgba(255, 255, 255, 0.9);
 border: none;
 border-radius: 50%;
 cursor: pointer;
 font-size: 28px;
 font-weight: bold;
 display: flex;
 align-items: center;
 justify-content: center;
 box-shadow: 0 2px 8px rgba(0,0,0,0.2);
 transition: all 0.2s ease;
 z-index: 10;
 `;
 
 mainImageContainer.appendChild(prevBtn);
 mainImageContainer.appendChild(nextBtn);
 }
 
 // POTEM stw√≥rz kontener dla miniaturek z nawigacjƒÖ (poziomo poni≈ºej)
 let thumbsNavigationContainer = galleryGrid.querySelector('.etsy-thumbs-navigation');
 let thumbsRow = null;
 let thumbsPrevBtn = null;
 let thumbsNextBtn = null;
 
 if (!thumbsNavigationContainer) {
 thumbsNavigationContainer = document.createElement('div');
 thumbsNavigationContainer.className = 'etsy-thumbs-navigation';
 thumbsNavigationContainer.style.cssText = `
 display: flex;
 align-items: center;
 gap: 12px;
 width: 100%;
 `;
 
 // Strza≈Çka LEWA dla miniaturek
 thumbsPrevBtn = document.createElement('button');
 thumbsPrevBtn.innerHTML = '‚Äπ';
 thumbsPrevBtn.style.cssText = `
 width: 36px;
 height: 36px;
 background: white;
 border: 1px solid #e0e0e0;
 border-radius: 50%;
 cursor: pointer;
 font-size: 24px;
 font-weight: bold;
 display: flex;
 align-items: center;
 justify-content: center;
 flex-shrink: 0;
 box-shadow: 0 2px 4px rgba(0,0,0,0.1);
 transition: all 0.2s ease;
 `;
 
 // Kontener miniaturek
 thumbsRow = document.createElement('div');
 thumbsRow.className = 'etsy-thumbnails-row';
 thumbsRow.style.cssText = `
 display: flex;
 flex-direction: row;
 gap: 8px;
 overflow-x: auto;
 overflow-y: hidden;
 padding: 10px 0;
 flex: 1;
 scrollbar-width: none;
 -ms-overflow-style: none;
 `;
 thumbsRow.style.setProperty('-webkit-scrollbar', 'none');
 
 // Strza≈Çka PRAWA dla miniaturek
 thumbsNextBtn = document.createElement('button');
 thumbsNextBtn.innerHTML = '‚Ä∫';
 thumbsNextBtn.style.cssText = `
 width: 36px;
 height: 36px;
 background: white;
 border: 1px solid #e0e0e0;
 border-radius: 50%;
 cursor: pointer;
 font-size: 24px;
 font-weight: bold;
 display: flex;
 align-items: center;
 justify-content: center;
 flex-shrink: 0;
 box-shadow: 0 2px 4px rgba(0,0,0,0.1);
 transition: all 0.2s ease;
 `;
 
 // Event listenery dla strza≈Çek miniaturek
 if (thumbsRow) {
 thumbsPrevBtn.addEventListener('click', (e) => {
 e.preventDefault();
 thumbsRow.scrollBy({ left: -200, behavior: 'smooth' });
 });
 
 thumbsNextBtn.addEventListener('click', (e) => {
 e.preventDefault();
 thumbsRow.scrollBy({ left: 200, behavior: 'smooth' });
 });
 }
 
 // Hover effects
 [thumbsPrevBtn, thumbsNextBtn].forEach(btn => {
 if (btn) {
 btn.addEventListener('mouseenter', () => {
 btn.style.background = '#f5f5f5';
 btn.style.transform = 'scale(1.1)';
 });
 btn.addEventListener('mouseleave', () => {
 btn.style.background = 'white';
 btn.style.transform = 'scale(1)';
 });
 }
 });
 
 // Przenie≈õ miniaturki
 if (thumbsRow) {
 allImages.forEach((img, index) => {
 const thumb = img.cloneNode(true);
 
 // Usu≈Ñ wszystkie atrybuty kt√≥re mogƒÖ powodowaƒá zoom/modal
 const links = thumb.querySelectorAll('a, button');
 links.forEach(link => {
 link.removeAttribute('href');
 link.removeAttribute('data-modal');
 link.removeAttribute('data-pswp-width');
 link.removeAttribute('data-pswp-height');
 link.style.pointerEvents = 'none'; // Wy≈ÇƒÖcz klikniƒôcia w linki
 });
 
 thumb.style.cssText = `
 width: 80px;
 height: 80px;
 border: 2px solid #e0e0e0;
 border-radius: 4px;
 cursor: pointer;
 transition: all 0.2s ease;
 flex-shrink: 0;
 `;
 
 // Dodaj active state
 if (index === 0) {
 thumb.style.borderColor = '#000';
 }
 
 // Klikniƒôcie zmienia g≈Ç√≥wny obraz (BEZ ZOOM/MODAL)
 thumb.addEventListener('click', (e) => {
 e.preventDefault(); // Zatrzymaj domy≈õlne zachowanie Shopify
 e.stopPropagation(); // Zatrzymaj propagacjƒô (zoom/modal)
 
 // Aktualizuj currentIndex (dla synchronizacji ze strza≈Çkami)
 currentIndex = index;
 
 // Usu≈Ñ active ze wszystkich
 thumbsRow.querySelectorAll('li').forEach(t => {
 t.style.borderColor = '#e0e0e0';
 });
 // Dodaj active
 thumb.style.borderColor = '#000';
 
 // Zmie≈Ñ g≈Ç√≥wny obraz u≈ºywajƒÖc zapisanego URL
 const mainImg = mainImageContainer.querySelector('img');
 if (mainImg && imageUrls[index]) {
 mainImg.src = imageUrls[index];
 // Aktualizuj licznik
 const counter = mainImageContainer.querySelector('.etsy-counter');
 if (counter) {
 counter.textContent = `${index + 1} / ${imageUrls.length}`;
 }
 }
 }, true); // useCapture = true (przechwytuj PRZED Shopify)
 
 thumbsRow.appendChild(thumb);
 });
 }
 
 // Sk≈Çadaj nawigacjƒô miniaturek (tylko je≈õli wszystkie elementy istniejƒÖ)
 if (thumbsNavigationContainer && thumbsPrevBtn && thumbsRow && thumbsNextBtn) {
 thumbsNavigationContainer.appendChild(thumbsPrevBtn);
 thumbsNavigationContainer.appendChild(thumbsRow);
 thumbsNavigationContainer.appendChild(thumbsNextBtn);
 
 // Dodaj NAJPIERW g≈Ç√≥wny obraz (g√≥ra)
 if (mainImageContainer && !galleryGrid.querySelector('.etsy-main-image')) {
 galleryGrid.appendChild(mainImageContainer);
 }
 
 // POTEM miniaturki z nawigacjƒÖ (d√≥≈Ç)
 galleryGrid.appendChild(thumbsNavigationContainer);
 } else {
 console.warn('‚ö†Ô∏è [ETSY GALLERY] Nie mo≈ºna utworzyƒá galerii - brakuje element√≥w:', {
 thumbsNavigationContainer: !!thumbsNavigationContainer,
 thumbsPrevBtn: !!thumbsPrevBtn,
 thumbsRow: !!thumbsRow,
 thumbsNextBtn: !!thumbsNextBtn
 });
 }
 }
 
 // Event listenery dla strza≈Çek g≈Ç√≥wnego obrazu (NA ZEWNƒÑTRZ if'a - dzia≈ÇajƒÖ zawsze)
 const prevBtn = mainImageContainer.querySelector('.etsy-nav-btn.prev');
 const nextBtn = mainImageContainer.querySelector('.etsy-nav-btn.next');
 const counter = mainImageContainer.querySelector('.etsy-counter');
 const mainImg = mainImageContainer.querySelector('img');
 // ‚úÖ U≈ºyj istniejƒÖcej zmiennej thumbsRow (zadeklarowanej wcze≈õniej) - NIE deklaruj ponownie!
 if (!thumbsRow) {
 thumbsRow = galleryGrid.querySelector('.etsy-thumbnails-row');
 }
 
 console.log('üîß [ETSY GALLERY] Elementy znalezione:', {
 prevBtn: !!prevBtn,
 nextBtn: !!nextBtn,
 mainImg: !!mainImg,
 thumbsRow: !!thumbsRow,
 counter: !!counter
 });
 
 if (prevBtn && nextBtn && mainImg && thumbsRow) {
 // Usu≈Ñ stare event listenery (klonuj przyciski)
 const newPrevBtn = prevBtn.cloneNode(true);
 const newNextBtn = nextBtn.cloneNode(true);
 prevBtn.replaceWith(newPrevBtn);
 nextBtn.replaceWith(newNextBtn);
 
 newPrevBtn.addEventListener('click', (e) => {
 e.preventDefault();
 e.stopPropagation();
 
 currentIndex = currentIndex === 0 ? imageUrls.length - 1 : currentIndex - 1;
 
 // Zmie≈Ñ obraz u≈ºywajƒÖc zapisanego URL
 if (mainImg && imageUrls[currentIndex]) {
 mainImg.src = imageUrls[currentIndex];
 counter.textContent = `${currentIndex + 1} / ${imageUrls.length}`;
 
 // Aktualizuj active state miniaturek
 if (thumbsRow) {
 thumbsRow.querySelectorAll('li').forEach((t, i) => {
 t.style.borderColor = i === currentIndex ? '#000' : '#e0e0e0';
 });
 }
 
 }
 });
 
 newNextBtn.addEventListener('click', (e) => {
 e.preventDefault();
 e.stopPropagation();
 
 currentIndex = currentIndex === imageUrls.length - 1 ? 0 : currentIndex + 1;
 
 // Zmie≈Ñ obraz u≈ºywajƒÖc zapisanego URL
 if (mainImg && imageUrls[currentIndex]) {
 mainImg.src = imageUrls[currentIndex];
 counter.textContent = `${currentIndex + 1} / ${imageUrls.length}`;
 
 // Aktualizuj active state miniaturek
 if (thumbsRow) {
 thumbsRow.querySelectorAll('li').forEach((t, i) => {
 t.style.borderColor = i === currentIndex ? '#000' : '#e0e0e0';
 });
 }
 
 }
 });
 
 // Hover effects dla strza≈Çek g≈Ç√≥wnego obrazu
 [newPrevBtn, newNextBtn].forEach(btn => {
 btn.addEventListener('mouseenter', () => {
 btn.style.background = 'white';
 btn.style.transform = 'translateY(-50%) scale(1.1)';
 });
 btn.addEventListener('mouseleave', () => {
 btn.style.background = 'rgba(255, 255, 255, 0.9)';
 btn.style.transform = 'translateY(-50%) scale(1)';
 });
 });
 
 } else {
 console.error('‚ùå [ETSY] Brak element√≥w:', { prevBtn, nextBtn, mainImg, thumbsRow });
 }
 
 // Usu≈Ñ oryginalne elementy
 allImages.forEach(img => img.remove());
 
 galleryGrid.classList.add('etsy-gallery-initialized');
 }
 
 // STANDARD CAROUSEL (dla innych produkt√≥w)
 function createStandardCarousel(galleryGrid) {
 // UKRYJ SLIDESHOW-COMPONENT NA MOBILE (powoduje duplikacjƒô g≈Ç√≥wnego zdjƒôcia)
 if (window.innerWidth <= 749) {
 const slideshow = document.querySelector('slideshow-component');
 if (slideshow) {
 slideshow.style.setProperty('display', 'none', 'important');
 slideshow.style.setProperty('visibility', 'hidden', 'important');
 slideshow.style.setProperty('opacity', '0', 'important');
 slideshow.style.setProperty('height', '0', 'important');
 slideshow.style.setProperty('overflow', 'hidden', 'important');
 }
 }
 
 // Dodaj aktywnƒÖ nawigacjƒô na stronach polityk
 if (window.location.pathname.includes('/policies/')) {
 addPolicyNavigation();
 }
 
 // Wymu≈õ nowe wymiary przez JavaScript - KARUZELA
 galleryGrid.style.setProperty('display', 'flex', 'important');
 galleryGrid.style.setProperty('flex-direction', 'column', 'important');
 galleryGrid.style.setProperty('height', 'auto', 'important');
 galleryGrid.style.setProperty('width', '100%', 'important');
 
 // Stw√≥rz kontener dla miniaturek z nawigacjƒÖ
 let thumbnailsContainer = galleryGrid.querySelector('.thumbnails-container');
 if (!thumbnailsContainer) {
 // Kontener z nawigacjƒÖ
 const navigationContainer = document.createElement('div');
 navigationContainer.className = 'thumbnails-navigation';
 navigationContainer.style.cssText = `
 position: relative;
 display: flex;
 align-items: center;
 gap: 10px;
 `;
 
 // Przycisk lewo
 const leftBtn = document.createElement('button');
 leftBtn.innerHTML = '‚Üê';
 leftBtn.className = 'thumbnails-nav-btn left';
 leftBtn.style.cssText = `
 background: white;
 color: #333;
 border: 1px solid #e0e0e0;
 border-radius: 50%;
 width: 36px;
 height: 36px;
 cursor: pointer;
 font-size: 16px;
 display: flex;
 align-items: center;
 justify-content: center;
 flex-shrink: 0;
 box-shadow: 0 2px 4px rgba(0,0,0,0.1);
 transition: all 0.2s ease;
 `;
 
 // Kontener miniaturek
 thumbnailsContainer = document.createElement('div');
 thumbnailsContainer.className = 'thumbnails-container';
 thumbnailsContainer.style.cssText = `
 display: flex;
 gap: 10px;
 overflow-x: auto;
 padding: 10px 0;
 scroll-behavior: smooth;
 flex: 1;
 scrollbar-width: none;
 -ms-overflow-style: none;
 `;
 thumbnailsContainer.style.webkitScrollbar = 'none';
 
 // Przycisk prawo
 const rightBtn = document.createElement('button');
 rightBtn.innerHTML = '‚Üí';
 rightBtn.className = 'thumbnails-nav-btn right';
 rightBtn.style.cssText = `
 background: white;
 color: #333;
 border: 1px solid #e0e0e0;
 border-radius: 50%;
 width: 36px;
 height: 36px;
 cursor: pointer;
 font-size: 16px;
 display: flex;
 align-items: center;
 justify-content: center;
 flex-shrink: 0;
 box-shadow: 0 2px 4px rgba(0,0,0,0.1);
 transition: all 0.2s ease;
 `;
 
 // Przenie≈õ miniaturki do kontenera
 const thumbnails = Array.from(galleryGrid.querySelectorAll('li:not(:first-child)'));
 thumbnails.forEach(thumb => {
 thumbnailsContainer.appendChild(thumb);
 });
 
 // Sk≈Çadaj nawigacjƒô
 navigationContainer.appendChild(leftBtn);
 navigationContainer.appendChild(thumbnailsContainer);
 navigationContainer.appendChild(rightBtn);
 
 galleryGrid.appendChild(navigationContainer);
 
 // Event listeners dla przycisk√≥w
 leftBtn.addEventListener('click', () => {
 thumbnailsContainer.scrollBy({ left: -100, behavior: 'smooth' });
 });
 
 rightBtn.addEventListener('click', () => {
 thumbnailsContainer.scrollBy({ left: 100, behavior: 'smooth' });
 });
 
 // Hover effects
 leftBtn.addEventListener('mouseenter', () => {
 leftBtn.style.background = '#f5f5f5';
 leftBtn.style.borderColor = '#ccc';
 leftBtn.style.transform = 'scale(1.05)';
 });
 
 leftBtn.addEventListener('mouseleave', () => {
 leftBtn.style.background = 'white';
 leftBtn.style.borderColor = '#e0e0e0';
 leftBtn.style.transform = 'scale(1)';
 });
 
 rightBtn.addEventListener('mouseenter', () => {
 rightBtn.style.background = '#f5f5f5';
 rightBtn.style.borderColor = '#ccc';
 rightBtn.style.transform = 'scale(1.05)';
 });
 
 rightBtn.addEventListener('mouseleave', () => {
 rightBtn.style.background = 'white';
 rightBtn.style.borderColor = '#e0e0e0';
 rightBtn.style.transform = 'scale(1)';
 });
 }
 
 // G≈Ç√≥wne zdjƒôcie - WYPE≈ÅNIA CA≈ÅƒÑ SZEROKO≈öƒÜ
 const mainImage = galleryGrid.querySelector('li:first-child');
 if (mainImage) {
 // Usu≈Ñ klasy kt√≥re ograniczajƒÖ wymiary
 mainImage.classList.remove('constrain-height', 'media-fit-contain');
 mainImage.classList.add('media-fit'); // Dodaj klasƒô kt√≥ra wype≈Çnia
 
 mainImage.style.setProperty('height', 'auto', 'important'); // RESPONSIVE
 mainImage.style.setProperty('width', '100%', 'important');
 mainImage.style.setProperty('aspect-ratio', '1 / 1', 'important'); // KWADRAT RESPONSIVE
 mainImage.style.setProperty('grid-row', '1 / 2', 'important');
 mainImage.style.setProperty('grid-column', '1 / 4', 'important'); // WSZYSTKIE 3 KOLUMNY
 mainImage.style.setProperty('margin', '0', 'important');
 mainImage.style.setProperty('max-height', 'none', 'important');
 
 const mainImg = mainImage.querySelector('img');
 if (mainImg) {
 mainImg.style.setProperty('height', '100%', 'important'); // RESPONSIVE
 mainImg.style.setProperty('width', '100%', 'important');
 mainImg.style.setProperty('object-fit', 'cover', 'important');
 mainImg.style.setProperty('object-position', 'center', 'important');
 mainImg.style.setProperty('aspect-ratio', 'inherit', 'important'); // Dziedzicz z kontenera
 }
 }
 
 // Miniaturki - KARUZELA
 const thumbnails = thumbnailsContainer.querySelectorAll('li');
 thumbnails.forEach((thumb) => {
 // Usu≈Ñ inline styles kt√≥re blokujƒÖ
 thumb.removeAttribute('style');
 
 // Ustaw nowe wymiary - KARUZELA
 thumb.style.setProperty('height', '90px', 'important');
 thumb.style.setProperty('width', '90px', 'important');
 thumb.style.setProperty('aspect-ratio', '1 / 1', 'important');
 thumb.style.setProperty('flex-shrink', '0', 'important'); // Nie kurcz siƒô
 
 // Styluj kontener product-media
 const productMedia = thumb.querySelector('.product-media');
 if (productMedia) {
 productMedia.style.setProperty('width', '100%', 'important');
 productMedia.style.setProperty('height', '100%', 'important');
 productMedia.style.setProperty('aspect-ratio', '1 / 1', 'important');
 }
 
 const thumbImg = thumb.querySelector('img');
 if (thumbImg) {
 thumbImg.style.setProperty('object-fit', 'cover', 'important');
 thumbImg.style.setProperty('width', '100%', 'important');
 thumbImg.style.setProperty('height', '100%', 'important');
 }
 });
 
 }

 // Uruchom naprawƒô galerii po za≈Çadowaniu strony
 document.addEventListener('DOMContentLoaded', function() {
 // Czekaj a≈º galeria siƒô za≈Çaduje
 setTimeout(fixGalleryProportions, 1500);
 
 // Uruchom ponownie co 500ms ≈ºeby nadpisaƒá style Shopify
 setInterval(fixGalleryProportions, 500);
 
 // Dodaj nawigacjƒô w stopce (na wszystkich stronach)
 addPolicyNavigation();
 
 // Ukryj starƒÖ sekcjƒô polityk
 hideOldPolicySection();
 
 // NAPRAWA POWIƒòKSZONYCH ZDJƒòƒÜ W DIALOGU
 // Event listener dla klikniƒôƒá w przyciski powiƒôkszenia
 document.addEventListener('click', function(e) {
 const zoomButton = e.target.closest('.product-media-container__zoom-button, button[class*="zoom"]');
 if (zoomButton) {
 setTimeout(fixDialogImages, 100); // Czekaj a≈º dialog siƒô otworzy
 setTimeout(fixDialogImages, 300); // Ponownie po za≈Çadowaniu
 setTimeout(fixDialogImages, 600); // I jeszcze raz dla pewno≈õci
 }
 });
 
 // Regularnie sprawdzaj czy dialog jest otwarty i naprawiaj
 setInterval(fixDialogImages, 300);
 });
 </script>

 {{ content_for_header }}
 </head>

 <body class="page-width-{{ settings.page_width }} card-hover-effect-{{ settings.card_hover_effect }}">
 {% render 'skip-to-content-link', href: '#MainContent', text: 'accessibility.skip_to_text' %}

 <script>
 (function() {
 const isLoggedIn = {{ customer.id | json }} !== null;
 if (!isLoggedIn) {
 return;
 }
 try {
 const authIntent = localStorage.getItem('customify_auth_intent');
 if (!authIntent) {
 return;
 }
 const timestampRaw = localStorage.getItem('customify_auth_intent_timestamp');
 const timestamp = timestampRaw ? parseInt(timestampRaw, 10) : null;
 const authSource = localStorage.getItem('customify_auth_source');
 const MAX_AGE_MS = 30 * 60 * 1000; // 30 minut na wys≈Çanie zdarzenia
 if (timestamp && (Date.now() - timestamp) > MAX_AGE_MS) {
 localStorage.removeItem('customify_auth_intent');
 localStorage.removeItem('customify_auth_intent_timestamp');
 localStorage.removeItem('customify_auth_source');
 return;
 }
 const isRegisterIntent = authIntent.startsWith('register');
 const eventType = isRegisterIntent ? 'login_modal_register_success' : 'login_modal_login_success';
 fetch('https://customify-s56o.vercel.app/api/admin/login-modal-stats', {
 method: 'POST',
 headers: { 'Content-Type': 'application/json' },
 body: JSON.stringify({
 eventType,
 productUrl: authSource || localStorage.getItem('customify_return_url') || window.location.pathname,
 timestamp: new Date().toISOString(),
 sourcePage: window.location.pathname
 })
 }).catch(function(err) {
 console.warn('üìä [AUTH SUCCESS] Failed to send event:', err);
 }).finally(function() {
 localStorage.removeItem('customify_auth_intent');
 localStorage.removeItem('customify_auth_intent_timestamp');
 localStorage.removeItem('customify_auth_source');
 });
 } catch (error) {
 console.warn('üìä [AUTH SUCCESS] Tracking error:', error);
 }
 })();
 </script>

 <script>
 (function() {
 // Funkcja dodajƒÖca link "Moje obrazy" do menu konta klienta
 function addMyImagesLink() {
 // Sprawd≈∫ czy jeste≈õmy na stronie konta klienta (Shopify Customer Account API)
 const isAccountPage = window.location.hostname.includes('account.') || 
 window.location.pathname.startsWith('/account') ||
 document.querySelector('[data-customer-account]');
 
 if (!isAccountPage) {
 return;
 }

 // Sprawd≈∫ czy link ju≈º istnieje
 const existingLink = document.querySelector('a[href="/pages/my-generations"], a[href*="my-generations"]');
 if (existingLink) {
 console.log('‚úÖ [ACCOUNT-MENU] Link "Moje obrazy" ju≈º istnieje');
 return true;
 }

 // R√≥≈ºne selektory dla menu konta klienta w Shopify Customer Account API
 const menuSelectors = [
 'nav[aria-label*="Account"]',
 'nav[aria-label*="Konto"]',
 'nav[role="navigation"]',
 'nav ul',
 'aside nav',
 'aside nav ul',
 '[role="navigation"] ul',
 'nav > ul',
 'ul[role="list"]'
 ];

 let menuElement = null;
 let ordersLink = null;

 // Szukaj menu i linku "Zam√≥wienia" jednocze≈õnie
 for (const selector of menuSelectors) {
 const elements = document.querySelectorAll(selector);
 for (const el of elements) {
 // Sprawd≈∫ czy to menu (zawiera linki)
 const links = el.querySelectorAll('a');
 if (links.length === 0) continue;

 // Szukaj linku "Zam√≥wienia" w tym menu
 for (const link of links) {
 const text = link.textContent.trim().toLowerCase();
 if (text.includes('zam√≥wienia') || text.includes('orders') || text.includes('order')) {
 menuElement = el;
 ordersLink = link;
 break;
 }
 }
 
 if (menuElement && ordersLink) break;
 }
 if (menuElement && ordersLink) break;
 }

 // Alternatywnie: szukaj bezpo≈õrednio linku "Zam√≥wienia" i znajd≈∫ jego menu
 if (!menuElement || !ordersLink) {
 const allLinks = document.querySelectorAll('nav a, aside a');
 for (const link of allLinks) {
 const text = link.textContent.trim().toLowerCase();
 if (text.includes('zam√≥wienia') || text.includes('orders') || text.includes('order')) {
 ordersLink = link;
 menuElement = link.closest('ul') || link.closest('nav') || link.parentElement;
 break;
 }
 }
 }

 if (!menuElement || !ordersLink) {
 console.log('üîç [ACCOUNT-MENU] Menu lub link "Zam√≥wienia" nie znalezione');
 return false;
 }

 const ordersListItem = ordersLink.closest('li') || ordersLink.parentElement;
 if (!ordersListItem) {
 console.log('üîç [ACCOUNT-MENU] Nie mo≈ºna znale≈∫ƒá elementu listy dla "Zam√≥wienia"');
 return false;
 }

 // Utw√≥rz nowy element listy z linkiem "Moje obrazy"
 const newListItem = document.createElement('li');
 if (ordersListItem.className) {
 newListItem.className = ordersListItem.className;
 }
 
 const newLink = document.createElement('a');
 newLink.href = '/pages/my-generations';
 newLink.textContent = 'Moje obrazy';
 if (ordersLink.className) {
 newLink.className = ordersLink.className;
 }
 // Skopiuj style z linku "Zam√≥wienia"
 if (ordersLink.style.cssText) {
 newLink.style.cssText = ordersLink.style.cssText;
 }
 
 newListItem.appendChild(newLink);

 // Dodaj link po "Zam√≥wienia"
 const parent = ordersListItem.parentElement;
 if (parent) {
 if (ordersListItem.nextSibling) {
 parent.insertBefore(newListItem, ordersListItem.nextSibling);
 } else {
 parent.appendChild(newListItem);
 }
 console.log('‚úÖ [ACCOUNT-MENU] Link "Moje obrazy" dodany do menu konta klienta');
 return true;
 }

 return false;
 }

 // Pr√≥buj dodaƒá link wielokrotnie (dla dynamicznych stron Shopify Customer Account API)
 function tryAddLink() {
 const maxAttempts = 10;
 let attempts = 0;
 
 const interval = setInterval(function() {
 attempts++;
 if (addMyImagesLink() || attempts >= maxAttempts) {
 clearInterval(interval);
 }
 }, 500);
 }

 // Start gdy DOM ready
 if (document.readyState === 'loading') {
 document.addEventListener('DOMContentLoaded', function() {
 tryAddLink();
 });
 } else {
 tryAddLink();
 }

 // Obserwuj zmiany w DOM (dla dynamicznych menu Shopify Customer Account API)
 const observer = new MutationObserver(function(mutations) {
 addMyImagesLink();
 });

 setTimeout(function() {
 const accountSection = document.querySelector('main') || document.querySelector('body');
 if (accountSection) {
 observer.observe(accountSection, {
 childList: true,
 subtree: true
 });
 }
 }, 1000);
 })();
 </script>

 <header class="header-main">
 
 <div class="header-top">
 <div class="header-container">
 
 <div class="header-logo">
 <a href="{{ routes.root_url }}" class="logo-link">
 {% if settings.logo != blank %}
 <img src="{{ settings.logo | image_url: width: 200 }}" alt="{{ shop.name }}" class="logo-image">
 {% else %}
 <span class="logo-text">{{ shop.name }}</span>
 {% endif %}
 </a>
 </div>

 <div class="header-right">
 <div class="header-user">
 {% if customer %}
 <div class="user-section">
 <a href="{{ routes.account_url }}" class="user-icon-wrapper">
 <svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="user-icon">
 <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
 <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
 </svg>
 </a>
 <div class="user-links">
 <a href="{{ routes.account_url }}" class="user-text-link">Moje konto</a>
 <a href="/pages/my-generations" class="user-text-link">Moje Obrazy</a>
 <a href="{{ routes.account_logout_url }}" class="user-text-link">Wyloguj siƒô</a>
 </div>
 </div>
 {% else %}
 <div class="user-section">
 <a href="{{ routes.account_login_url }}" class="user-icon-wrapper">
 <svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="user-icon">
 <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
 <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
 </svg>
 </a>
 <div class="user-links">
 <a href="{{ routes.account_login_url }}" class="user-text-link">Zaloguj</a>
 <a href="{{ routes.account_register_url }}" class="user-text-link">Zarejestruj</a>
 </div>
 </div>
 {% endif %}
 </div>

 <div class="header-cart">
 <a href="{{ routes.cart_url }}" class="cart-link">
 <div class="cart-icon-wrapper">
 <svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="cart-icon">
 <path d="M3 3H5L5.4 5M7 13H17L21 5H5.4M7 13L5.4 5M7 13L4.7 15.3C4.3 15.7 4.6 16.5 5.1 16.5H17M17 13V17C17 18.1 16.1 19 15 19H9C7.9 19 7 18.1 7 17V13M17 13H7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
 </svg>
 {% if cart.item_count > 0 %}
 <span class="cart-count">{{ cart.item_count }}</span>
 {% endif %}
 </div>
 <span class="cart-text">Koszyk</span>
 </a>
 </div>
 </div>
 </div>
 </div>

 <div class="header-bottom">
 <div class="header-container">
 <nav class="header-nav">
 {% comment %} TYLKO MENU Z SHOPIFY - main-menu-1 {% endcomment %}
 {% if linklists['main-menu-1'] and linklists['main-menu-1'].links.size > 0 %}
 {% for link in linklists['main-menu-1'].links %}
 <div class="nav-item">
 <a href="{{ link.url }}" class="nav-link">{{ link.title }}</a>
 </div>
 {% if customer and (link.title == 'Produkty' or link.url == '/collections/see_also') %}
 <div class="nav-item">
 <a href="/pages/my-generations" class="nav-link">Moje Obrazy</a>
 </div>
 {% endif %}
 {% endfor %}
 {% endif %}
 </nav>
 </div>
 </div>

 </header>

 {% if template contains 'product' or template contains 'collection' or template contains 'blog' %}
 <div class="breadcrumbs">
 <div class="breadcrumbs-container">
 <a href="{{ routes.root_url }}" class="breadcrumb-link">Home</a>
 {% if template contains 'product' %}
 <span class="breadcrumb-separator">/</span>
 <a href="/collections/all" class="breadcrumb-link">Produkty</a>
 <span class="breadcrumb-separator">/</span>
 <span class="breadcrumb-current">{{ product.title | truncate: 50 }}</span>
 {% elsif template contains 'collection' %}
 <span class="breadcrumb-separator">/</span>
 <span class="breadcrumb-current">{{ collection.title }}</span>
 {% elsif template contains 'blog' %}
 <span class="breadcrumb-separator">/</span>
 <a href="{{ blog.url }}" class="breadcrumb-link">{{ blog.title }}</a>
 {% if article %}
 <span class="breadcrumb-separator">/</span>
 <span class="breadcrumb-current">{{ article.title | truncate: 30 }}</span>
 {% endif %}
 {% endif %}
 </div>
 </div>
 {% endif %}

 <script
 src="{{ 'critical.js' | asset_url }}"
 type="module"
 async
 blocking="render"
 ></script>

 <main
 id="MainContent"
 class="content-for-layout"
 role="main"
 data-page-transition-enabled="{{ settings.page_transition_enabled }}"
 data-product-transition="{{ settings.transition_to_main_product }}"
 data-template="{{ template }}"
 >
 {{ content_for_layout }}

 {% if template contains 'article' and article %}
 {% assign related_collection_handle = '' %}
 {% for tag in article.tags %}
 {% if tag contains 'kolekcja:' %}
 {% assign related_collection_handle = tag | split: ':' | last | strip | downcase %}
 {% endif %}
 {% endfor %}

 {% if related_collection_handle != '' and collections[related_collection_handle] %}
 {% assign related_collection = collections[related_collection_handle] %}
 {% if related_collection.products_count > 0 %}
 <section class="customify-article-collection">
 <div class="customify-article-collection__header">
 <h2 class="customify-article-collection__title">Powiazane produkty</h2>
 <a class="customify-article-collection__link" href="{{ related_collection.url }}">Zobacz cala kolekcje</a>
 </div>
 <div class="customify-article-collection__grid">
 {% for product in related_collection.products limit: 8 %}
 <a class="customify-article-collection__card" href="{{ product.url }}">
 <div class="customify-article-collection__image">
 {% if product.featured_image %}
 <img src="{{ product.featured_image | image_url: width: 600 }}" alt="{{ product.title }}">
 {% endif %}
 </div>
 <div class="customify-article-collection__meta">
 <div class="customify-article-collection__name">{{ product.title }}</div>
 {% if product.price %}
 <div class="customify-article-collection__price">{{ product.price | money }}</div>
 {% endif %}
 </div>
 </a>
 {% endfor %}
 </div>
 </section>
 <style>
 .customify-article-collection { max-width: 1200px; margin: 40px auto 20px; padding: 0 20px; }
 .customify-article-collection__header { display: flex; align-items: baseline; justify-content: space-between; gap: 16px; margin-bottom: 16px; }
 .customify-article-collection__title { font-size: 1.6rem; margin: 0; }
 .customify-article-collection__link { font-size: .95rem; text-decoration: none; color: #111; }
 .customify-article-collection__grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 16px; }
 .customify-article-collection__card { display: block; border: 1px solid #e5e5e5; border-radius: 8px; overflow: hidden; background: #fff; text-decoration: none; color: inherit; transition: box-shadow .2s ease, transform .2s ease; }
 .customify-article-collection__card:hover { box-shadow: 0 6px 18px rgba(0,0,0,.08); transform: translateY(-2px); }
 .customify-article-collection__image { aspect-ratio: 1 / 1; background: #f8f9fa; display: flex; align-items: center; justify-content: center; }
 .customify-article-collection__image img { width: 100%; height: 100%; object-fit: cover; }
 .customify-article-collection__meta { padding: 10px 12px; }
 .customify-article-collection__name { font-weight: 600; font-size: .95rem; margin-bottom: 6px; }
 .customify-article-collection__price { color: #000000; font-weight: 700; }
 @media (max-width: 768px) {
 .customify-article-collection__header { flex-direction: column; align-items: flex-start; }
 }
 </style>
 {% endif %}
 {% endif %}
 {% endif %}

 {% if template contains 'collection' %}
 <div class="custom-collection-wrapper">
 <h1 class="custom-collection-title">{{ collection.title }}</h1>
 {% if collection.description != blank %}
 <div class="custom-collection-description">{{ collection.description }}</div>
 {% endif %}
 {% if collection.products_count > 0 %}
 {% if collection.handle == 'all' %}
 {% paginate collection.products by 1000 %}
 <div class="custom-collection-grid">
 {% for product in collection.products %}
 {% if collection.handle == 'see_also' %}
 {% assign is_hidden_product = product.url contains 'rozmiar' or product.url contains 'cyfrowy' %}
 {% if is_hidden_product %}
 {% continue %}
 {% endif %}
 {% endif %}
 <a href="{{ product.url }}" class="custom-collection-card">
 <div class="custom-collection-image">
 {% if product.featured_image %}
 <img src="{{ product.featured_image | image_url: width: 600 }}" alt="{{ product.title }}">
 {% endif %}
 </div>
 <div class="custom-collection-meta">
 <div class="custom-collection-card-title">{{ product.title }}</div>
 {% if product.price %}
 <div class="custom-collection-price">{{ product.price | money }}</div>
 {% endif %}
 </div>
 </a>
 {% endfor %}
 </div>
 {% endpaginate %}
 {% else %}
 {% paginate collection.products by 250 %}
 <div class="custom-collection-grid">
 {% for product in collection.products %}
 <a href="{{ product.url }}" class="custom-collection-card">
 <div class="custom-collection-image">
 {% if product.featured_image %}
 <img src="{{ product.featured_image | image_url: width: 600 }}" alt="{{ product.title }}">
 {% endif %}
 </div>
 <div class="custom-collection-meta">
 <div class="custom-collection-card-title">{{ product.title }}</div>
 {% if product.price %}
 <div class="custom-collection-price">{{ product.price | money }}</div>
 {% endif %}
 </div>
 </a>
 {% endfor %}
 </div>
 {% if paginate.pages > 1 %}
 <div class="custom-collection-pagination" style="margin-top: 30px; text-align: center;">
 {% if paginate.previous %}
 <a href="{{ paginate.previous.url }}" class="pagination-link" style="margin: 0 10px; padding: 8px 16px; background: #f5f5f5; border-radius: 4px; text-decoration: none; color: #333;">‚Üê Poprzednia</a>
 {% endif %}
 <span style="margin: 0 10px; padding: 8px 16px;">Strona {{ paginate.current_page }} z {{ paginate.pages }}</span>
 {% if paginate.next %}
 <a href="{{ paginate.next.url }}" class="pagination-link" style="margin: 0 10px; padding: 8px 16px; background: #f5f5f5; border-radius: 4px; text-decoration: none; color: #333;">Nastƒôpna ‚Üí</a>
 {% endif %}
 </div>
 {% endif %}
 {% endpaginate %}
 {% endif %}
 {% else %}
 <div class="custom-collection-empty">Brak produkt√≥w do wy≈õwietlenia.</div>
 {% endif %}
 </div>
 {% endif %}
 </main>

 {% render 'search-modal' %}

 {% if settings.quick_add or settings.mobile_quick_add %}
 {% render 'quick-add-modal' %}
 {% endif %}

 {% comment %} CUSTOMIFY AI PHOTO CUSTOMIZATION {% endcomment %}
 {% if template contains 'product' %}
 <script>
 document.addEventListener('DOMContentLoaded', function() {
 const app = document.getElementById('customify-app-container');
 const placeholder = document.getElementById('customify-placeholder');
 if (app && placeholder) {
 placeholder.appendChild(app);
 }
 
 });
 </script>
 
 <script>
 // Przeka≈º dane produktu do JavaScript
 {% if product %}
 window.ShopifyProduct = {
 id: {{ product.id }},
 title: {{ product.title | json }},
 handle: {{ product.handle | json }},
 url: {{ product.url | json }},
 imageUrl: {{ product.featured_image | image_url: width: 600 | json }},
 variants: {{ product.variants | json }},
 options: {{ product.options | json }},
 price: {{ product.price | money | json }}
 };
 console.log('üì¶ [SHOPIFY PRODUCT] Product data loaded:', window.ShopifyProduct);
 {% endif %}
 </script>

 <script>
 (function() {
 if (!window.ShopifyProduct || !window.ShopifyProduct.id) return;
 if (window.__customifyProductStatsInit) return;
 window.__customifyProductStatsInit = true;

 const TRACK_URL = 'https://customify-s56o.vercel.app/api/admin/product-performance-stats';
 const productMeta = {
 productId: window.ShopifyProduct.id,
 productHandle: window.ShopifyProduct.handle,
 productTitle: window.ShopifyProduct.title,
 productUrl: window.location.href.split('#')[0],
 imageUrl: window.ShopifyProduct.imageUrl || null
 };

 const sendEvent = async (eventType, extra = {}) => {
 try {
 await fetch(TRACK_URL, {
 method: 'POST',
 headers: { 'Content-Type': 'application/json' },
 body: JSON.stringify({
 eventType,
 timestamp: new Date().toISOString(),
 ...productMeta,
 ...extra
 })
 });
 } catch (error) {
 console.warn('‚ö†Ô∏è [PRODUCT-STATS] Failed to send event:', eventType, error?.message || error);
 }
 };
 window.__customifyProductStatsSendEvent = sendEvent;

 document.addEventListener('DOMContentLoaded', function() {
 sendEvent('product_view');
 const transformBtn = document.getElementById('transformBtn');
 if (transformBtn) {
 transformBtn.addEventListener('click', function() {
 sendEvent('generate_click');
 });
 }
 });

 if (typeof window.fetch === 'function' && !window.__customifyProductStatsFetchWrapped) {
 const originalFetch = window.fetch.bind(window);
 window.__customifyProductStatsFetchWrapped = true;
 window.fetch = async function(...args) {
 const url = typeof args[0] === 'string' ? args[0] : args[0]?.url;
 const isTransformCall = url && url.includes('/api/transform');
 if (!isTransformCall) {
 return originalFetch(...args);
 }
 try {
 const response = await originalFetch(...args);
 if (response?.ok) {
 sendEvent('api_success', { status: response.status });
 } else {
 sendEvent('api_error', { status: response?.status || null });
 }
 return response;
 } catch (error) {
 sendEvent('api_error', { error: error?.message || 'fetch_error' });
 throw error;
 }
 };
 }
 })();
 </script>
 
 <div id="customify-app-container" class="customify-shopify-container">
 
 <div class="customify-product-type-selector{% if product.handle == 'personalizowane-etui-na-telefon-z-twoim-zdjeciem' %} hide-for-phone-case{% endif %}" id="productTypeArea" style="display: block; margin-bottom: 10px;">
 <h4 style="text-align: left; font-size: 0.95rem; font-weight: 600;">Rodzaj wydruku:</h4>
 <div class="customify-product-type-buttons">
 {% comment %} FILTRUJ RODZAJE WYDRUKU PER PRODUKT {% endcomment %}
 {% if product.handle == 'karykatura-na-zamowienie-druk-na-szkle-akrylowym-ramka-z-podswietleniem' or product.handle == 'prezent-dla-babci-i-dziadka-portret-na-na-szkle-akrylowym-ze-zdjecia-karykatura' or product.handle == 'dziadkowie-krolowie-nadruk-na-szkle' or product.handle == 'portret-pary-personalizowany-obraz-na-szkle-akrylowym' %}
 {% comment %} TYLKO SZK≈ÅO dla produkt√≥w na szkle akrylowym {% endcomment %}
 <div class="customify-product-type-btn active" data-product-type="szklo">
 Nadruk na szkle (dodaj podstawkƒô)
 </div>
 {% elsif product.handle == 'ramka-spotify' or product.handle == 'zdjecie-na-szkle-ramka-spotify' %}
 {% comment %} TYLKO SZK≈ÅO dla ramka-spotify {% endcomment %}
 <div class="customify-product-type-btn active" data-product-type="szklo">
 Nadruk na szkle (dodaj podstawkƒô)
 </div>
 {% else %}
 {% comment %} STANDARDOWE OPCJE dla innych produkt√≥w {% endcomment %}
 <div class="customify-product-type-btn active" data-product-type="plakat">
 Plakat (dodaj ramkƒô)
 </div>
 <div class="customify-product-type-btn" data-product-type="canvas">
 Obraz na p≈Ç√≥tnie
 </div>
 
 <div class="customify-product-type-btn" data-product-type="szklo">
 Nadruk na szkle (dodaj podstawkƒô)
 </div>
 
 <div class="customify-product-type-btn" data-product-type="digital">
 Produkt cyfrowy
 </div>
 
 {% endif %}
 </div>
 
 <div class="frame-color-selector" id="frameSelector" aria-expanded="false">
 <button type="button" class="frame-toggle" id="frameToggle">
 Ramka: <span id="frameCurrentLabel">Brak ramki</span>
 <span class="frame-caret">‚ñº</span>
 </button>
 <div class="frame-options" id="frameOptions" style="display: none;">
 <div class="frame-option" data-frame="none" aria-selected="true">Brak ramki</div>
 <div class="frame-option" data-frame="black">Czarna</div>
 <div class="frame-option" data-frame="white">Bia≈Ça</div>
 <div class="frame-option" data-frame="wood">Drewno</div>
 </div>
 </div>

 <div class="stand-selector" id="standSelector" aria-expanded="false" style="display: none;">
 <button type="button" class="stand-toggle" id="standToggle">
 Podstawka: <span id="standCurrentLabel">Brak podstawki</span>
 <span class="stand-caret">‚ñº</span>
 </button>
 <div class="stand-options" id="standOptions" style="display: none;">
 <div class="stand-option" data-stand="none" aria-selected="true">
 <span class="stand-option-text">Brak podstawki</span>
 </div>
 <div class="stand-option" data-stand="wood">
 <img src="https://customify-s56o.vercel.app/akryl/podstawka.png" alt="Podstawka drewniana" class="stand-option-image">
 <span class="stand-option-text">Podstawka drewniana</span>
 </div>
 <div class="stand-option" data-stand="led">
 <img src="https://customify-s56o.vercel.app/akryl/podstawka_led.png" alt="Podstawka z LED" class="stand-option-image">
 <span class="stand-option-text">Podstawka drewniana z LED</span>
 </div>
 </div>
 </div>
 </div>

<div class="customify-size-selector{% if product.handle == 'personalizowane-etui-na-telefon-z-twoim-zdjeciem' %} hide-for-phone-case{% endif %}" id="sizeArea" style="display: block; margin-bottom: 10px;">
<h4 style="text-align: left;">Rozmiar (cm):</h4>
 <div class="customify-size-buttons">
 <div class="customify-size-btn" data-size="a5" data-for-szklo="true">15√ó21</div>
 <div class="customify-size-btn" data-size="a4">20√ó30</div>
 <div class="customify-size-btn" data-size="a3">30√ó45</div>
 <div class="customify-size-btn" data-size="a2">40√ó60</div>
 <div class="customify-size-btn" data-size="a0">50√ó75</div>
 <div class="customify-size-btn" data-size="a1">60√ó90</div>
 </div>
 </div>
<div id="type-size-original-placeholder" style="display: contents;"></div>
{% if product.handle == 'personalizowane-etui-na-telefon-z-twoim-zdjeciem' %}<div id="phone-selectors-slot"></div>{% endif %}

<h3 class="customify-title">Wgraj zdjƒôcie i zobacz efekt od razu</h3>

 <div class="arrow-down">
 <span>‚Üì</span>
 <span>‚Üì</span>
 <span>‚Üì</span>
 </div>
 <div class="customify-inline-wrapper">
 <div class="customify-embed" id="customifyEmbed">
 <div class="customify-upload-area" id="uploadArea">
 <div class="customify-drop-zone" id="dropZone">
 <div class="drop-zone-content">
 <button class="customify-upload-btn" id="uploadBtn">
 Dodaj zdjƒôcie
 </button>
 </div>
 </div>
 <input type="file" id="fileInput" class="customify-file-input" accept="image/*">
 
 <div class="customify-error" id="errorMessage" style="display: none;"></div>
 </div>

 <div class="customify-preview" id="previewArea">
 <h4>Twoje zdjƒôcie:</h4>
 {% if product.handle == 'ramka-spotify' or product.handle == 'zdjecie-na-szkle-ramka-spotify' %}
 <div class="spotify-frame-preview">
 <div class="spotify-frame-inner">
 <img id="previewImage" alt="PodglƒÖd zdjƒôcia">
 
 <div class="spotify-text-overlay">
 <div class="spotify-text-title" id="spotifyTextTitlePreview"></div>
 <div class="spotify-text-artist" id="spotifyTextArtistPreview"></div>
 </div>
 </div>
 </div>
 {% elsif product.handle == 'personalizowane-etui-na-telefon-z-twoim-zdjeciem' %}
 <div class="phone-case-preview">
 <div class="phone-case-inner">
 <div class="phone-case-photo-bg" id="phoneCasePhotoBg"></div>
 <img class="phone-case-overlay" src="https://customify-s56o.vercel.app/phone/phone_ok.png" alt="">
 <img id="previewImage" alt="PodglƒÖd zdjƒôcia" style="display: none;">
 </div>
 </div>
 {% else %}
 <img id="previewImage" alt="PodglƒÖd zdjƒôcia">
 {% endif %}
 </div>

 {% if product.handle == 'ramka-spotify' or product.handle == 'zdjecie-na-szkle-ramka-spotify' %}
 {% if product.handle == 'zdjecie-na-szkle-ramka-spotify' %}
 
 <div class="spotify-filters-panel" id="spotifyFiltersPanel" style="display: none;">
 <h3 class="spotify-panel-title">‚ú® Popraw zdjƒôcie</h3>
 <p style="font-size: 0.85rem; color: #666; margin-bottom: 12px;">Kliknij na filtr, ≈ºeby zobaczyƒá efekt natychmiast</p>
 <div class="spotify-filters-grid">
 <div class="spotify-filter-btn active" data-filter="none">
 <div class="filter-preview" style="background: linear-gradient(135deg, #f5f5f5, #e0e0e0);"></div>
 <span>Orygina≈Ç</span>
 </div>
 <div class="spotify-filter-btn" data-filter="brighten">
 <div class="filter-preview" style="background: linear-gradient(135deg, #fff9c4, #fff59d);"></div>
 <span>Rozja≈õnij</span>
 </div>
 <div class="spotify-filter-btn" data-filter="vivid">
 <div class="filter-preview" style="background: linear-gradient(135deg, #e91e63, #9c27b0);"></div>
 <span>≈ªywe kolory</span>
 </div>
 <div class="spotify-filter-btn" data-filter="warm">
 <div class="filter-preview" style="background: linear-gradient(135deg, #ff9800, #ffb74d);"></div>
 <span>Ciep≈Çy</span>
 </div>
 <div class="spotify-filter-btn" data-filter="bw">
 <div class="filter-preview" style="background: linear-gradient(135deg, #212121, #757575);"></div>
 <span>Czarno-bia≈Çy</span>
 </div>
 <div class="spotify-filter-btn" data-filter="sharpen">
 <div class="filter-preview" style="background: linear-gradient(135deg, #37474f, #607d8b);"></div>
 <span>Wyostrz</span>
 </div>
 <div class="spotify-filter-btn" data-filter="vintage">
 <div class="filter-preview" style="background: linear-gradient(135deg, #8d6e63, #bcaaa4);"></div>
 <span>Vintage</span>
 </div>
 <div class="spotify-filter-btn" data-filter="dotScreen">
 <div class="filter-preview" style="background: linear-gradient(135deg, #424242, #757575);"></div>
 <span>Halftone</span>
 </div>
 </div>
 </div>

 <div class="spotify-text-panel" id="spotifyTextPanel">
 <h3 class="spotify-panel-title">Dodaj napis</h3>
 <div class="spotify-text-field">
 <label class="spotify-text-label">Nag≈Ç√≥wek <span class="required">*</span></label>
 <div class="spotify-input-wrapper">
 <input type="text" id="spotifyTitle" class="spotify-text-input spotify-text-input-large" placeholder="PRAWDZIWA MI≈ÅO≈öƒÜ" maxlength="30">
 <span class="spotify-char-counter" id="spotifyTitleCounter">0/30</span>
 </div>
 </div>
 <div class="spotify-text-field">
 <label class="spotify-text-label">Podpis <span class="required">*</span></label>
 <div class="spotify-input-wrapper">
 <input type="text" id="spotifyArtist" class="spotify-text-input spotify-text-input-large" placeholder="Sara i Janek" maxlength="40">
 <span class="spotify-char-counter" id="spotifyArtistCounter">0/40</span>
 </div>
 </div>
 </div>
 {% endif %}
 
 {% if product.handle == 'ramka-spotify' %}
 
 <div class="spotify-text-panel" id="spotifyTextPanel">
 <h3 class="spotify-panel-title">Dodaj napis</h3>
 <div class="spotify-text-field">
 <label class="spotify-text-label">Nag≈Ç√≥wek <span class="required">*</span></label>
 <div class="spotify-input-wrapper">
 <input type="text" id="spotifyTitle" class="spotify-text-input spotify-text-input-large" placeholder="PRAWDZIWA MI≈ÅO≈öƒÜ" maxlength="30">
 <span class="spotify-char-counter" id="spotifyTitleCounter">0/30</span>
 </div>
 </div>
 <div class="spotify-text-field">
 <label class="spotify-text-label">Podpis <span class="required">*</span></label>
 <div class="spotify-input-wrapper">
 <input type="text" id="spotifyArtist" class="spotify-text-input spotify-text-input-large" placeholder="Sara i Janek" maxlength="40">
 <span class="spotify-char-counter" id="spotifyArtistCounter">0/40</span>
 </div>
 </div>
 </div>
 {% endif %}

 <div id="spotify-type-size-slot" style="display: none;"></div>
 {% endif %}

 {% if product.handle == 'ramka-spotify' or product.handle == 'zdjecie-na-szkle-ramka-spotify' %}
 <div id="spotifyCropModal" class="spotify-crop-modal" aria-hidden="true">
 <div class="spotify-crop-dialog">
 <h4>Ustaw kadr zdjƒôcia</h4>
 <div class="spotify-crop-canvas">
 <img id="spotifyCropImage" alt="Kadrowanie zdjƒôcia">
 </div>
 <div class="spotify-crop-actions">
 <button type="button" class="customify-btn customify-btn-secondary" id="spotifyCropCancelBtn">Anuluj</button>
 <button type="button" class="customify-btn customify-btn-primary" id="spotifyCropConfirmBtn">Zapisz kadr</button>
 </div>
 </div>
 </div>
 {% endif %}

 {% if product.handle == 'personalizowane-etui-na-telefon-z-twoim-zdjeciem-karykatura' %}
 <div id="phoneCropModal" class="phone-crop-modal" aria-hidden="true">
 <div class="phone-crop-dialog">
 <h4>Ustaw kadr zdjƒôcia</h4>
 <div class="phone-crop-canvas">
 <img id="phoneCropImage" alt="Kadrowanie zdjƒôcia">
 </div>
 <div class="phone-crop-actions">
 <button type="button" class="customify-btn customify-btn-secondary" id="phoneCropCancelBtn">Anuluj</button>
 <button type="button" class="customify-btn customify-btn-primary" id="phoneCropConfirmBtn">Zapisz kadr</button>
 </div>
 </div>
 </div>
 {% endif %}
 
 {% if product.handle == 'personalizowane-etui-na-telefon-z-twoim-zdjeciem' %}
 <div id="phonePhotoCropModal" class="phone-photo-crop-modal" aria-hidden="true">
 <div class="phone-photo-crop-dialog">
 <h4>Ustaw kadr zdjƒôcia</h4>
 <div class="phone-photo-crop-canvas">
 <img id="phonePhotoCropImage" alt="Kadrowanie zdjƒôcia">
 <div id="phonePhotoCropWatermark" class="phone-photo-crop-watermark" style="display: none;"></div>
 </div>
 <div class="phone-photo-crop-actions">
 <button type="button" class="customify-btn customify-btn-secondary" id="phonePhotoCropCancelBtn">Anuluj</button>
 <button type="button" class="customify-btn customify-btn-primary" id="phonePhotoCropConfirmBtn">Zapisz kadr</button>
 </div>
 </div>
 </div>
 {% endif %}

 <div class="customify-styles" id="stylesArea" style="{% if product.handle == 'zdjecie-na-szkle-ramka-spotify' %}display: none;{% else %}display: block;{% endif %}">
 <h4>{% if product.handle == 'ramka-spotify' %}Popraw Obrazek{% else %}Wybierz styl{% endif %}</h4>
 <div class="customify-style-grid">
 {% comment %} LOGIKA SERVER-SIDE: Filtruj style per produkt {% endcomment %}
 {% comment %} DEBUG: Product handle = {{ product.handle }}, ID = {{ product.id }} {% endcomment %}
 {% if product.handle == 'karykatura-z-twojego-zdjecia-obraz' %}
 {% comment %} TYLKO STYLE KARYKATURY dla produktu karykatura - u≈ºywa Segmind API {% endcomment %} 
 <div class="customify-style-card" data-style="karykatura">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/karykat/caricature.png'); background-size: cover; background-position: center;"></div> 
 <div class="style-info">
 <div class="style-name">Karykatura</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="caricature-new" style="display: block !important;">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/karykat/karykat_nowoczesna.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Nowoczesna</div>
 </div>
 </div>
 {% elsif product.handle == 'karykatura-prezent-na-rocznice-prezent-ze-zdjecia' or product.handle == 'portret-pary-personalizowany-obraz-na-szkle-akrylowym' %}
 {% comment %} TYLKO STYLE KARYKATURY dla produktu karykatura-prezent - u≈ºywa Segmind API {% endcomment %} 
 <div class="customify-style-card" data-style="karykatura">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/karykat/caricature_2.png'); background-size: cover; background-position: center;"></div> 
 <div class="style-info">
 <div class="style-name">Karykatura</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="caricature-new" style="display: block !important;">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/karykat/nowoczesna_2.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Nowoczesna</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="karykatura-olowek" style="display: block !important;">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/karykat/olowek.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Szkic o≈Ç√≥wkiem</div>
 </div>
 </div>
 {% elsif product.handle == 'karykatura-na-zamowienie-druk-na-szkle-akrylowym-ramka-z-podswietleniem' %}
 {% comment %} TYLKO STYLE KARYKATURY dla produktu karykatura-na-zamowienie - u≈ºywa Segmind API {% endcomment %}
 <div class="customify-style-card" data-style="karykatura">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/karykat/caricature.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Karykatura</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="caricature-new" style="display: block !important;">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/karykat/karykat_nowoczesna.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Nowoczesna</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="karykatura-olowek" style="display: block !important;">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/karykat/olowek.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Szkic o≈Ç√≥wkiem</div>
 </div>
 </div>
  {% elsif product.handle == 'obraz-w-stylu-pop-art-z-twojego-zdjecia-personalizowany-na-prezent' %}
    {% comment %} STYL POP ART dla produktu {% endcomment %}
    <div class="customify-style-card" data-style="pop-art" style="display: block !important;">
      <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/style/pop_art.jpg'); background-size: cover; background-position: center;"></div>
      <div class="style-info">
        <div class="style-name">Pop Art</div>
      </div>
    </div>
  {% elsif product.handle == 'personalizowany-obraz-3d-cartoon-ilustracja-z-twojego-zdjecia' %}
    {% comment %} STYL 3D CARTOON dla produktu {% endcomment %}
    <div class="customify-style-card" data-style="3d-cartoon" style="display: block !important;">
      <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/style/3d_cartoon.jpg'); background-size: cover; background-position: center;"></div>
      <div class="style-info">
        <div class="style-name">3D Cartoon</div>
      </div>
    </div>
  {% elsif product.handle == 'portret-z-efektem-farb-olejnych-z-twojego-zdjecia-na-prezent' %}
    {% comment %} STYL FARBY OLEJNE dla produktu {% endcomment %}
    <div class="customify-style-card" data-style="oil-paints" style="display: block !important;">
      <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/style/olej_1.jpg'); background-size: cover; background-position: center;"></div>
      <div class="style-info">
        <div class="style-name">Farby Olejne</div>
      </div>
    </div>
  {% elsif product.handle == 'obraz-olejny-portret-na-plotnie-z-twojego-zdjecia' %}
    {% comment %} STYL OBRAZ OLEJNY dla produktu {% endcomment %}
    <div class="customify-style-card" data-style="oil-painting" style="display: block !important;">
      <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/style/olejny.png'); background-size: cover; background-position: center;"></div>
      <div class="style-info">
        <div class="style-name">Obraz Olejny</div>
      </div>
    </div>
  {% elsif product.handle == 'plakat-ze-zdjecia-w-stylu-komiks' %}
 {% comment %} TEST: Styl karykatury szkic o≈Ç√≥wkiem tylko dla produktu komiks {% endcomment %}
 <div class="customify-style-card" data-style="karykatura-olowek" style="display: block !important;">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/karykat/olowek.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Szkic o≈Ç√≥wkiem</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="watercolor_ok" style="display: block !important;">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/akwarela/watercolor_ok.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Watercolor OK</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="swieta" style="display: block !important;">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/swieta/banka_ok.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Banka</div>
 </div>
 </div>
 {% elsif product.handle == 'personalizowany-portret-w-stylu-boho' %}
 {% comment %} NOWE STYLE BOHO dla produktu boho {% endcomment %}
 <div class="customify-style-card" data-style="minimalistyczny">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/boho/minimal.png'); background-size: cover; background-position: center;"></div>
 <div class="style-name">Minimalistyczny</div>
 </div>
 
 <div class="customify-style-card" data-style="realistyczny">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/boho/detail.png'); background-size: cover; background-position: center;"></div>
 <div class="style-name">Realistyczny</div>
 </div>
 {% elsif product.handle == 'portret-krola-polski-obraz-na-plotnie-z-twojego-zdjecia' %}
 {% comment %} STYLE KR√ìL POLSKI dla produktu portret-krola-polski {% endcomment %}
 <div class="customify-style-card" data-style="krol-polski">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/krol/krol-styl-5.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Kr√≥l Polski</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="krol-polski-krolewski">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/krol/krol-styl-7.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Kr√≥lewski</div>
 </div>
 </div>
 {% elsif product.handle == 'krol-portret-personalizowany' %}
 {% comment %} TYLKO STYLE KR√ìLA dla produktu kr√≥l {% endcomment %}
 <div class="customify-style-card" data-style="krol-krolewski">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/krol/krol-styl-1.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Kr√≥l Kr√≥lewski</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="krol-majestatyczny">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/krol/krol-styl-2.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Kr√≥l Majestatyczny</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="krol-triumfalny">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/krol/krol-styl-3.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Kr√≥l Triumfalny</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="krol-imponujacy">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/krol/krol_4.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Kr√≥l ImponujƒÖcy</div>
 </div>
 </div>
 {% elsif product.id == 15389095297349 or product.handle == 'krolowa' or product.handle contains 'krolowa' %}
 {% comment %} TYLKO STYLE KR√ìLOWEJ dla produktu kr√≥lowa {% endcomment %}
 <div class="customify-style-card" data-style="krolowa-styl-1">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/krolowa/krolowa-styl-1.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Kr√≥lowa - Styl 1</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="krolowa-styl-2">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/krolowa/krolowa-styl-2.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Kr√≥lowa - Styl 2</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="krolowa-styl-3">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/krolowa/krolowa-styl-3.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Kr√≥lowa - Styl 3</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="krolowa-styl-4">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/krolowa/krolowa_sitting.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Kr√≥lowa - Sitting</div>
 </div>
 </div>
 {% elsif product.handle contains 'superbohater' and product.handle != 'portret-superbohater-obraz-na-plotnie-z-twojego-zdjecia-superman' %}
 {% comment %} TYLKO STYL SUPERBOHATER dla produktu superbohater {% endcomment %}
 <div class="customify-style-card" data-style="superhero_kid">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/superbohater/superhero_ok_1.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Superbohater</div>
 </div>
 </div>
 {% elsif product.handle == 'portret-dziecka-w-stroju-jednorozca-obraz-ze-zdjecia-dla-dziewczynki' %}
 {% comment %} STYL JEDNORO≈ªCA dla produktu jednoro≈ºec {% endcomment %}
 <div class="customify-style-card" data-style="jednorozec">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/jednoroz/jednorozec.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Jednoro≈ºec</div>
 </div>
 </div>
 {% elsif product.handle == 'portret-dziecka-w-stroju-misia-uroczy-obraz-z-twojego-zdjecia' %}
 {% comment %} STYL MISIA dla produktu mi≈õ {% endcomment %}
 <div class="customify-style-card" data-style="mis">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/dziecko/dziecko_mis.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Mi≈õ</div>
 </div>
 </div>
{% elsif product.handle == 'portret-w-stylu-hip-hop-obraz-na-plotnie-z-twojego-zdjecia' or product.handle == 'portret-ze-zdjecia-hip-hop-personalizowany-obraz-na-plotnie' %}
{% comment %} STYL HIP-HOP dla produktu hip-hop {% endcomment %}
<div class="customify-style-card" data-style="hiphop">
<div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/style/hiphop.jpg'); background-size: cover; background-position: center;"></div>
<div class="style-info">
<div class="style-name">Hip-Hop</div>
</div>
</div>
 {% elsif product.handle == 'portret-ze-zdjecia-dla-dziewczynki-zimowa-ksiezniczka-obraz' %}
 {% comment %} STYL ZIMOWA KSIƒò≈ªNICZKA dla produktu zimowa ksiƒô≈ºniczka {% endcomment %}
 <div class="customify-style-card" data-style="zimowa-ksiezniczka">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/dziecko/zimowa.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Zimowa Ksiƒô≈ºniczka</div>
 </div>
 </div>
 {% elsif product.handle == 'obraz-ze-zdjecia-krolowa-sniegu-na-tronie-portret-r' %}
 {% comment %} STYL KR√ìLOWA ≈öNIEGU dla produktu kr√≥lowa ≈õniegu {% endcomment %}
 <div class="customify-style-card" data-style="krolowa-sniegu">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/krolowa/krolowa_sniegu.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Kr√≥lowa ≈öniegu</div>
 </div>
 </div>
 {% elsif product.handle == 'portret-z-twojego-zdjecia-neon-lights-dla-dziewczyny-prezent' %}
 {% comment %} STYL NEO dla produktu neon lights {% endcomment %}
 <div class="customify-style-card" data-style="neo">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/kobieta/neon.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Neo</div>
 </div>
 </div>
 {% elsif product.handle == 'personalizowany-obraz-z-twojego-zdjecia-dla-mezczyzny-w-stylu-western-wanted' %}
 {% comment %} STYL WANTED dla produktu western wanted {% endcomment %}
 <div class="customify-style-card" data-style="wanted">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/wanted/wanted_1.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Wanted_Man</div>
 </div>
 </div>
 {% elsif product.handle == 'obraz-ze-zdjecia-dla-kobiety-w-stylu-western-wanted-poszukiwana' %}
 {% comment %} STYL WANTED_K dla produktu western wanted (kobieta) {% endcomment %}
 <div class="customify-style-card" data-style="wanted_k">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/wanted/wanted_2.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Wanted_K</div>
 </div>
 </div>
 {% elsif product.handle == 'portret-superbohater-obraz-na-plotnie-z-twojego-zdjecia-superman' %}
 {% comment %} STYL SUPERMAN dla produktu superman {% endcomment %}
 <div class="customify-style-card" data-style="superman">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/superhero/superman.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">superman</div>
 </div>
 </div>
 {% elsif product.handle == 'koty-krolewskie-zwierzeta-w-koronach' %}
 {% comment %} TYLKO STYLE KOT√ìW dla produktu kot√≥w {% endcomment %}
 <div class="customify-style-card" data-style="krolewski">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/koty/krolewski.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Kr√≥lewski Kot</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="na-tronie">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/koty/na_tronie.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Kot na Tronie</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="wojenny">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/koty/wojenny.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Wojenny Kot</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="wiktorianski">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/koty/wiktorianski.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Wiktoria≈Ñski Kot</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="renesansowy">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/koty/renesansowy.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Renesansowy Kot</div>
 </div>
 </div>
 {% elsif product.id == 15306975215941 %}
 {% comment %} TYLKO STYL PIXAR dla produktu zabawne-style (ID: 15306975215941) {% endcomment %}
 <div class="customify-style-card" data-style="pixar">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/pixar/pixar-styl.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Pixar</div>
 </div>
 </div>
 {% elsif product.handle == 'obraz-ze-zdjecia-swiateczny-nastroj' %}
 {% comment %} TYLKO STYL ≈öWIƒÑTECZNY (swieta) dla produktu ≈öwiƒÖteczny Nastr√≥j {% endcomment %}
 <div class="customify-style-card" data-style="swieta" style="display: block !important;">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/swieta/banka_ok.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Banka</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="swieta_2" style="display: block !important;">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/swieta/swieta_1.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">≈öwiƒôta</div>
 </div>
 </div>
 {% elsif product.handle == 'portret-pary-w-stylu-anime-obraz-ze-zdjecia' %}
 {% comment %} TYLKO STYL ANIME dla produktu anime {% endcomment %}
 <div class="customify-style-card" data-style="anime">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/para/anime.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Anime</div>
 </div>
 </div>
 {% elsif product.handle == 'ramka-spotify' or product.handle == 'zdjecie-na-szkle-ramka-spotify' %}
 {% comment %} STYLE SPOTIFY FRAME {% endcomment %}
 <div class="customify-style-card" data-style="bez-zmian">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/ok.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Bez zmian</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="usun-tlo">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/para/background.jpeg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Usu≈Ñ t≈Ço</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="anime">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/para/anime.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Anime</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="sketch">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/para/sketch.jpeg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Sketch</div>
 </div>
 </div>
 {% elsif product.handle == 'obraz-ze-zdjecia-akwarela' %}
 {% comment %} STYLOWANIE WATERCOLOUR OK - BEZ DODATKOWYCH WARUNK√ìW {% endcomment %}
 <div class="customify-style-card" data-style="watercolor_ok" style="display: block !important;">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/akwarela/watercolor_ok.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Watercolor</div>
 </div>
 </div>
 <script>
 // Fallback: upewnij siƒô, ≈ºe oba style sƒÖ widoczne na akwarela
 document.addEventListener('DOMContentLoaded', function() {
 if (window.location.pathname.includes('obraz-ze-zdjecia-akwarela')) {
 ['watercolor_ok'].forEach(function(style) {
 const el = document.querySelector('.customify-style-card[data-style="' + style + '"]');
 if (el) { el.style.display = 'block'; el.style.setProperty('display', 'block', 'important'); }
 });
 }
 });
 </script>
 {% elsif product.id == 15475649675589 or product.handle contains 'akwarela' %}
 {% comment %} TYLKO STYL AKWARELE dla produktu akwarela - u≈ºywa Segmind Become-Image API {% endcomment %}
 <div class="customify-style-card" data-style="akwarela">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/akwarela/watercolor-style.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Akwarela</div>
 </div>
 </div>
 {% elsif product.id == 15548464693573 or product.handle == 'dziadkowie-krolowie-nadruk-na-szkle' %}
 {% comment %} STYLE ZAMKOWY I KR√ìLEWSKI dla produktu (ID: 15548464693573) {% endcomment %}
 <div class="customify-style-card" data-style="zamkowy">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/zamkowy/zamkowy-styl.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Zamkowy</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="krolewski-para">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/krolewski/krolewski-styl.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Kr√≥lewski</div>
 </div>
 </div>
 {% elsif product.handle == 'test-karikat' or product.handle contains 'test-karikat' %}
 {% comment %} TYLKO STYL OPENAI ART dla produktu test-karikat - u≈ºywa OpenAI GPT-Image-1 API {% endcomment %}
 {% comment %} DEBUG: Warunek spe≈Çniony! Handle = {{ product.handle }} {% endcomment %}
 <div class="customify-style-card" data-style="openai-art" style="display: block !important;">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/openai/openai-art-style.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">AI Art</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="caricature-new" style="display: block !important;">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/karykat/karykat_nowoczesna.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Caricature New</div>
 </div>
 </div>
 {% comment %} DEBUG: Koniec sekcji test-karikat {% endcomment %}
 {% elsif product.handle == 'portret-w-stylu-gta-obraz-na-plotnie-z-twojego-zdjecia-super-prezent' %}
 {% comment %} STYLE GTA dla produktu GTA {% endcomment %}
 <div class="customify-style-card" data-style="gta">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/style/GTA.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">GTA</div>
 </div>
 </div>
 {% elsif product.handle == 'prezent-dla-babci-i-dziadka-portret-na-na-szkle-akrylowym-ze-zdjecia-karykatura' %}
 {% comment %} STYLE KARYKATURY dla produktu Prezent dla Babci i Dziadka {% endcomment %}
 <div class="customify-style-card" data-style="karykatura">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/karykat/dziadki_2.jpeg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Klasyczna</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="caricature-new" style="display: block !important;">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/karykat/dziadkowie.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Nowoczesna</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="karykatura-olowek" style="display: block !important;">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/karykat/olowek.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Szkic</div>
 </div>
 </div>
 {% elsif product.handle == 'portret-zakochana-para-krolewska-prezent-na-walentynki-personalizowany' %}
 {% comment %} STYL ROYAL LOVE dla produktu Portret Zakochana Para Kr√≥lewska - OpenAI GPT Image 1.5 via Replicate {% endcomment %}
 <div class="customify-style-card" data-style="royal-love">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/style/royal_love.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Royal Love</div>
 </div>
 </div>
 {% elsif product.handle == 'obraz-na-plotnie-szalona-milosc-prezent-na-walentynki-z-twojego-zdjecia' %}
 {% comment %} STYL CRAZY LOVE dla produktu Szalona Mi≈Ço≈õƒá - OpenAI GPT Image 1.5 via Replicate {% endcomment %}
 <div class="customify-style-card" data-style="crazy-love">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/style/crazy_l.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Crazy Love</div>
 </div>
 </div>
 {% elsif product.handle == 'prezent-na-walentynki-obraz-na-plotnie-z-twojego-zdjecia' %}
 {% comment %} STYL LOVE ROSE dla produktu Prezent na Walentynki - OpenAI GPT Image 1.5 via Replicate {% endcomment %}
 <div class="customify-style-card" data-style="love-rose">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/style/love_rose.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Love Rose</div>
 </div>
 </div>
 {% elsif product.handle == 'prezent-na-walentynki-portret-rysunkowa-para-personalizowany-ze-zdjecia' %}
 {% comment %} STYL SZKIC LOVE dla produktu Prezent na Walentynki Portret Rysunkowa Para - OpenAI GPT Image 1.5 via Replicate {% endcomment %}
 <div class="customify-style-card" data-style="szkic-love">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/style/szkic_love.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Szkic Love</div>
 </div>
 </div>
 {% elsif product.handle == 'portret-para-przy-drzewie-prezent-na-walentynki-romantyczny-obraz-na-plotnie-z-twojego-zdjecia' %}
 {% comment %} STYL JAK Z BAJKI dla produktu Portret Para przy Drzewie - OpenAI GPT Image 1.5 via Replicate {% endcomment %}
 <div class="customify-style-card" data-style="jak-z-bajki">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/style/jak_bajka.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Jak z bajki</div>
 </div>
 </div>
 {% elsif product.handle == 'prezent-na-walentynki-superpara-obraz-na-plotnie-z-twojego-zdjecia' %}
 {% comment %} STYL SUPERPARA dla produktu Prezent na Walentynki Superpara - OpenAI GPT Image 1.5 via Replicate {% endcomment %}
 <div class="customify-style-card" data-style="superpara">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/style/superpara.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Superpara</div>
 </div>
 </div>
 {% else %}
 {% comment %} WSZYSTKIE STYLE NORMALNE dla innych produkt√≥w {% endcomment %}
 <div class="customify-style-card" data-style="watercolor">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/Screenshot%202025-09-29%20at%2022.17.14.png'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Akwarela</div>
 </div>
 </div>
 <div class="customify-style-card" data-style="pixar">
 <div class="style-image" style="background-image: url('https://customify-s56o.vercel.app/pixar/pixar-styl.jpg'); background-size: cover; background-position: center;"></div>
 <div class="style-info">
 <div class="style-name">Pixar</div>
 </div>
 </div>
 {% endif %}
 </div>
 </div>

 {% if product.handle == 'ramka-spotify' or product.handle == 'zdjecie-na-szkle-ramka-spotify' %}
 <div id="spotifyFieldsPanel" class="customify-spotify-panel" style="display: none; margin: 12px 0 8px 0;">
 <h4 style="margin-bottom: 6px;">Tekst na ramce</h4>
 <div style="display: grid; gap: 8px;">
 <label for="spotifyTitle" style="font-size: 0.9rem;">Tytu≈Ç utworu</label>
 <input type="text" id="spotifyTitle" maxlength="60" placeholder="np. Only you" style="padding: 10px 12px; border: 1px solid #d1d5db; border-radius: 8px;">
 <label for="spotifyArtist" style="font-size: 0.9rem;">Artysta</label>
 <input type="text" id="spotifyArtist" maxlength="60" placeholder="np. Wiktoria i Oskar" style="padding: 10px 12px; border: 1px solid #d1d5db; border-radius: 8px;">
 </div>
 </div>
 {% endif %}

 <div class="customify-error" id="errorMessageTransform" style="display: none;"></div>
 
 <div class="customify-actions" id="actionsArea" style="display: none;">
 <button class="customify-btn customify-btn-red" id="transformBtn">
 Zobacz PodglƒÖd
 </button>
 <button class="customify-btn customify-btn-secondary" id="resetBtn" style="display: none;">
 Wgraj inne zdjƒôcie
 </button>
 <button class="customify-btn customify-btn-primary" id="addToCartBtnMain" style="display: none;">
 Dodaj do koszyka
 </button>
 </div>

 {% if product.handle == 'personalizowane-etui-na-telefon-z-twoim-zdjeciem' %}{% render 'phone-case-cart' %}{% endif %}

<div class="customify-loading" id="loadingArea">
 
 <div class="arrow-down">
 <span>‚Üì ‚Üì ‚Üì</span>
 </div>
 <div class="customify-spinner"></div>
 <div class="loading-text">Generowanie mo≈ºe potrwaƒá nawet 2 minuty - zaczekaj</div>
 <div class="loading-progress">
 <div class="loading-progress-bar" id="progressBar"></div>
 </div>
 <div class="loading-stage" id="loadingStage">Przesy≈Çanie zdjƒôcia...</div>
 </div>

 <div class="customify-result" id="resultArea">
 <h4>Tw√≥j obraz:</h4>
 {% if product.handle == 'ramka-spotify' or product.handle == 'zdjecie-na-szkle-ramka-spotify' %}
 <div class="spotify-frame-result">
 <div class="spotify-frame-inner">
 <img id="resultImage" alt="Wynik AI">
 
 <div class="spotify-text-overlay">
 <div class="spotify-text-title" id="spotifyTextTitle"></div>
 <div class="spotify-text-artist" id="spotifyTextArtist"></div>
 </div>
 </div>
 </div>
 
 {% elsif product.handle == 'personalizowane-etui-na-telefon-z-twoim-zdjeciem' %}
 <div class="phone-case-preview">
 <div class="phone-case-inner">
 <div class="phone-case-photo-bg" id="phoneCaseResultBg"></div>
 <img class="phone-case-overlay" src="https://customify-s56o.vercel.app/phone/phone_ok.png" alt="">
 <img id="resultImage" alt="Wynik AI" style="display: none;">
 </div>
 </div>
 {% else %}
 <img id="resultImage" alt="Wynik AI">
 {% endif %}
 <p style="font-size: 0.85rem; color: #666; text-align: center; margin: 8px 0 0 0; font-style: italic;">Znak√≥w wodnych nie bƒôdzie na ko≈Ñcowym produkcie</p>

 <div class="customify-success" id="successMessage"></div>
 
 <div class="customify-text-overlay-toggle customify-product-type-buttons" style="margin-top:12px; display:flex; justify-content:center;">
 <div class="customify-product-type-btn" id="textOverlayToggleBtn" data-overlay-open="false">
 Dodaƒá napis? Kliknij tutaj
 </div>
 </div>
 <div class="customify-text-overlay-panel" id="textOverlayPanel" style="display: none;">
 <div class="text-overlay-row">
 <div class="text-overlay-input-wrapper" style="border:1px solid #d1d5db; border-radius:8px; padding:8px 10px; background:#f5f5f5; box-shadow: 0 0 0 1px rgba(0,0,0,0.03);">
 <input class="text-overlay-input" type="text" id="textOverlayInput" maxlength="80" placeholder="Wpisz tekst" style="border:none; outline:none; background:transparent; width:100%; font-size:0.95rem; color:#111; box-sizing:border-box; min-height:26px;">
 </div>
 <span class="text-overlay-counter" id="textOverlayCounter" style="display:none;"></span>
 </div>
 <div class="text-overlay-group">
 <select class="text-overlay-select" id="textOverlayColorSelect" style="border:1px solid #d1d5db; border-radius:8px; padding:10px; font-size:0.95rem; width:100%; background:#fff; color:#111; box-sizing:border-box; min-height:42px;">
 <option value="" selected disabled>Kolor</option>
 <option value="white">Bia≈Çy</option>
 <option value="black">Czarny</option>
 <option value="gold">Z≈Çoty</option>
 <option value="brown">BrƒÖzowy</option>
 <option value="red">Czerwony</option>
 <option value="green">Zielony</option>
 <option value="blue">Niebieski</option>
 <option value="yellow">≈ª√≥≈Çty</option>
 <option value="white-banner">Bia≈Çy na tle</option>
 <option value="black-banner">Czarny na tle</option>
 <option value="gold-banner">Z≈Çoty na tle</option>
 <option value="brown-banner">BrƒÖzowy na tle</option>
 <option value="red-banner">Czerwony na tle</option>
 <option value="green-banner">Zielony na tle</option>
 <option value="blue-banner">Niebieski na tle</option>
 <option value="yellow-banner">≈ª√≥≈Çty na tle</option>
 </select>
 </div>
 <div class="text-overlay-group">
 <select class="text-overlay-select" id="textOverlayFontSelect" style="border:1px solid #d1d5db; border-radius:8px; padding:10px; font-size:0.95rem; width:100%; background:#fff; color:#111; box-sizing:border-box; min-height:42px;">
 <option value="" selected disabled>Czcionka</option>
 <option value="serif">Elegancka</option>
 <option value="sans">Klasyczna</option>
 <option value="script">Pisana</option>
 <option value="script2">Pacifico</option>
 <option value="script3">Pisana 3</option>
 <option value="script4">Pisana 4</option>
 <option value="script5">Indie Flower</option>
 <option value="western_1">Westernowa 1 (Rye)</option>
 <option value="western_2">Westernowa 2 (Creepster)</option>
 <option value="hiphop">Graffiti (Rubik Wet Paint)</option>
 <option value="royale">Kr√≥lewska (Bonheur Royale)</option>
 </select>
 </div>
 <div class="text-overlay-group">
 <select class="text-overlay-select" id="textOverlaySizeSelect" style="border:1px solid #d1d5db; border-radius:8px; padding:10px; font-size:0.95rem; width:100%; background:#fff; color:#111; box-sizing:border-box; min-height:42px;">
 <option value="" selected disabled>Rozmiar</option>
 <option value="small">Ma≈Çy</option>
 <option value="medium">≈öredni</option>
 <option value="large">Du≈ºy</option>
 </select>
 </div>
 <div class="text-overlay-actions" style="display:flex; gap:10px; align-items:stretch;">
 <button class="customify-btn customify-btn-primary" id="textOverlaySaveBtn" type="button" style="flex:1 1 0; min-width:0; display:inline-flex; justify-content:center; align-items:center; width:auto; margin:0;">
 Zapisz
 </button>
 </div>
 <div class="text-overlay-hint" id="textOverlayHint" style="display: none;"></div>
 </div>

 <div id="type-size-inline-slot"></div>

 <div class="customify-cart-price" id="cartPriceDisplay" style="display: none; margin: 15px 0; text-align: center; padding: 10px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
 <span class="cart-price-label" style="font-weight: 600; color: #333; margin-right: 12px;">Cena:</span>
 <span class="cart-price-value" id="cartPriceValue" style="font-size: 1.2rem; font-weight: 700; color: #e55a2b;">0.00 z≈Ç</span>
 </div>

 <div class="customify-error" id="errorMessageBottom" style="display: none;"></div>
 
 <div class="customify-actions" style="margin-top: 15px;">
 <button class="customify-btn customify-btn-primary customify-btn-red" id="addToCartBtn">
 Dodaj do koszyka
 </button>
 <button class="customify-btn customify-btn-secondary" id="tryAgainBtn">
 Spr√≥buj ponownie
 </button>
 </div>

 <div class="customify-cart-loading" id="cartLoadingArea" style="display: none;">
 <div class="customify-spinner"></div>
 <div class="loading-text">Dodawanie do koszyka...</div>
 <div class="loading-progress">
 <div class="loading-progress-bar" id="cartProgressBar"></div>
 </div>
 <div class="loading-stage" id="cartLoadingStage">Tworzenie produktu...</div>
 </div>
 </div>

 <div class="product-details-accordion">

 <div class="accordion-item" data-accordion="details">
 <div class="accordion-header">
 <div class="accordion-title">
 <span>O produkcie</span>
 </div>
 <span class="accordion-icon">+</span>
 </div>
 <div class="accordion-content">
 <p><strong>Obraz na p≈Ç√≥tnie</strong> - wydrukowane na grubym, premium p≈Ç√≥tnie canvas z naturalnƒÖ teksturƒÖ. NaciƒÖgniƒôte na drewnianƒÖ antyramƒô</p>

 <div class="accordion-product-visual">
 <div class="accordion-visual-item">
 <img src="https://customify-s56o.vercel.app/faq/obraz.png" alt="Obraz na p≈Ç√≥tnie" class="accordion-visual-image">
 </div>
 </div>
 
 <br>
 <p><strong>Plakat</strong> - wydruk na papierze fotograficznym, kt√≥ry wysy≈Çamy zwiniƒôty w eleganckiej tubie. Mo≈ºesz wybraƒá ramkƒô. W√≥wczas wydruk bƒôdzie w ramce za szk≈Çem.</p>

 <div class="accordion-product-visual">
 <div class="accordion-visual-item">
 <img src="https://customify-s56o.vercel.app/faq/plakat.png" alt="Plakat" class="accordion-visual-image">
 </div>
 </div>
 
 <br>
 <p><strong>Nadruk na szkle akrylowym</strong> - personalizowany wydruk na szkle akrylowym (bezpieczne niet≈ÇukƒÖce siƒô). Dodaj podstawkƒô, by postawiƒá go na biurku, mo≈ºesz dodaƒá podstawkƒô z LED, kt√≥ra pod≈õwietla zdjƒôcie i zamienia je w nastrojowƒÖ lampkƒô nocnƒÖ lub dekoracjƒô pokoju.</p>
 <p>Dostƒôpna jest w 2 rozmiarach: <strong>A5</strong> - najpopularniejszym i wiƒôkszym <strong>A4</strong>.</p>
 
 <div class="accordion-product-visual" style="margin: 15px 0;">
 <div class="accordion-visual-item">
 <img src="https://customify-s56o.vercel.app/ramki_wymiary.webp" alt="Rozmiary ramek na szkle" class="accordion-visual-image">
 </div>
 </div>
 <p>Przezroczysta pleksi nadaje zdjƒôciu elegancki po≈Çysk i g≈Çƒôbiƒô, dziƒôki czemu wyglƒÖda jak obraz za szk≈Çem. Produkt jest gotowy do wrƒôczenia jako prezent ‚Äî piƒôkny, nowoczesny i w pe≈Çni personalizowany.</p>

 <div class="accordion-product-visual">
 <div class="accordion-visual-item">
 <img src="https://customify-s56o.vercel.app/akryl/akryl.png" alt="Nadruk na szkle akrylowym" class="accordion-visual-image">
 </div>
 <div class="accordion-visual-item">
 <img src="https://customify-s56o.vercel.app/akryl/akryl_2.png" alt="Nadruk na szkle akrylowym z LED" class="accordion-visual-image">
 </div>
 </div>
 
 <br>
 <p><strong>Produkt cyfrowy</strong> ‚Äì plik w wysokiej jako≈õci, bez znak√≥w wodnych, do natychmiastowego pobrania (bez wysy≈Çki fizycznego obrazu).</p>
 
 <ul>
 <li>Otrzymujesz plik w wysokiej rozdzielczo≈õci, bez znak√≥w wodnych.</li>
 <li>Link do pobrania wysy≈Çamy natychmiast po op≈Çaceniu zam√≥wienia ‚Äì zero czekania na kuriera.</li>
 <li>Idealny do druku w domu lub fotolabie, jako tapeta na telefon/komputer albo do udostƒôpniania w social mediach.</li>
 </ul>
 
 <p><strong>To jest produkt cyfrowy ‚Äì nie wysy≈Çamy fizycznego obrazu.</strong></p>

 <div class="accordion-product-visual">
 <div class="accordion-visual-item">
 <img src="https://customify-s56o.vercel.app/icon_digital.png" alt="Produkt cyfrowy" class="accordion-visual-image">
 </div>
 </div>
 </div>
 </div>

 <div class="accordion-item" data-accordion="shipping">
 <div class="accordion-header">
 <div class="accordion-title">
 <span>Wysy≈Çka i dostawa</span>
 </div>
 <span class="accordion-icon">+</span>
 </div>
 <div class="accordion-content">
 <ul>
 <li><strong>‚ö° Szybka realizacja:</strong> natychmiast po zleceniu projektu</li>
 <li><strong>üì¶ Bezpieczne opakowanie:</strong> Karton wzmocniony + folia bƒÖbelkowa - gwarancja bezpiecznej dostawy</li>
 <li><strong>üáµüá± Wysy≈Çka:</strong> InPost Paczkomaty, InPost Kurier</li>
 <li><strong>üìç ≈öledzenie przesy≈Çki:</strong> Numer trackingowy wysy≈Çany mailem - zawsze wiesz gdzie jest Twoja przesy≈Çka</li>
 <li><strong>üöö Darmowa dostawa:</strong> Przy zam√≥wieniach powy≈ºej 400 z≈Ç</li>
 <li><strong>‚è∞ Czas dostawy:</strong> 1-3 dni robocze (w zale≈ºno≈õci od wybranej opcji)</li>
 </ul>
 </div>
 </div>

 <div class="accordion-item" data-accordion="sizes">
 <div class="accordion-header">
 <div class="accordion-title">
 <span>Dostƒôpne rozmiary</span>
 </div>
 <span class="accordion-icon">+</span>
 </div>
 <div class="accordion-content">
 
 <h4 style="margin: 0 0 15px 0; font-size: 1.1rem; color: #111; border-bottom: 2px solid #1DB954; padding-bottom: 8px;">üñºÔ∏è Plakat / Obraz na p≈Ç√≥tnie</h4>

 <div class="accordion-product-visual">
 <div class="accordion-visual-item">
 <img src="https://customify-s56o.vercel.app/faq/wymiary.png" alt="Dostƒôpne rozmiary" class="accordion-visual-image">
 <div class="accordion-visual-label">üìè Dostƒôpne rozmiary</div>
 </div>
 </div>
 
 <div class="accordion-size-grid">
 <div class="accordion-size-item">
 <div class="accordion-size-name">20 √ó 30 cm</div>
 <div class="accordion-size-description">≈öwietny do ma≈Çych pokoi</div>
 </div>
 <div class="accordion-size-item">
 <div class="accordion-size-name">30 √ó 45 cm</div>
 <div class="accordion-size-description">Doskona≈Çy do ≈õrednich pomieszcze≈Ñ</div>
 </div>
 <div class="accordion-size-item">
 <div class="accordion-size-name">40 √ó 60 cm</div>
 <div class="accordion-size-description">Efektowny na du≈ºe ≈õciany w salonie</div>
 </div>
 <div class="accordion-size-item">
 <div class="accordion-size-name">50 √ó 75 cm</div>
 <div class="accordion-size-description">Idealny do du≈ºych przestrzeni</div>
 </div>
 <div class="accordion-size-item">
 <div class="accordion-size-name">60 √ó 90 cm</div>
 <div class="accordion-size-description">ImponujƒÖcy na ca≈ÇƒÖ ≈õcianƒô</div>
 </div>
 </div>

 <h4 style="margin: 30px 0 15px 0; font-size: 1.1rem; color: #111; border-bottom: 2px solid #1DB954; padding-bottom: 8px;">üî≤ Wydruk na szkle</h4>
 
 <div class="accordion-product-visual">
 <div class="accordion-visual-item">
 <img src="https://customify-s56o.vercel.app/ramki_wymiary.webp" alt="Rozmiary ramek na szkle" class="accordion-visual-image">
 <div class="accordion-visual-label">üìè Rozmiary ramek na szkle</div>
 </div>
 </div>
 
 <div class="accordion-size-grid" style="margin-top: 15px;">
 <div class="accordion-size-item">
 <div class="accordion-size-name">A5 (15 √ó 21 cm)</div>
 <div class="accordion-size-description">Najpopularniejszy rozmiar</div>
 </div>
 <div class="accordion-size-item">
 <div class="accordion-size-name">A4 (21 √ó 30 cm)</div>
 <div class="accordion-size-description">Wiƒôkszy, bardziej efektowny</div>
 </div>
 </div>
 </div>
 </div>

 <div class="accordion-item" data-accordion="howto">
 <div class="accordion-header">
 <div class="accordion-title">
 <span>Jak to dzia≈Ça?</span>
 </div>
 <span class="accordion-icon">+</span>
 </div>
 <div class="accordion-content">
 <div class="accordion-step">
 <div class="accordion-step-number">1</div>
 <div class="accordion-step-content">
 <strong>Wgraj swoje zdjƒôcie</strong><br>
 JPG, PNG lub GIF do 10MB. Najlepiej w wysokiej rozdzielczo≈õci.<br>
 <em style="color: #666; font-size: 0.9em;">Nie musisz siƒô martwiƒá o jako≈õƒá - sprawdzamy ka≈ºde zdjƒôcie przed wydrukiem i poprawiamy je, aby by≈Ço idealne!</em>
 </div>
 </div>
 <div class="accordion-step">
 <div class="accordion-step-number">2</div>
 <div class="accordion-step-content">
 <strong>Wybierz styl artystyczny</strong><br>
 Dostƒôpne style do wyboru w zak≈Çadce powy≈ºej.
 </div>
 </div>
 <div class="accordion-step">
 <div class="accordion-step-number">3</div>
 <div class="accordion-step-content">
 <strong>Wybierz rozmiar wydruku</strong><br>
 Wybierz idealny rozmiar dla Twojej przestrzeni.
 </div>
 </div>
 <div class="accordion-step">
 <div class="accordion-step-number">4</div>
 <div class="accordion-step-content">
 <strong>AI przekszta≈Çci Twoje zdjƒôcie</strong><br>
 Najnowocze≈õniejsza technologia sztucznej inteligencji w 30-60 sekund.
 </div>
 </div>
 <div class="accordion-step">
 <div class="accordion-step-number">5</div>
 <div class="accordion-step-content">
 <strong>Drukujemy i wysy≈Çamy</strong><br>
 Ka≈ºde zdjƒôcie jest sprawdzane i poprawiane przed wydrukiem. Wysokiej jako≈õci nadruk, bezpiecznie zapakowany.
 </div>
 </div>
 </div>
 </div>

 </div>

 </div>
 </div>
 </div>
 </div>
 
 <style>
 /* Kolor nag≈Ç√≥wka nad uploaderem */
 .customify-title {
 color: #dc3545 !important;
 }
 /* Wysuwane menu ramki */
 .frame-color-selector {
 margin-top: 8px;
 max-width: 450px;
 }
 .frame-toggle {
 width: 100%;
 display: flex;
 align-items: center;
 justify-content: space-between;
 gap: 8px;
 padding: 6px 10px;
 border: 1px solid #666666 !important;
 background: #ffffff;
 color: #333;
 font-size: 0.85rem;
 cursor: pointer;
 }
 .frame-caret { font-size: 0.8rem; color: #666; }
 .frame-options {
 border: 1px solid #e0e0e0;
 border-top: none;
 background: #fff;
 }
 .frame-option {
 padding: 6px 10px;
 cursor: pointer;
 font-size: 0.85rem;
 border-top: 1px solid #f2f2f2;
 }
 .frame-option:hover { background: #fff9db; }
 .frame-option[aria-selected="true"] {
 background: #fff7cc;
 color: #b7791f;
 }
 .frame-color-selector.disabled {
 opacity: 0.5;
 pointer-events: none;
 }
 
 /* üÜï Wysuwane menu podstawki (szk≈Ço) */
 .stand-selector {
 margin-top: 8px;
 max-width: 450px;
 }
 .stand-toggle {
 width: 100%;
 display: flex;
 align-items: center;
 justify-content: space-between;
 gap: 8px;
 padding: 6px 10px;
 border: 1px solid #666666 !important;
 background: #ffffff;
 color: #333;
 font-size: 0.85rem;
 cursor: pointer;
 }
 .stand-caret { font-size: 0.8rem; color: #666; }
 .stand-options {
 border: 1px solid #e0e0e0;
 border-top: none;
 background: #fff;
 }
 .stand-option {
 padding: 8px 10px;
 cursor: pointer;
 font-size: 0.85rem;
 border-top: 1px solid #f2f2f2;
 display: flex;
 align-items: center;
 gap: 10px;
 }
 .stand-option:hover { background: #e3f2fd; }
 .stand-option[aria-selected="true"] {
 background: #bbdefb;
 color: #1565c0;
 }
 .stand-option-image {
 width: 50px;
 height: 50px;
 object-fit: cover;
 border-radius: 4px;
 border: 1px solid #e0e0e0;
 }
 .stand-option-text {
 flex: 1;
 }
 .stand-selector.disabled {
 opacity: 0.5;
 pointer-events: none;
 }

{% if product.handle == 'personalizowane-etui-na-telefon-z-twoim-zdjeciem' %}
/* üì± Etui - ukryj Rodzaj wydruku i Rozmiar (TYLKO ten produkt) */
#customify-app-container .hide-for-phone-case{display:none!important}
/* üì± Etui na telefon - overlay podglƒÖdu (preview + result) */
#customify-app-container .phone-case-preview {
 width: 100% !important;
 max-width: 520px !important;
 min-width: 300px !important;
 margin: 0 auto;
 box-sizing: border-box;
 }
 #customify-app-container #previewArea {
 padding: 0;
 margin-top: 12px;
 border-top: none;
 background: transparent;
 display: flex;
 flex-direction: column;
 width: 100% !important;
 max-width: 520px !important;
 margin-left: auto;
 margin-right: auto;
 }
 #customify-app-container #previewArea h4 {
 margin: 0 0 10px 0;
 flex-shrink: 0;
 }
 #customify-app-container #previewArea .phone-case-preview {
 flex-shrink: 0;
 }
 #customify-app-container .phone-case-inner {
 position: relative !important;
 width: 100% !important;
 height: 0 !important;
 padding-top: 206.61896171744258% !important;
 overflow: hidden !important;
 }
 @supports (aspect-ratio: 1) {
 #customify-app-container .phone-case-inner {
 height: auto !important;
 padding-top: 0 !important;
 aspect-ratio: 559 / 1154 !important;
 }
 }
 #customify-app-container .phone-case-photo-bg {
 position: absolute !important;
 inset: 0 !important;
 width: 100% !important;
 height: 100% !important;
 background-repeat: no-repeat !important;
 background-position: center center !important;
 background-size: cover !important;
 z-index: 0 !important;
 }
 #customify-app-container .phone-case-overlay {
 position: absolute !important;
 inset: 0 !important;
 width: 100% !important;
 height: 100% !important;
 object-fit: contain !important;
 object-position: center !important;
 display: block !important;
 max-width: 100% !important;
 max-height: 100% !important;
 pointer-events: none !important;
 z-index: 1 !important;
 }
 #customify-app-container .phone-case-inner {
 overflow: hidden !important;
 }
 #customify-app-container .phone-case-preview {
 height: auto !important;
 }
 /* üì± Etui: ukryj previewArea gdy resultArea widoczny (jak ramka-spotify) */
 #customify-app-container #resultArea[style*="block"] ~ #previewArea,
 #customify-app-container:has(#resultArea[style*="block"]) #previewArea {
 display: none !important;
 }
 {% endif %}

 {% if product.handle == 'ramka-spotify' or product.handle == 'zdjecie-na-szkle-ramka-spotify' %}
 /* Spotify frame preview - tylko dla ramka-spotify */
 
 {% if product.handle == 'zdjecie-na-szkle-ramka-spotify' %}
 /* üéµ Ukryj galeriƒô AI dla produktu bez AI */
 #aiGallery {
 display: none !important;
 }
 {% endif %}
 
 /* üéØ Ukryj previewArea gdy resultArea jest widoczny (po generacji AI) */
 #customify-app-container #resultArea[style*="block"] ~ #previewArea,
 #customify-app-container:has(#resultArea[style*="block"]) #previewArea {
 display: none !important;
 }
 
 /* üéØ Ukryj successMessage i text-overlay-toggle dla ramka-spotify */
 #customify-app-container #successMessage,
 #customify-app-container #resultArea > div.customify-text-overlay-toggle,
 #customify-app-container #resultArea > div.customify-product-type-buttons {
 display: none !important;
 }
 
 /* üé® Panel filtr√≥w Spotify (glfx.js) */
 .spotify-filters-panel {
 margin-top: 20px;
 padding: 0;
 }
 .spotify-filters-grid {
 display: grid;
 grid-template-columns: repeat(4, 1fr);
 gap: 10px;
 margin-top: 12px;
 }
 .spotify-filter-btn {
 display: flex;
 flex-direction: column;
 align-items: center;
 padding: 8px;
 border: 2px solid #e0e0e0;
 border-radius: 10px;
 background: #fff;
 cursor: pointer;
 transition: all 0.2s ease;
 }
 .spotify-filter-btn:hover {
 border-color: #1DB954;
 transform: translateY(-2px);
 box-shadow: 0 4px 12px rgba(29, 185, 84, 0.15);
 }
 .spotify-filter-btn.active {
 border-color: #1DB954;
 background: #f0fdf4;
 }
 .spotify-filter-btn .filter-preview {
 width: 50px;
 height: 50px;
 border-radius: 8px;
 margin-bottom: 6px;
 }
 .spotify-filter-btn span {
 font-size: 0.75rem;
 font-weight: 500;
 color: #333;
 text-align: center;
 }
 @media (max-width: 480px) {
 .spotify-filters-grid {
 grid-template-columns: repeat(4, 1fr);
 gap: 8px;
 }
 .spotify-filter-btn .filter-preview {
 width: 40px;
 height: 40px;
 }
 .spotify-filter-btn span {
 font-size: 0.7rem;
 }
 }
 
 /* üéµ Slot dla element√≥w typu/rozmiaru/ceny/przycisk√≥w Spotify */
 #spotify-type-size-slot {
 display: flex;
 flex-direction: column;
 gap: 15px;
 margin-top: 20px;
 }
 #spotify-type-size-slot > * {
 order: 0; /* Domy≈õlna kolejno≈õƒá */
 }
 #spotify-type-size-slot > .customify-product-type-selector {
 order: 1; /* Rodzaj wydruku - pierwszy */
 }
 #spotify-type-size-slot > .customify-size-selector {
 order: 2; /* Rozmiar - drugi */
 }
 #spotify-type-size-slot > #cartPriceDisplay {
 order: 3; /* Cena - trzeci */
 }
 #spotify-type-size-slot > #spotify-cart-buttons {
 order: 4; /* Przycisk "Dodaj do koszyka" - ostatni */
 }
 
 /* üéµ Ukryj g≈Ç√≥wny przycisk "Dodaj do koszyka" dla produktu bez AI - u≈ºywamy tylko tego z slotu */
 {% if product.handle == 'zdjecie-na-szkle-ramka-spotify' %}
 #addToCartBtnMain {
 display: none !important;
 }
 {% endif %}
 
 /* üéµ Panel tekst√≥w Spotify */
 .spotify-text-panel {
 margin-top: 20px;
 padding: 0;
 }
 .spotify-text-field {
 margin-bottom: 16px;
 }
 .spotify-panel-title {
 font-size: 1.3rem;
 font-weight: 700;
 color: #111;
 margin: 0 0 16px 0;
 padding-bottom: 8px;
 border-bottom: 2px solid #1DB954;
 }
 .spotify-text-label {
 display: block;
 font-size: 0.9rem;
 font-weight: 600;
 color: #111;
 margin-bottom: 8px;
 }
 .spotify-text-label .required {
 color: #e53935;
 }
 .spotify-text-input {
 width: 100%;
 padding: 12px 14px;
 border: 1px solid #e0e0e0;
 border-radius: 8px;
 font-size: 0.95rem;
 color: #111;
 background: #fff;
 box-sizing: border-box;
 transition: border-color 0.2s;
 }
 .spotify-text-input-large {
 font-size: 1rem;
 padding: 12px 14px;
 }
 .spotify-text-input:focus {
 outline: none;
 border-color: #111;
 }
 .spotify-text-input::placeholder {
 color: #9e9e9e;
 }
 .spotify-input-wrapper {
 position: relative;
 display: flex;
 align-items: center;
 }
 .spotify-input-wrapper .spotify-text-input {
 padding-right: 60px;
 }
 .spotify-char-counter {
 position: absolute;
 right: 14px;
 font-size: 0.85rem;
 color: #9e9e9e;
 pointer-events: none;
 }
 
 /* Teksty na ramce Spotify - miƒôdzy zdjƒôciem a kontrolerami */
 .spotify-text-overlay {
 position: absolute;
 left: 61px;
 right: 61px;
 top: 1000px;
 text-align: left;
 pointer-events: none;
 z-index: 100;
 }
 .spotify-text-title {
 font-size: 72px;
 font-weight: 700;
 color: #ffffff;
 margin-bottom: 6px;
 word-wrap: break-word;
 line-height: 1.2;
 }
 .spotify-text-artist {
 font-size: 48px;
 font-weight: 400;
 color: #ffffff;
 word-wrap: break-word;
 line-height: 1.2;
 }

 #customify-app-container .spotify-frame-preview,
 #customify-app-container .spotify-frame-result,
 #customify-app-container #resultArea .spotify-frame-result {
 position: relative;
 width: 100%;
 max-width: 460px;
 margin: 0 auto;
 padding: 20px;
 box-sizing: border-box;
 overflow: visible;
 }
 @media (max-width: 768px) {
 #customify-app-container .spotify-frame-preview,
 #customify-app-container .spotify-frame-result,
 #customify-app-container #resultArea .spotify-frame-result {
 max-width: 100%;
 padding: 12px;
 }
 }
 #customify-app-container .spotify-frame-inner,
 #customify-app-container #resultArea .spotify-frame-inner {
 position: relative;
 width: 1024px;
 height: 1536px;
 transform-origin: top left;
 transform: scale(0.4);
 background: transparent;
 }
 /* T≈Ço za ramkƒÖ - zdjƒôcie mieszkania (tylko podglƒÖd, nie w pliku do druku) */
 #customify-app-container .spotify-frame-preview,
 #customify-app-container .spotify-frame-result {
 background: url('https://customify-s56o.vercel.app/spotify/tloo2.jpg') center/cover no-repeat;
 }
 #customify-app-container .spotify-frame-preview,
 #customify-app-container .spotify-frame-result {
 height: 634px;
 }
 #customify-app-container .spotify-frame-inner::before {
 content: '';
 position: absolute;
 inset: 0;
 border: none;
 box-sizing: border-box;
 pointer-events: none;
 }
 #customify-app-container .spotify-frame-inner::after {
 content: '';
 position: absolute;
 inset: 0;
 background: url('https://customify-s56o.vercel.app/spotify/biale_male.png') center/contain no-repeat;
 pointer-events: none;
 }
 #customify-app-container .spotify-frame-inner img {
 position: absolute;
 left: 61px;
 top: 61px;
 width: 902px;
 height: 902px;
 object-fit: cover;
 border-radius: 8px;
 cursor: pointer;
 transition: opacity 0.2s ease;
 }
 #customify-app-container .spotify-frame-inner img:hover {
 opacity: 0.85;
 }
 /* Ma≈Ça ikona edycji w prawym dolnym rogu - nie zas≈Çania zdjƒôcia */
 #customify-app-container .spotify-frame-preview .spotify-frame-inner::before {
 content: '‚úèÔ∏è';
 position: absolute;
 bottom: 15px;
 right: 15px;
 background: rgba(0,0,0,0.7);
 color: white;
 width: 36px;
 height: 36px;
 border-radius: 50%;
 display: flex;
 align-items: center;
 justify-content: center;
 font-size: 18px;
 z-index: 10;
 opacity: 0.8;
 transition: all 0.2s ease;
 pointer-events: none;
 box-shadow: 0 2px 8px rgba(0,0,0,0.3);
 }
 #customify-app-container .spotify-frame-preview .spotify-frame-inner:hover::before {
 opacity: 1;
 transform: scale(1.1);
 background: rgba(29, 185, 84, 0.9);
 }

 /* Crop modal */
 .spotify-crop-modal {
 position: fixed;
 inset: 0;
 background: rgba(0, 0, 0, 0.6);
 display: none;
 align-items: center;
 justify-content: center;
 z-index: 999999;
 padding: 16px;
 box-sizing: border-box;
 }
 .spotify-crop-modal.is-open {
 display: flex;
 }
 @media (max-width: 768px) {
 .spotify-crop-modal {
 padding: 0; /* Na mobile: bez padding, dialog na ca≈ÇƒÖ szeroko≈õƒá */
 }
 }
 .spotify-crop-dialog {
 width: 100%;
 max-width: 520px;
 background: #ffffff;
 border-radius: 12px;
 padding: 16px;
 box-sizing: border-box;
 }
 @media (max-width: 768px) {
 .spotify-crop-dialog {
 max-width: 100%;
 width: 100%;
 border-radius: 0; /* Na mobile: bez zaokrƒÖgle≈Ñ */
 padding: 12px;
 height: 100vh; /* Na mobile: pe≈Çna wysoko≈õƒá */
 display: flex;
 flex-direction: column;
 }
 }
 .spotify-crop-canvas {
 position: relative;
 width: 100%;
 max-height: 70vh;
 overflow: hidden;
 border-radius: 8px;
 background: #f4f4f4;
 margin: 12px 0;
 }
 .spotify-crop-canvas img {
 max-width: 100%;
 display: block;
 }
 .spotify-crop-actions {
 display: flex;
 gap: 10px;
 justify-content: flex-end;
 }

 /* üì± Telefon - Crop modal */
 .phone-crop-modal {
 position: fixed;
 inset: 0;
 background: rgba(0, 0, 0, 0.6);
 display: none;
 align-items: center;
 justify-content: center;
 z-index: 999999;
 padding: 16px;
 box-sizing: border-box;
 }
 .phone-crop-modal.is-open {
 display: flex;
 }
 @media (max-width: 768px) {
 .phone-crop-modal {
 padding: 0; /* Na mobile: bez padding, dialog na ca≈ÇƒÖ szeroko≈õƒá */
 }
 }
 .phone-crop-dialog {
 width: 100%;
 max-width: 520px;
 background: #ffffff;
 border-radius: 12px;
 padding: 16px;
 box-sizing: border-box;
 }
 @media (max-width: 768px) {
 .phone-crop-dialog {
 max-width: 100%;
 width: 100%;
 border-radius: 0; /* Na mobile: bez zaokrƒÖgle≈Ñ */
 padding: 12px;
 height: 100vh; /* Na mobile: pe≈Çna wysoko≈õƒá */
 display: flex;
 flex-direction: column;
 }
 }
 .phone-crop-canvas {
 position: relative;
 width: 100%;
 max-height: 70vh;
 overflow: hidden;
 border-radius: 8px;
 background: #f4f4f4;
 margin: 12px 0;
 }
 .phone-crop-canvas img {
 max-width: 100%;
 display: block;
 }
 .phone-crop-actions {
 display: flex;
 gap: 10px;
 justify-content: flex-end;
 }
 
 {% endif %}
 
 {% if product.handle == 'personalizowane-etui-na-telefon-z-twoim-zdjeciem' %}
 /* üì± Telefon (etui) - Crop modal */
 .phone-photo-crop-modal {
 position: fixed;
 inset: 0;
 background: rgba(0, 0, 0, 0.6);
 display: none;
 align-items: center;
 justify-content: center;
 z-index: 999999;
 padding: 16px;
 box-sizing: border-box;
 }
 .phone-photo-crop-modal.is-open {
 display: flex;
 }
 @media (max-width: 768px) {
 .phone-photo-crop-modal {
 padding: 0; /* Na mobile: bez padding, dialog na ca≈ÇƒÖ szeroko≈õƒá */
 }
 }
 .phone-photo-crop-dialog {
 width: 100%;
 max-width: 520px;
 background: #ffffff;
 border-radius: 12px;
 padding: 16px;
 box-sizing: border-box;
 }
 @media (max-width: 768px) {
 .phone-photo-crop-dialog {
 max-width: 100%;
 width: 100%;
 border-radius: 0; /* Na mobile: bez zaokrƒÖgle≈Ñ */
 padding: 12px;
 height: 100vh; /* Na mobile: pe≈Çna wysoko≈õƒá */
 display: flex;
 flex-direction: column;
 }
 }
 .phone-photo-crop-canvas {
 position: relative;
 width: 100%;
 min-height: 400px;
 max-height: 70vh;
 overflow: visible;
 border-radius: 8px;
 background: #f4f4f4;
 margin: 12px 0;
 }
 .phone-photo-crop-canvas img {
 max-width: 100%;
 display: block;
 }
 .phone-photo-crop-canvas .cropper-container {
 z-index: 2;
 }
 .phone-photo-crop-canvas .cropper-point,
 .phone-photo-crop-canvas .cropper-line {
 z-index: 10;
 }
 .phone-photo-crop-watermark {
 position: absolute;
 inset: 0;
 background-size: contain;
 background-position: center;
 background-repeat: no-repeat;
 pointer-events: none;
 z-index: 5;
 }
 .phone-photo-crop-actions {
 display: flex;
 gap: 10px;
 justify-content: flex-end;
 }
 {% endif %}
 
 /* Marginesy po przeniesieniu sekcji typu i rozmiaru nad cenƒô */
 #type-size-inline-slot > .customify-product-type-selector,
 #type-size-inline-slot > .customify-size-selector {
 margin: 10px 0 10px 0;
 }
 /* GRID STYL√ìW AI - TYLKO STYLE, NIE DOTYKAM PROPORCJI */
 .customify-style-grid {
 display: grid;
 grid-template-columns: repeat(4, 1fr);
 gap: 15px;
 margin-bottom: 20px;
 }

 .customify-style-card {
 border: 2px solid #dee2e6;
 border-radius: 8px;
 background: white;
 cursor: pointer;
 transition: all 0.3s ease;
 overflow: hidden;
 }

 .customify-style-card:hover {
 border-color: #c82333;
 transform: translateY(-2px);
 box-shadow: 0 4px 12px rgba(0,0,0,0.1);
 }

 .customify-style-card.active {
 border-color: #dc3545 !important;
 box-shadow: 0 0 0 2px rgba(220, 53, 69, 0.2) !important;
 transform: scale(1.02) !important;
 }

 .style-image {
 width: 100%;
 aspect-ratio: 3 / 4; /* üéØ WSZYSTKIE style - jednolity pionowy format portret */
 background-size: contain;
 background-position: center;
 background-repeat: no-repeat;
 }

 /* Gradienty usuniƒôte - u≈ºywamy obrazk√≥w */

 .style-info {
 padding: 8px;
 text-align: center;
 }

 .style-name {
 font-weight: 600;
 font-size: 0.9rem;
 color: #333;
 margin-bottom: 2px;
 }

 /* Ceny styl√≥w usuniƒôte - style nie wp≈ÇywajƒÖ na cenƒô */

 @media (max-width: 768px) {
 .customify-style-grid {
 grid-template-columns: repeat(2, 1fr);
 gap: 10px;
 }
 }

 /* MOBILE HEADER STYLES */
 @media (max-width: 768px) {
 /* G√ìRA HEADERA: Logo + Ikony w jednej linii */
 .header-top .header-container {
 display: flex !important;
 flex-direction: row !important;
 align-items: center !important;
 justify-content: space-between !important;
 padding: 15px !important;
 gap: 15px !important;
 }
 
 /* LOGO NA MOBILE */
 .header-logo {
 flex-grow: 1 !important;
 text-align: center !important;
 }
 
 /* ZMNIEJSZ LOGO NA MOBILE */
 .header-logo img {
 max-width: 120px !important;
 height: auto !important;
 }
 
 /* IKONKI PO PRAWEJ */
 .header-right {
 display: flex !important;
 align-items: center !important;
 gap: 15px !important;
 }
 
 /* D√ì≈Å HEADERA: Menu poni≈ºej */
 .header-bottom {
 width: 100% !important;
 background-color: #f8f9fa !important;
 border-top: 1px solid #dee2e6 !important;
 }
 
 .header-bottom .header-container {
 padding: 10px 15px !important;
 }
 
 .header-nav {
 display: flex !important;
 justify-content: center !important;
 flex-wrap: wrap !important;
 gap: 15px !important;
 }
 
 .nav-item {
 margin-right: 0 !important;
 margin-bottom: 0 !important;
 }
 
 .nav-link {
 font-size: 14px !important;
 padding: 8px 12px !important;
 color: #495057 !important;
 text-decoration: none !important;
 border-radius: 4px !important;
 transition: background-color 0.2s !important;
 }
 
 .nav-link:hover {
 background-color: #e9ecef !important;
 color: #dc3545 !important;
 }
 
 /* UKRYJ NAPISY "ZALOGUJ" I "ZAREJESTRUJ" NA MOBILE */
 .user-text-link {
 display: none !important;
 }
 
 /* ZOSTAW TYLKO IKONKƒò OSOBY */
 .user-section {
 display: flex !important;
 align-items: center !important;
 justify-content: center !important;
 gap: 0 !important;
 }
 
 /* ZMIE≈É IKONKƒò OSOBY NA BARDZIEJ POPULARNƒÑ I MNIEJ KOLOROWƒÑ */
 .user-icon-wrapper {
 width: 36px !important;
 height: 36px !important;
 border-radius: 50% !important;
 background-color: #f8f9fa !important;
 border: 1px solid #dee2e6 !important;
 display: flex !important;
 align-items: center !important;
 justify-content: center !important;
 text-decoration: none !important;
 cursor: pointer !important;
 }
 
 .user-icon {
 width: 20px !important;
 height: 20px !important;
 color: #6c757d !important;
 }
 
 /* HOVER EFFECT DLA IKONKI */
 .user-section:hover .user-icon-wrapper {
 border-color: #dc3545 !important;
 background-color: #fff5f5 !important;
 }
 
 .user-section:hover .user-icon {
 color: #dc3545 !important;
 }
 }

 /* CSS dla rozmiar√≥w */
 .customify-size-selector {
 display: block;
 margin-bottom: 24px;
 background: white;
 border-radius: 0;
 padding: 8px 0; /* ZMNIEJSZONO: z 20px na 8px */
 border: none;
 border-top: 1px solid #e9ecef;
 }

 .customify-size-selector h4 {
 font-size: 1.2rem;
 font-weight: 600;
 color: #000;
 margin: 0 0 16px 0;
 text-align: center;
 }

 .customify-size-buttons {
 display: grid;
 grid-template-columns: repeat(auto-fit, minmax(65px, 1fr));
 gap: 8px;
 justify-content: start;
 max-width: 500px;
 }

 .customify-size-btn {
 padding: 8px 12px;
 border: 1px solid #666666 !important;
 border-radius: 0;
 background: white;
 cursor: pointer;
 transition: all 0.3s ease;
 text-align: center;
 font-size: 0.85rem;
 font-weight: 500;
 color: #333;
 box-shadow: none;
 line-height: normal;
 min-height: 40px;
 display: flex;
 align-items: center;
 justify-content: center;
 }

 .customify-size-btn:hover {
 border-color: #f0ad00;
 background-color: #fff9db;
 transform: none;
 box-shadow: none;
 }

 .customify-size-btn.active {
 border: 2px solid #f0ad00 !important;
 background: #fff7cc !important;
 color: #b7791f !important;
 font-weight: 600 !important;
 transform: none !important;
 box-shadow: none !important;
 }

 .customify-size-btn.disabled {
 pointer-events: none;
 opacity: 0.5;
 cursor: not-allowed;
 border: 1px solid #d0d0d0 !important;
 color: #999999 !important;
 background: #f8f9fa !important;
 }

 .customify-size-btn.disabled:hover {
 background-color: #f8f9fa !important;
 border: 1px solid #d0d0d0 !important;
 transform: none !important;
 box-shadow: none !important;
 }

 /* ===== UKRYJ NATYWNE WARIANTY SHOPIFY ===== */
 .variant-picker__form,
 fieldset.variant-option,
 .variant-option--buttons {
 display: none !important;
 }
 
 /* ===== PRZYCISKI WYBORU TYPU PRODUKTU (Plakat vs Canvas vs Digital) ===== */
 /* üö® ROLLBACK: START - CSS dla 3 przycisk√≥w (dodano produkt cyfrowy) */
 .customify-product-type-buttons {
 display: grid;
 grid-template-columns: repeat(3, 1fr); /* üö® ROLLBACK: Zmieniono z 2 na 3 */
 gap: 8px;
 justify-content: start;
 margin-top: 8px;
 max-width: 600px; /* üö® ROLLBACK: Zwiƒôkszono szeroko≈õƒá dla 3 przycisk√≥w */
 }
 /* üö® ROLLBACK: END - CSS dla 3 przycisk√≥w */

 .customify-product-type-btn {
 padding: 1px 6px;
 border: 1px solid #666666 !important;
 border-radius: 0;
 background: white;
 cursor: pointer;
 transition: all 0.3s ease;
 text-align: center;
 font-size: 0.85rem;
 font-weight: 500;
 color: #333;
 box-shadow: none;
 line-height: 1.3;
 min-height: 36px;
 display: flex;
 align-items: center;
 justify-content: center;
 }

 .customify-product-type-btn:hover {
 border-color: #f0ad00;
 background-color: #fff9db;
 transform: none;
 box-shadow: none;
 }

 .customify-product-type-btn.active {
 border: 2px solid #f0ad00 !important;
 background: #fff7cc !important;
 color: #b7791f !important;
 font-weight: 600 !important;
 transform: none !important;
 box-shadow: none !important;
 }

 /* Responsive dla typu produktu */
 /* üö® ROLLBACK: START - Responsive dla 3 przycisk√≥w */
 @media (max-width: 768px) {
 .customify-product-type-btn {
 font-size: 0.8rem !important;
 padding: 1px 4px !important;
 min-height: 32px !important;
 }
 .customify-product-type-buttons {
 grid-template-columns: repeat(3, 1fr) !important; /* üö® ROLLBACK: 3 kolumny na mobile */
 gap: 6px !important;
 }
 }
 /* üö® ROLLBACK: END - Responsive dla 3 przycisk√≥w */

 /* Style dla ceny produktu - NAPRAWIONY SELEKTOR */
 product-price > div,
 product-price div {
 font-size: 1.4rem !important;
 font-weight: 700 !important;
 color: #000000 !important; /* CZARNY KOLOR */
 margin: 0 !important;
 padding: 0 !important;
 line-height: 1.1 !important;
 }
 
 /* Dodatkowe selektory dla ceny produktu */
 .price,
 [class*="price"] {
 font-size: 1.4rem !important;
 font-weight: 700 !important;
 color: #000000 !important; /* CZARNY KOLOR */
 }
 
 /* Minimalne odstƒôpy w komponencie ceny */
 product-price {
 display: inline-block !important;
 margin: 0 !important;
 padding: 0 !important;
 line-height: 1.1 !important;
 --padding-block-start: 0px !important;
 --padding-block-end: 0px !important;
 }
 
 /* OCHRONA: Nowa cena nad przyciskiem NIE wp≈Çywa na oryginalnƒÖ cenƒô */
 .customify-cart-price {
 /* Nowa cena ma w≈Çasne style - nie wp≈Çywa na oryginalnƒÖ cenƒô */
 }
 
 /* Upewnij siƒô ≈ºe oryginalna cena produktu ma priorytet */
 product-price,
 product-price > div,
 product-price div,
 .price,
 [class*="price"] {
 font-size: 1.4rem !important;
 font-weight: 700 !important;
 color: #000000 !important; /* CZARNY KOLOR */
 text-decoration: none !important;
 }
 </style>
 <script>
 // Dynamiczne przenoszenie sekcji rodzaju i rozmiaru nad cenƒô, gdy widoczny jest wynik AI
 document.addEventListener('DOMContentLoaded', function() {
 var resultArea = document.getElementById('resultArea');
 var inlineSlot = document.getElementById('type-size-inline-slot');
 var originalPlaceholder = document.getElementById('type-size-original-placeholder');
 var productTypeArea = document.getElementById('productTypeArea');
 var sizeArea = document.getElementById('sizeArea');
 // Elemente ramki
 var frameSelector = document.getElementById('frameSelector');
 var frameToggle = document.getElementById('frameToggle');
 var frameOptions = document.getElementById('frameOptions');
 var frameCurrentLabel = document.getElementById('frameCurrentLabel');

 if (!resultArea || !inlineSlot || !originalPlaceholder || !productTypeArea || !sizeArea) {
 return;
 }

 function isVisible(el) {
 if (!el) return false;
 var style = window.getComputedStyle(el);
 return style.display !== 'none' && style.visibility !== 'hidden' && el.offsetParent !== null;
 }

 function moveToResult() {
 if (!inlineSlot.contains(productTypeArea)) {
 inlineSlot.appendChild(productTypeArea);
 }
 if (!inlineSlot.contains(sizeArea)) {
 inlineSlot.appendChild(sizeArea);
 }
 }

 function moveBack() {
 if (productTypeArea && productTypeArea.parentElement !== originalPlaceholder.parentElement) {
 originalPlaceholder.parentNode.insertBefore(productTypeArea, originalPlaceholder);
 }
 if (sizeArea && sizeArea.parentElement !== originalPlaceholder.parentElement) {
 originalPlaceholder.parentNode.insertBefore(sizeArea, originalPlaceholder);
 }
 }

 function syncPosition() {
 // üéµ SPOTIFY: Nie przeno≈õ element√≥w gdy "bez-zmian" jest aktywny
 if (window.spotifyBezZmianActive) {
 return;
 }
 if (isVisible(resultArea)) {
 moveToResult();
 } else {
 moveBack();
 }
 }

 // Obserwuj zmiany widoczno≈õci
 var observer = new MutationObserver(syncPosition);
 observer.observe(resultArea, { attributes: true, attributeFilter: ['style', 'class'], subtree: false });

 // Polling jako fallback (np. zmiany przez skrypty zewnƒôtrzne)
 setInterval(syncPosition, 500);

 // Pierwsza synchronizacja
 syncPosition();

 // ============ LOGIKA RAMKI ============
 // Stan globalny (wsp√≥≈Çdzielony miƒôdzy lokalizacjami)
 window.CustomifyFrame = window.CustomifyFrame || { color: 'none' };

 function setFrame(color) {
 window.CustomifyFrame.color = color;
 // Aktualizuj UI
 if (frameCurrentLabel) {
 frameCurrentLabel.textContent =
 color === 'black' ? 'Czarna' :
 color === 'white' ? 'Bia≈Ça' :
 color === 'wood' ? 'Drewno' : 'Brak ramki';
 }
 if (frameOptions) {
 var opts = frameOptions.querySelectorAll('.frame-option');
 opts.forEach(function(opt){
 opt.setAttribute('aria-selected', opt.getAttribute('data-frame') === color ? 'true' : 'false');
 });
 }
 }

 function toggleOptions() {
 if (!frameOptions) return;
 var isOpen = frameOptions.style.display !== 'none';
 frameOptions.style.display = isOpen ? 'none' : 'block';
 if (frameSelector) frameSelector.setAttribute('aria-expanded', isOpen ? 'false' : 'true');
 }

 function closeOptions() {
 if (frameOptions) {
 frameOptions.style.display = 'none';
 if (frameSelector) frameSelector.setAttribute('aria-expanded', 'false');
 }
 }

 function isPlakatSelected() {
 var active = productTypeArea && productTypeArea.querySelector('.customify-product-type-btn.active');
 return active && active.getAttribute('data-product-type') === 'plakat';
 }

 // üö® ROLLBACK: START - Funkcje dla produktu cyfrowego
 function isDigitalProductSelected() {
 var active = productTypeArea && productTypeArea.querySelector('.customify-product-type-btn.active');
 return active && active.getAttribute('data-product-type') === 'digital';
 }

 function updateDigitalProductUI() {
 var isDigital = isDigitalProductSelected();
 var sizeArea = document.getElementById('sizeArea');
 
 // Ukryj/poka≈º rozmiary
 if (sizeArea) {
 if (isDigital) {
 sizeArea.style.display = 'none';
 console.log('üì¶ [DIGITAL] Size area hidden for digital product');
 } else {
 sizeArea.style.display = 'block';
 console.log('üì¶ [DIGITAL] Size area shown for physical product');
 }
 }
 }
 // üö® ROLLBACK: END - Funkcje dla produktu cyfrowego

 function updateFrameAvailability() {
 var enabled = isPlakatSelected();
 // üö® ROLLBACK: START - Ukryj ramkƒô dla produktu cyfrowego
 var isDigital = isDigitalProductSelected();
 if (isDigital) {
 enabled = false; // Produkt cyfrowy nie ma ramki
 }
 // üö® ROLLBACK: END - Ukryj ramkƒô dla produktu cyfrowego
 
 if (frameSelector) {
 if (enabled) {
 frameSelector.style.display = 'block'; // ‚úÖ Pokazuje ramkƒô
 frameSelector.classList.remove('disabled');
 } else {
 frameSelector.style.display = 'none'; // ‚úÖ Ca≈Çkowicie ukrywa ramkƒô
 frameSelector.classList.add('disabled');
 closeOptions();
 }
 }
 }

 // ============ üÜï LOGIKA PODSTAWKI (SZK≈ÅO) ============
 window.CustomifyStand = window.CustomifyStand || { type: 'none' };
 
 var standSelector = document.getElementById('standSelector');
 var standToggle = document.getElementById('standToggle');
 var standOptions = document.getElementById('standOptions');
 var standCurrentLabel = document.getElementById('standCurrentLabel');
 
 function isSzkloSelected() {
 var active = productTypeArea && productTypeArea.querySelector('.customify-product-type-btn.active');
 return active && active.getAttribute('data-product-type') === 'szklo';
 }
 
 function setStand(type) {
 window.CustomifyStand.type = type;
 // Aktualizuj UI
 if (standCurrentLabel) {
 standCurrentLabel.textContent =
 type === 'wood' ? 'Podstawka drewniana (+29 z≈Ç)' :
 type === 'led' ? 'Podstawka drewniana z LED (+44.90 z≈Ç)' :
 'Brak podstawki';
 }
 if (standOptions) {
 var opts = standOptions.querySelectorAll('.stand-option');
 opts.forEach(function(opt){
 opt.setAttribute('aria-selected', opt.getAttribute('data-stand') === type ? 'true' : 'false');
 });
 }
 
 // Aktualizuj ceny po zmianie podstawki
 if (window.__customify) {
 window.__customify.updateProductPrice();
 window.__customify.updateCartPrice();
 }
 }
 
 function toggleStandOptions() {
 if (!standOptions) return;
 var isOpen = standOptions.style.display !== 'none';
 standOptions.style.display = isOpen ? 'none' : 'block';
 if (standSelector) standSelector.setAttribute('aria-expanded', isOpen ? 'false' : 'true');
 }
 
 function closeStandOptions() {
 if (standOptions) {
 standOptions.style.display = 'none';
 if (standSelector) standSelector.setAttribute('aria-expanded', 'false');
 }
 }
 
 function updateStandAvailability() {
 var enabled = isSzkloSelected();
 
 if (standSelector) {
 if (enabled) {
 standSelector.style.display = 'block';
 standSelector.classList.remove('disabled');
 } else {
 standSelector.style.display = 'none';
 standSelector.classList.add('disabled');
 closeStandOptions();
 }
 }
 }
 
 function updateSizeAvailability() {
 var isSzklo = isSzkloSelected();
 var sizeButtons = document.querySelectorAll('.customify-size-btn');
 
 sizeButtons.forEach(function(btn) {
 var size = btn.getAttribute('data-size');
 if (isSzklo) {
 // Dla szk≈Ça: tylko A5 i A4 widoczne
 if (size === 'a5' || size === 'a4') {
 btn.style.display = 'block';
 } else {
 btn.style.display = 'none';
 }
 } else {
 // Dla plakat/canvas: A4, A3, A2, A0, A1 widoczne (bez A5)
 if (size === 'a5') {
 btn.style.display = 'none';
 } else {
 btn.style.display = 'block';
 }
 }
 });
 
 // Je≈õli aktualnie wybrany rozmiar jest ukryty, wybierz pierwszy widoczny
 if (window.__customify && window.__customify.selectedSize) {
 var currentBtn = document.querySelector('.customify-size-btn[data-size="' + window.__customify.selectedSize + '"]');
 if (currentBtn && currentBtn.style.display === 'none') {
 // Wybierz pierwszy widoczny rozmiar
 var firstVisible = Array.from(sizeButtons).find(function(b) { return b.style.display !== 'none'; });
 if (firstVisible) {
 firstVisible.click();
 }
 }
 }
 }

 // Inicjalizacja UI ramki i podstawki
 setFrame(window.CustomifyFrame.color || 'none');
 setStand(window.CustomifyStand.type || 'none');
 updateFrameAvailability();
 updateStandAvailability();
 updateSizeAvailability();
 // üö® ROLLBACK: START - Inicjalizacja UI produktu cyfrowego
 updateDigitalProductUI();
 // üö® ROLLBACK: END - Inicjalizacja UI produktu cyfrowego

 // Zdarzenia UI
 if (frameToggle) {
 frameToggle.addEventListener('click', function(e){
 if (frameSelector && frameSelector.classList.contains('disabled')) return;
 toggleOptions();
 });
 }
 if (frameOptions) {
 frameOptions.addEventListener('click', function(e){
 var target = e.target.closest('.frame-option');
 if (!target) return;
 if (frameSelector && frameSelector.classList.contains('disabled')) return;
 var color = target.getAttribute('data-frame');
 setFrame(color);
 closeOptions();
 if (window.__customify && typeof window.__customify.updateCartPrice === 'function') {
 window.__customify.updateCartPrice();
 if (typeof window.__customify.updateProductPrice === 'function') {
 window.__customify.updateProductPrice();
 }
 }
 });
 }
 document.addEventListener('click', function(e){
 if (!frameSelector) return;
 if (!frameSelector.contains(e.target)) closeOptions();
 });
 
 // üÜï Event listenery dla podstawki (szk≈Ço)
 if (standToggle) {
 standToggle.addEventListener('click', function(e){
 if (standSelector && standSelector.classList.contains('disabled')) return;
 toggleStandOptions();
 });
 }
 if (standOptions) {
 standOptions.addEventListener('click', function(e){
 var target = e.target.closest('.stand-option');
 if (!target) return;
 if (standSelector && standSelector.classList.contains('disabled')) return;
 var type = target.getAttribute('data-stand');
 setStand(type);
 closeStandOptions();
 });
 }
 document.addEventListener('click', function(e){
 if (!standSelector) return;
 if (!standSelector.contains(e.target)) closeStandOptions();
 });

 // Nas≈Çuchiwanie na zmianƒô typu produktu (Plakat/Canvas/Szk≈Ço/Digital)
 var typeBtns = productTypeArea ? productTypeArea.querySelectorAll('.customify-product-type-btn') : [];
 typeBtns.forEach(function(btn){
 btn.addEventListener('click', function(){
 // Daj czas istniejƒÖcym handlerom na ustawienie .active
 setTimeout(function(){
 updateFrameAvailability();
 updateStandAvailability(); // üÜï Aktualizuj dostƒôpno≈õƒá podstawki
 updateSizeAvailability(); // üÜï Aktualizuj widoczno≈õƒá rozmiar√≥w
 // üö® ROLLBACK: START - Aktualizuj UI produktu cyfrowego
 updateDigitalProductUI();
 // üö® ROLLBACK: END - Aktualizuj UI produktu cyfrowego
 }, 0);
 });
 });
 
 // üÜï AUTO-INICJALIZACJA dla produkt√≥w ze szk≈Çem
 var currentUrl = window.location.pathname.toLowerCase();
 var isSzkloProduct = currentUrl.includes('karykatura-na-zamowienie-druk-na-szkle-akrylowym-ramka-z-podswietleniem') || 
 currentUrl.includes('prezent-dla-babci-i-dziadka-portret-na-na-szkle-akrylowym-ze-zdjecia-karykatura') ||
 currentUrl.includes('dziadkowie-krolowie-nadruk-na-szkle') ||
 currentUrl.includes('portret-pary-personalizowany-obraz-na-szkle-akrylowym');
 
 if (isSzkloProduct) {
 console.log('üîç [SZKLO] Produkt ze szk≈Çem wykryty - automatyczne filtrowanie rozmiar√≥w');
 // Ustaw szk≈Ço jako wybrany typ
 if (window.__customify) {
 window.__customify.selectedProductType = 'szklo';
 }
 // Wywo≈Ça updateSizeAvailability() ≈ºeby pokazaƒá tylko A5 i A4
 updateStandAvailability();
 updateSizeAvailability();
 
 // üÜï AUTO-ZAZNACZ ROZMIAR A5 jako domy≈õlny dla szk≈Ça
 setTimeout(function() {
 var a5Btn = document.querySelector('.customify-size-btn[data-size="a5"]');
 var activeBtn = document.querySelector('.customify-size-btn.active');
 var activeSize = activeBtn ? activeBtn.getAttribute('data-size') : null;
 if (a5Btn && activeSize !== 'a5') {
 a5Btn.click();
 console.log('‚úÖ [SZKLO] Automatycznie zaznaczono rozmiar A5');
 }
 }, 100);
 
 console.log('‚úÖ [SZKLO] Automatycznie pokazano tylko rozmiary dla szk≈Ça (A5, A4)');
 }
 });
 </script>
 {% endif %}

 {% comment %} CUSTOMIFY CART INTEGRATION {% endcomment %}
 {% if template contains 'cart' %}
 <style>
 .cart-item__ai-image {
 width: 80px;
 height: 80px;
 object-fit: cover;
 border-radius: 0;
 border: 2px solid #e0e0e0;
 margin-right: 15px;
 }
 
 .cart-item__content-wrapper {
 display: flex;
 gap: 15px;
 align-items: start;
 }
 
 /* Lightbox dla powiƒôkszonych obrazk√≥w AI */
 .customify-lightbox {
 position: fixed;
 top: 0;
 left: 0;
 width: 100vw;
 height: 100vh;
 background: rgba(0, 0, 0, 0.9);
 z-index: 99999;
 display: flex;
 align-items: center;
 justify-content: center;
 cursor: zoom-out;
 animation: fadeIn 0.2s ease;
 }
 
 @keyframes fadeIn {
 from { opacity: 0; }
 to { opacity: 1; }
 }
 
 .customify-lightbox img {
 max-width: 95vw;
 max-height: 95vh;
 width: auto;
 height: auto;
 object-fit: contain;
 image-rendering: -webkit-optimize-contrast;
 image-rendering: crisp-edges;
 border-radius: 8px;
 box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
 animation: zoomIn 0.2s ease;
 }
 
 @keyframes zoomIn {
 from { transform: scale(0.9); opacity: 0; }
 to { transform: scale(1); opacity: 1; }
 }
 
 .customify-lightbox-close {
 position: absolute;
 top: 20px;
 right: 20px;
 width: 40px;
 height: 40px;
 background: white;
 border: none;
 border-radius: 50%;
 cursor: pointer;
 font-size: 24px;
 font-weight: bold;
 color: #333;
 display: flex;
 align-items: center;
 justify-content: center;
 box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
 transition: all 0.2s ease;
 }
 
 .customify-lightbox-close:hover {
 background: #f5f5f5;
 transform: scale(1.1);
 }
 </style>
 
 <script>
 /**
 * CUSTOMIFY: Wy≈ÇƒÖcz linki do wszystkich produkt√≥w w koszyku
 * Klikniƒôcie miniaturki pokazuje powiƒôkszony obraz zamiast prowadziƒá do produktu
 * Wszystkie produkty w sklepie sƒÖ AI - nie ma potrzeby filtrowania
 */
 (function() {
 console.log('üõí [CUSTOMIFY CART] Inicjalizacja wy≈ÇƒÖczania link√≥w produkt√≥w AI');
 
 // Funkcja dodawania watermarku do obrazka
 async function addWatermarkToImage(imageUrl) {
 return new Promise((resolve, reject) => {
 const img = new Image();
 img.crossOrigin = 'anonymous';
 
 img.onload = () => {
 try {
 const canvas = document.createElement('canvas');
 const ctx = canvas.getContext('2d');
 
 canvas.width = img.width;
 canvas.height = img.height;
 
 // Rysuj oryginalny obraz
 ctx.drawImage(img, 0, 0);
 
 // ===== WZ√ìR DIAGONALNY - "Lumly.pl" i "PodglƒÖd" NA PRZEMIAN =====
 ctx.save();
 
 // ‚úÖ ZWIƒòKSZONY FONT I OPACITY DLA LEPSZEJ WIDOCZNO≈öCI
 const fontSize = Math.max(40, Math.min(canvas.width, canvas.height) * 0.08); // Min 40px, max 8% obrazu
 
 // ‚úÖ FIX: U≈ºyj systemowego fontu z fallbackami (Arial mo≈ºe nie byƒá dostƒôpny w Canvas)
 // U≈ºyj fontu kt√≥ry ZAWSZE jest dostƒôpny w przeglƒÖdarce
 const fontFamily = 'sans-serif'; // Systemowy font - zawsze dostƒôpny
 ctx.font = `bold ${fontSize}px ${fontFamily}`;
 
 // ‚úÖ SPRAWD≈π CZY FONT JEST ZA≈ÅADOWANY (test renderowania)
 ctx.fillStyle = 'rgba(255, 255, 255, 0.7)'; // ‚úÖ ZWIƒòKSZONA OPACITY (by≈Ço 0.5)
 ctx.strokeStyle = 'rgba(0, 0, 0, 0.5)'; // ‚úÖ ZWIƒòKSZONA OPACITY (by≈Ço 0.35)
 ctx.lineWidth = 2; // ‚úÖ ZWIƒòKSZONA GRUBO≈öƒÜ (by≈Ço 1.5)
 ctx.textAlign = 'center';
 ctx.textBaseline = 'middle';
 
 // ‚úÖ TEST: Sprawd≈∫ czy tekst siƒô renderuje (je≈õli nie - u≈ºyj innego fontu)
 const testText = 'Test';
 const testMetrics = ctx.measureText(testText);
 if (testMetrics.width === 0) {
 console.warn('‚ö†Ô∏è [WATERMARK] Font test failed, using fallback');
 ctx.font = `bold ${fontSize}px monospace`; // Fallback na monospace
 }
 
 // Obr√≥ƒá canvas
 ctx.translate(canvas.width/2, canvas.height/2);
 ctx.rotate(-30 * Math.PI / 180);
 ctx.translate(-canvas.width/2, -canvas.height/2);
 
 // Rysuj watermarki w siatce - na przemian "Lumly.pl" i "PodglƒÖd"
 const spacing = Math.max(200, Math.min(canvas.width, canvas.height) * 0.3); // ‚úÖ DYNAMICZNY SPACING
 let textIndex = 0;
 const texts = ['Lumly.pl', 'PodglƒÖd'];
 
 for(let y = -canvas.height; y < canvas.height * 2; y += spacing) {
 for(let x = -canvas.width; x < canvas.width * 2; x += spacing * 1.5) {
 const text = texts[textIndex % 2];
 // ‚úÖ RYSUJ STROKE PRZED FILL (dla lepszej widoczno≈õci)
 ctx.strokeText(text, x, y);
 ctx.fillText(text, x, y);
 textIndex++;
 }
 // Zmie≈Ñ wz√≥r co wiersz dla lepszego efektu
 textIndex++;
 }
 
 ctx.restore();
 
 // Zwr√≥ƒá obraz z watermarkiem jako Data URL
 resolve(canvas.toDataURL('image/jpeg', 0.92));
 console.log('‚úÖ [CUSTOMIFY CART] Watermark dodany do miniaturki');
 } catch (error) {
 console.error('‚ùå [CUSTOMIFY CART] Watermark error:', error);
 reject(error);
 }
 };
 
 img.onerror = (error) => {
 console.error('‚ùå [CUSTOMIFY CART] Image load error:', error);
 reject(error);
 };
 
 img.src = imageUrl;
 });
 }
 
 function showImageLightbox(imageUrl) {
 console.log('üîç [CUSTOMIFY CART] Pokazujƒô lightbox dla:', imageUrl);
 
 // Stw√≥rz overlay
 const overlay = document.createElement('div');
 overlay.className = 'customify-lightbox';
 
 // Dodaj powiƒôkszony obraz
 const img = document.createElement('img');
 img.src = imageUrl;
 img.alt = 'Powiƒôkszony obraz AI';
 
 // Przycisk zamkniƒôcia
 const closeBtn = document.createElement('button');
 closeBtn.className = 'customify-lightbox-close';
 closeBtn.innerHTML = '√ó';
 closeBtn.setAttribute('aria-label', 'Zamknij');
 
 overlay.appendChild(img);
 overlay.appendChild(closeBtn);
 
 // Zamknij po klikniƒôciu overlay lub przycisku
 overlay.addEventListener('click', (e) => {
 if (e.target === overlay || e.target === closeBtn) {
 overlay.remove();
 console.log('üîç [CUSTOMIFY CART] Lightbox zamkniƒôty');
 }
 });
 
 // Zamknij po ESC
 const handleEsc = (e) => {
 if (e.key === 'Escape') {
 overlay.remove();
 document.removeEventListener('keydown', handleEsc);
 console.log('üîç [CUSTOMIFY CART] Lightbox zamkniƒôty (ESC)');
 }
 };
 document.addEventListener('keydown', handleEsc);
 
 document.body.appendChild(overlay);
 }
 
 function disableAIProductLinks() {
 console.log('üõí [CUSTOMIFY CART] Wy≈ÇƒÖczam linki dla wszystkich produkt√≥w w koszyku...');
 
 // Znajd≈∫ wszystkie elementy koszyka (r√≥≈ºne selektory dla r√≥≈ºnych motyw√≥w)
 const cartItems = document.querySelectorAll(
 '.cart-item, .cart-items__table-row, .cart-items__row, [data-line-item], .line-item, .cart__line-item, tr[role="row"]'
 );
 
 console.log('üõí [CUSTOMIFY CART] Znaleziono element√≥w koszyka:', cartItems.length);
 
 cartItems.forEach((item, index) => {
 // Znajd≈∫ wszystkie linki w tym elemencie (miniaturka + tytu≈Ç)
 const links = item.querySelectorAll('a[href*="/products/"]');
 console.log(`üîó [CUSTOMIFY CART] Element ${index} - znaleziono link√≥w: ${links.length}`);
 
 links.forEach(async (link, linkIndex) => {
 // Sprawd≈∫ czy ju≈º przetworzono ten link (unikaj wielokrotnego dodawania event listener√≥w)
 if (link.dataset.customifyProcessed === 'true') {
 console.log(`‚è≠Ô∏è [CUSTOMIFY CART] Link ${linkIndex} ju≈º przetworzony - pomijam`);
 return;
 }
 
 // Oznacz jako przetworzony
 link.dataset.customifyProcessed = 'true';
 
 // Znajd≈∫ obrazek w linku
 const img = link.querySelector('img');
 
 if (img) {
 // To jest link z miniaturkƒÖ - sprawd≈∫ czy mamy URL z watermarkiem w cart properties
 console.log(`üñºÔ∏è [CUSTOMIFY CART] Link ${linkIndex} ma obrazek`);
 console.log(` Obrazek src: ${img.src}`);
 
 // Znajd≈∫ cart properties dla tego produktu
 const cartItem = link.closest('.cart-item, .cart-items__table-row, tr[role="row"]');
 let watermarkedUrl = null;
 
 if (cartItem) {
 const properties = cartItem.querySelectorAll('.cart-items__properties dd, dd[data-property]');
 properties.forEach(prop => {
 const dt = prop.previousElementSibling;
 if (!dt) return;

 const propertyName = dt.textContent.trim();
 const normalizedName = propertyName.replace(/\s+/g, '').toLowerCase();

 if (normalizedName.includes('ai_image_watermarked')) {
 watermarkedUrl = prop.textContent.trim();
 console.log('‚úÖ [CUSTOMIFY CART] Znaleziono URL z watermarkiem:', watermarkedUrl);
 }

 // ‚úÖ UKRYJ "Styl AI" i wszystkie ukryte properties
 if (propertyName.startsWith('_') || 
 normalizedName.includes('ai_image_') || 
 normalizedName.includes('styl ai') || 
 normalizedName === 'stylai' ||
 propertyName === 'Styl AI' ||
 propertyName.toLowerCase() === 'styl ai' ||
 propertyName.includes('Styl AI') ||
 propertyName.includes('styl ai')) {
 dt.style.display = 'none';
 prop.style.display = 'none';
 console.log('üôà [CUSTOMIFY CART] Ukryto property:', propertyName);
 }
 });
 }
 
 // ‚úÖ G≈Ç√≥wny obrazek produktu w Shopify jest ju≈º Z watermarkiem (uploadowany z watermarkedImage)
 // ‚úÖ Miniaturka: ma≈Ça (250px) - Shopify automatycznie
 // ‚úÖ Lightbox: DU≈ªA (1200px) - zmieniamy parametr width w URL
 
 let originalSrc = img.src;
 console.log('üñºÔ∏è [CUSTOMIFY CART] Oryginalny src:', originalSrc);
 
 // Zmie≈Ñ URL Shopify na wiƒôkszy rozmiar dla lightbox (1200px zamiast 250px)
 if (originalSrc.includes('cdn.shopify.com') || originalSrc.includes('lumly.pl/cdn/')) {
 let largeImageSrc = originalSrc;
 
 if (largeImageSrc.includes('width=')) {
 // Zmie≈Ñ istniejƒÖcy parametr width
 largeImageSrc = largeImageSrc.replace(/width=\d+/, 'width=1200');
 } else {
 // Dodaj parametr width
 largeImageSrc = largeImageSrc + (largeImageSrc.includes('?') ? '&' : '?') + 'width=1200';
 }
 
 img.dataset.watermarkedSrc = largeImageSrc;
 console.log('‚úÖ [CUSTOMIFY CART] Przygotowano wiƒôkszy obrazek (1200px):', largeImageSrc);
 } else {
 // Nie ma cdn.shopify.com - zostaw oryginalny
 img.dataset.watermarkedSrc = originalSrc;
 console.log('‚ö†Ô∏è [CUSTOMIFY CART] To nie jest Shopify CDN URL - u≈ºywam oryginalnego');
 }
 
 link.addEventListener('click', (e) => {
 e.preventDefault();
 e.stopPropagation();
 console.log('üñºÔ∏è [CUSTOMIFY CART] Klikniƒôto miniaturkƒô - pokazujƒô lightbox');
 
 // U≈ºyj wiƒôkszego obrazka (1200px) przygotowanego wcze≈õniej
 const imageToShow = img.dataset.watermarkedSrc || img.src;
 console.log('üìè [CUSTOMIFY CART] Pokazujƒô obrazek:', imageToShow);
 
 showImageLightbox(imageToShow);
 });
 
 // Zmie≈Ñ cursor na zoom-in
 link.style.cursor = 'zoom-in';
 link.title = 'Kliknij aby powiƒôkszyƒá';
 } else {
 // To jest link z tytu≈Çem - wy≈ÇƒÖcz ca≈Çkowicie
 console.log(`üìù [CUSTOMIFY CART] Link ${linkIndex} to tytu≈Ç - wy≈ÇƒÖczam`);
 console.log(` Link href: ${link.href}`);
 console.log(` Link text: ${link.textContent.trim()}`);
 
 link.addEventListener('click', (e) => {
 e.preventDefault();
 e.stopPropagation();
 console.log('üìù [CUSTOMIFY CART] Klikniƒôto tytu≈Ç - blokujƒô');
 });
 
 link.style.cursor = 'default';
 link.style.pointerEvents = 'none';
 link.style.textDecoration = 'none';
 }
 });
 });
 
 console.log(`‚úÖ [CUSTOMIFY CART] Wy≈ÇƒÖczono linki dla ${cartItems.length} produkt√≥w`);
 }
 
 // Uruchom po za≈Çadowaniu DOM
 if (document.readyState === 'loading') {
 document.addEventListener('DOMContentLoaded', disableAIProductLinks);
 } else {
 disableAIProductLinks();
 }
 
 // Uruchom ponownie po zmianach w koszyku (Ajax Cart)
 document.addEventListener('cart:updated', () => {
 console.log('üõí [CUSTOMIFY CART] Koszyk zaktualizowany - ponowne skanowanie');
 setTimeout(disableAIProductLinks, 500);
 });
 
 // Obserwuj zmiany w DOM (dla dynamicznych aktualizacji koszyka)
 const observer = new MutationObserver((mutations) => {
 // Sprawd≈∫ czy zmiana nie jest w lightbox (ignoruj zmiany w lightbox)
 const isLightboxChange = mutations.some(mutation => {
 return Array.from(mutation.addedNodes).some(node => {
 return node.classList && node.classList.contains('customify-lightbox');
 }) || Array.from(mutation.removedNodes).some(node => {
 return node.classList && node.classList.contains('customify-lightbox');
 });
 });
 
 if (isLightboxChange) {
 console.log('üõí [CUSTOMIFY CART] Zmiana w lightbox - ignorujƒô');
 return;
 }
 
 console.log('üõí [CUSTOMIFY CART] Wykryto zmiany w DOM - ponowne skanowanie');
 disableAIProductLinks();
 });
 
 // Obserwuj zmiany tylko w kontenerze koszyka (nie w ca≈Çym body)
 const cartContainer = document.querySelector('.cart-items, .cart, [data-cart-items]') || document.body;
 observer.observe(cartContainer, {
 childList: true,
 subtree: true
 });
 
 console.log('‚úÖ [CUSTOMIFY CART] Inicjalizacja zako≈Ñczona - obserwujƒô zmiany');
 })();
 </script>
 {% endif %}

 {% comment %} CUSTOMIFY CHECKOUT INTEGRATION - Wy≈ÇƒÖcz linki produkt√≥w {% endcomment %}
 <script>
 /**
 * CUSTOMIFY: Wy≈ÇƒÖcz linki do wszystkich produkt√≥w w checkout
 * Dzia≈Ça r√≥wnie≈º w checkout (Shopify Plus) i thank you page
 * Wszystkie produkty w sklepie sƒÖ AI - nie ma potrzeby filtrowania
 */
 (function() {
 // Sprawd≈∫ czy jeste≈õmy na checkout lub thank you page
 const isCheckout = window.location.pathname.includes('/checkout') || 
 window.location.pathname.includes('/thank_you') ||
 window.Shopify?.Checkout;
 
 if (!isCheckout) {
 console.log('üõí [CUSTOMIFY CHECKOUT] Nie jeste≈õmy na checkout - pomijam');
 return;
 }
 
 console.log('üõí [CUSTOMIFY CHECKOUT] Inicjalizacja wy≈ÇƒÖczania link√≥w produkt√≥w AI');
 
 function showImageLightbox(imageUrl) {
 console.log('üîç [CUSTOMIFY CHECKOUT] Pokazujƒô lightbox dla:', imageUrl);
 
 // Stw√≥rz overlay
 const overlay = document.createElement('div');
 overlay.style.cssText = `
 position: fixed;
 top: 0;
 left: 0;
 width: 100vw;
 height: 100vh;
 background: rgba(0, 0, 0, 0.9);
 z-index: 99999;
 display: flex;
 align-items: center;
 justify-content: center;
 cursor: zoom-out;
 animation: fadeIn 0.2s ease;
 `;
 
 // Dodaj powiƒôkszony obraz
 const img = document.createElement('img');
 img.src = imageUrl;
 img.alt = 'Powiƒôkszony obraz AI';
 img.style.cssText = `
 max-width: 90vw;
 max-height: 90vh;
 object-fit: contain;
 border-radius: 8px;
 box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
 `;
 
 // Przycisk zamkniƒôcia
 const closeBtn = document.createElement('button');
 closeBtn.innerHTML = '√ó';
 closeBtn.setAttribute('aria-label', 'Zamknij');
 closeBtn.style.cssText = `
 position: absolute;
 top: 20px;
 right: 20px;
 width: 40px;
 height: 40px;
 background: white;
 border: none;
 border-radius: 50%;
 cursor: pointer;
 font-size: 24px;
 font-weight: bold;
 color: #333;
 display: flex;
 align-items: center;
 justify-content: center;
 box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
 transition: all 0.2s ease;
 `;
 
 overlay.appendChild(img);
 overlay.appendChild(closeBtn);
 
 // Zamknij po klikniƒôciu overlay lub przycisku
 overlay.addEventListener('click', (e) => {
 if (e.target === overlay || e.target === closeBtn) {
 overlay.remove();
 console.log('üîç [CUSTOMIFY CHECKOUT] Lightbox zamkniƒôty');
 }
 });
 
 // Zamknij po ESC
 const handleEsc = (e) => {
 if (e.key === 'Escape') {
 overlay.remove();
 document.removeEventListener('keydown', handleEsc);
 console.log('üîç [CUSTOMIFY CHECKOUT] Lightbox zamkniƒôty (ESC)');
 }
 };
 document.addEventListener('keydown', handleEsc);
 
 document.body.appendChild(overlay);
 }
 
 function disableAIProductLinks() {
 console.log('üõí [CUSTOMIFY CHECKOUT] Wy≈ÇƒÖczam linki dla wszystkich produkt√≥w w checkout...');
 
 // Znajd≈∫ wszystkie elementy checkout (r√≥≈ºne selektory dla Shopify checkout)
 const checkoutItems = document.querySelectorAll(
 '.product, .product-thumbnail, [data-product-table], .order-summary__section--product-list .product, .review-block__content .product'
 );
 
 console.log('üõí [CUSTOMIFY CHECKOUT] Znaleziono element√≥w checkout:', checkoutItems.length);
 
 checkoutItems.forEach((item, index) => {
 // Znajd≈∫ wszystkie linki w tym elemencie
 const links = item.querySelectorAll('a[href*="/products/"]');
 console.log(`üîó [CUSTOMIFY CHECKOUT] Element ${index} - znaleziono link√≥w: ${links.length}`);
 
 links.forEach((link, linkIndex) => {
 // Znajd≈∫ obrazek w linku
 const img = link.querySelector('img');
 
 if (img) {
 // To jest link z miniaturkƒÖ - wy≈ÇƒÖcz i dodaj lightbox
 console.log(`üñºÔ∏è [CUSTOMIFY CHECKOUT] Link ${linkIndex} ma obrazek - dodajƒô lightbox`);
 
 link.addEventListener('click', (e) => {
 e.preventDefault();
 e.stopPropagation();
 showImageLightbox(img.src);
 });
 
 // Zmie≈Ñ cursor na zoom-in
 link.style.cursor = 'zoom-in';
 link.title = 'Kliknij aby powiƒôkszyƒá';
 } else {
 // To jest link z tytu≈Çem - wy≈ÇƒÖcz ca≈Çkowicie
 console.log(`üìù [CUSTOMIFY CHECKOUT] Link ${linkIndex} to tytu≈Ç - wy≈ÇƒÖczam`);
 
 link.addEventListener('click', (e) => {
 e.preventDefault();
 e.stopPropagation();
 });
 
 link.style.cursor = 'default';
 link.style.pointerEvents = 'none';
 link.style.textDecoration = 'none';
 }
 });
 });
 
 console.log(`‚úÖ [CUSTOMIFY CHECKOUT] Wy≈ÇƒÖczono linki dla ${checkoutItems.length} produkt√≥w`);
 }
 
 // Uruchom po za≈Çadowaniu DOM
 if (document.readyState === 'loading') {
 document.addEventListener('DOMContentLoaded', disableAIProductLinks);
 } else {
 disableAIProductLinks();
 }
 
 // Uruchom ponownie po zmianach (Shopify checkout mo≈ºe siƒô dynamicznie aktualizowaƒá)
 setTimeout(disableAIProductLinks, 1000);
 setTimeout(disableAIProductLinks, 2000);
 
 console.log('‚úÖ [CUSTOMIFY CHECKOUT] Inicjalizacja zako≈Ñczona');
 })();
 </script>

 {% comment %} CUSTOMIFY CUSTOMER REVIEWS {% endcomment %}
 {% if template contains 'product' %}
 <style>
 /* Style dla gwiazdek w opiniach - BARDZIEJ SPECYFICZNE */
 .customer-reviews-section .star,
 .stars-rating .star,
 .review-stars .star,
 .star {
 color: #ffc107 !important;
 font-size: 1.2rem !important;
 margin-right: 2px !important;
 display: inline-block !important;
 font-family: "Segoe UI Symbol", "Apple Color Emoji", "Noto Color Emoji", "Noto Sans Symbols", "Noto Sans Symbols2", "Arial Unicode MS", "DejaVu Sans", sans-serif !important;
 text-shadow: none !important;
 background: none !important;
 border: none !important;
 }
 
 .stars-rating {
 display: flex;
 align-items: center;
 gap: 5px;
 margin: 10px 0;
 }
 
 /* Style dla sekcji opinii klient√≥w */
 .customer-reviews-section {
 margin-top: 40px;
 padding: 30px 20px;
 background: #f8f9fa;
 border-radius: 12px;
 border: 1px solid #e9ecef;
 }
 
 .reviews-header {
 text-align: center;
 margin-bottom: 30px;
 }
 
 .reviews-title {
 font-size: 1.8rem;
 font-weight: 700;
 color: #333;
 margin: 0 0 15px 0;
 display: flex;
 align-items: center;
 justify-content: center;
 gap: 10px;
 }
 
 .reviews-link {
 color: #007bff;
 text-decoration: none;
 font-size: 0.9rem;
 font-weight: 500;
 }
 
 .reviews-link:hover {
 text-decoration: underline;
 }
 
 .reviews-grid {
 display: grid;
 grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
 gap: 20px;
 margin-top: 20px;
 }
 
 .review-card {
 background: white;
 padding: 20px;
 border-radius: 8px;
 border: 1px solid #e9ecef;
 box-shadow: 0 2px 4px rgba(0,0,0,0.1);
 }
 
 .review-header {
 display: flex;
 justify-content: space-between;
 align-items: center;
 margin-bottom: 10px;
 }
 
 .review-author {
 font-weight: 600;
 color: #333;
 }
 
 .review-date {
 color: #6c757d;
 font-size: 0.9rem;
 }
 
 .review-stars {
 margin-bottom: 15px;
 }
 
 .review-text {
 color: #555;
 line-height: 1.5;
 margin-bottom: 10px;
 font-style: italic;
 }
 
 .review-style {
 color: #007bff;
 font-weight: 600;
 font-size: 0.9rem;
 }
 </style>
 
 <div class="customer-reviews-section">
 <div class="reviews-header">
 <h2 class="reviews-title">
 ‚≠ê Opinie klient√≥w
 <a href="#customer-reviews" class="reviews-link">Zobacz wszystkie opinie</a>
 </h2>
 <div class="stars-rating">
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span style="margin-left: 10px; color: #6c757d; font-weight: 600;">4.9/5 (143 opinii)</span>
 </div>
 </div>
 
 <div class="reviews-grid" id="customer-reviews">
 <div class="review-card">
 <div class="review-header">
 <div class="review-author">Anna K.</div>
 <div class="review-date">15.01.2025</div>
 </div>
 <div class="review-stars">
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 </div>
 <div class="review-text">
 "Niesamowite! Moje zdjƒôcie w stylu anime wyglƒÖda jak prawdziwe dzie≈Ço sztuki. Jako≈õƒá druku na p≈Ç√≥tnie jest doskona≈Ça, kolory sƒÖ ≈ºywe i wyra≈∫ne. Polecam ka≈ºdemu!"
 </div>
 <div class="review-style">Styl: Anime</div>
 </div>

 <div class="review-card">
 <div class="review-header">
 <div class="review-author">Marcin W.</div>
 <div class="review-date">12.01.2025</div>
 </div>
 <div class="review-stars">
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 </div>
 <div class="review-text">
 "Zam√≥wi≈Çem portret w stylu Van Gogh dla ≈ºony na rocznicƒô. By≈Ça zachwycona! AI doskonale odtworzy≈Ço styl malarza. Szybka realizacja i ≈õwietna jako≈õƒá."
 </div>
 <div class="review-style">Styl: Van Gogh</div>
 </div>

 <div class="review-card">
 <div class="review-header">
 <div class="review-author">Katarzyna M.</div>
 <div class="review-date">10.01.2025</div>
 </div>
 <div class="review-stars">
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 </div>
 <div class="review-text">
 "Cyberpunk style to by≈Ç strza≈Ç w dziesiƒÖtkƒô! Moje zdjƒôcie wyglƒÖda jak z filmu sci-fi. P≈Ç√≥tno jest wysokiej jako≈õci, a kolory sƒÖ niesamowicie intensywne."
 </div>
 <div class="review-style">Styl: Cyberpunk</div>
 </div>

 <div class="review-card">
 <div class="review-header">
 <div class="review-author">Piotr L.</div>
 <div class="review-date">08.01.2025</div>
 </div>
 <div class="review-stars">
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 </div>
 <div class="review-text">
 "Akwarela wysz≈Ça przepiƒôknie! Delikatne kolory i miƒôkki styl idealnie pasujƒÖ do naszego salonu. ≈ªona ju≈º planuje kolejne zam√≥wienia."
 </div>
 <div class="review-style">Styl: Akwarela</div>
 </div>

 <div class="review-card">
 <div class="review-header">
 <div class="review-author">Magdalena S.</div>
 <div class="review-date">05.01.2025</div>
 </div>
 <div class="review-stars">
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 </div>
 <div class="review-text">
 "Monet style to czysta magia! Moje zdjƒôcie wyglƒÖda jak impresjonistyczne dzie≈Ço sztuki. Jako≈õƒá wykonania i szybko≈õƒá realizacji na najwy≈ºszym poziomie."
 </div>
 <div class="review-style">Styl: Monet</div>
 </div>

 <div class="review-card">
 <div class="review-header">
 <div class="review-author">Tomasz K.</div>
 <div class="review-date">03.01.2025</div>
 </div>
 <div class="review-stars">
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 </div>
 <div class="review-text">
 "Picasso style to prawdziwe dzie≈Ço sztuki! Abstrakcyjne formy i wyraziste kolory tworzƒÖ niesamowity efekt. Polecam ka≈ºdemu mi≈Ço≈õnikowi sztuki."
 </div>
 <div class="review-style">Styl: Picasso</div>
 </div>

 <div class="review-card">
 <div class="review-header">
 <div class="review-author">Agnieszka R.</div>
 <div class="review-date">01.01.2025</div>
 </div>
 <div class="review-stars">
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 <span class="star">‚òÖ</span>
 </div>
 <div class="review-text">
 "Renesans to absolutnie niesamowity styl! Moje zdjƒôcie wyglƒÖda jak prawdziwy portret z epoki renesansu. Dramatyczne ≈õwiat≈Ço i szczeg√≥≈Çy sƒÖ imponujƒÖce!"
 </div>
 <div class="review-style">Styl: Renesans</div>
 </div>
 </div>
 </div>
 {% endif %}

 {% if template == 'cart' %}
 <div class="page-width" style="margin: 60px auto; max-width: 1200px;">
 <div class="product-details-accordion">

 <div class="accordion-item" data-accordion="guarantee" style="border: 2px solid #4CAF50; border-radius: 8px; margin-bottom: 12px;">
 <div class="accordion-header" style="background: #E8F5E9;">
 <div class="accordion-title">
 <span style="font-weight: 700; color: #2E7D32;">Gwarancja satysfakcji</span>
 </div>
 <span class="accordion-icon">‚ñº</span>
 </div>
 <div class="accordion-content">
 <div style="background: #F1F8F4; padding: 16px; border-radius: 8px; margin-bottom: 12px;">
 <p style="font-size: 18px; font-weight: 600; color: #2E7D32; margin: 0 0 8px 0;">
 100% satysfakcji lub zwrot pieniƒôdzy
 </p>
 <p style="margin: 0; color: #555;">
 Je≈õli nie jeste≈õ zadowolony z jako≈õci wydruku, zwr√≥cimy 100% koszt√≥w. Bez pyta≈Ñ, bez problem√≥w.
 </p>
 </div>
 <ul style="margin: 12px 0; padding-left: 20px;">
 <li><strong>30 dni na zwrot</strong> - pe≈Çny zwrot koszt√≥w</li>
 <li><strong>Wsparcie na biuro@lumly.pl</strong>, zawsze pomo≈ºemy rozwiƒÖzaƒá problem</li>
 <li><strong>4.8/5 ocena klient√≥w</strong> - ponad 5000 zadowolonych klient√≥w</li>
 </ul>
 </div>
 </div>

 <div class="accordion-item" data-accordion="details">
 <div class="accordion-header">
 <div class="accordion-title">
 <span>O produkcie</span>
 </div>
 <span class="accordion-icon">‚ñº</span>
 </div>
 <div class="accordion-content">
 <p><strong>Obraz na p≈Ç√≥tnie</strong> - wydrukowane na grubym, premium p≈Ç√≥tnie canvas z naturalnƒÖ teksturƒÖ. NaciƒÖgniƒôte na drewnianƒÖ antyramƒô</p>

 <div class="accordion-product-visual">
 <div class="accordion-visual-item">
 <img src="https://customify-s56o.vercel.app/faq/obraz.png" alt="Obraz na p≈Ç√≥tnie" class="accordion-visual-image">
 </div>
 </div>
 
 <br>
 <p><strong>Plakat</strong> - wydruk na papierze fotograficznym, kt√≥ry wysy≈Çamy zwiniƒôty w eleganckiej tubie. Mo≈ºesz wybraƒá ramkƒô. W√≥wczas wydruk bƒôdzie w ramce za szk≈Çem.</p>

 <div class="accordion-product-visual">
 <div class="accordion-visual-item">
 <img src="https://customify-s56o.vercel.app/faq/plakat.png" alt="Plakat" class="accordion-visual-image">
 </div>
 </div>
 
 <br>
 <p><strong>Nadruk na szkle akrylowym</strong> - personalizowany wydruk na szkle akrylowym (bezpieczne niet≈ÇukƒÖce siƒô). Dodaj podstawkƒô, by postawiƒá go na biurku, mo≈ºesz dodaƒá podstawkƒô z LED, kt√≥ra pod≈õwietla zdjƒôcie i zamienia je w nastrojowƒÖ lampkƒô nocnƒÖ lub dekoracjƒô pokoju.</p>
 <p>Dostƒôpna jest w 2 rozmiarach: <strong>A5</strong> - najpopularniejszym i wiƒôkszym <strong>A4</strong>.</p>
 
 <div class="accordion-product-visual" style="margin: 15px 0;">
 <div class="accordion-visual-item">
 <img src="https://customify-s56o.vercel.app/ramki_wymiary.webp" alt="Rozmiary ramek na szkle" class="accordion-visual-image">
 </div>
 </div>
 <p>Przezroczysta pleksi nadaje zdjƒôciu elegancki po≈Çysk i g≈Çƒôbiƒô, dziƒôki czemu wyglƒÖda jak obraz za szk≈Çem. Produkt jest gotowy do wrƒôczenia jako prezent ‚Äî piƒôkny, nowoczesny i w pe≈Çni personalizowany.</p>

 <div class="accordion-product-visual">
 <div class="accordion-visual-item">
 <img src="https://customify-s56o.vercel.app/akryl/akryl.png" alt="Nadruk na szkle akrylowym" class="accordion-visual-image">
 </div>
 <div class="accordion-visual-item">
 <img src="https://customify-s56o.vercel.app/akryl/akryl_2.png" alt="Nadruk na szkle akrylowym z LED" class="accordion-visual-image">
 </div>
 </div>
 
 <br>
 <p><strong>Produkt cyfrowy</strong> ‚Äì plik w wysokiej jako≈õci, bez znak√≥w wodnych, do natychmiastowego pobrania (bez wysy≈Çki fizycznego obrazu).</p>
 
 <ul>
 <li>Otrzymujesz plik w wysokiej rozdzielczo≈õci, bez znak√≥w wodnych.</li>
 <li>Link do pobrania wysy≈Çamy natychmiast po op≈Çaceniu zam√≥wienia ‚Äì zero czekania na kuriera.</li>
 <li>Idealny do druku w domu lub fotolabie, jako tapeta na telefon/komputer albo do udostƒôpniania w social mediach.</li>
 </ul>
 
 <p><strong>To jest produkt cyfrowy ‚Äì nie wysy≈Çamy fizycznego obrazu.</strong></p>

 <div class="accordion-product-visual">
 <div class="accordion-visual-item">
 <img src="https://customify-s56o.vercel.app/icon_digital.png" alt="Produkt cyfrowy" class="accordion-visual-image">
 </div>
 </div>
 </div>
 </div>

 <div class="accordion-item" data-accordion="shipping">
 <div class="accordion-header">
 <div class="accordion-title">
 <span>Wysy≈Çka i dostawa</span>
 </div>
 <span class="accordion-icon">‚ñº</span>
 </div>
 <div class="accordion-content">
 <div style="background: #E3F2FD; padding: 12px; border-radius: 8px; margin-bottom: 12px;">
 <p style="margin: 0; font-weight: 600; color: #1976D2;">
 ‚ö° <strong>Szybka realizacja: 3-5 dni roboczych</strong> od akceptacji projektu
 </p>
 </div>
 <ul style="margin: 12px 0; padding-left: 20px;">
 <li><strong>üì¶ Bezpieczne opakowanie:</strong> Karton wzmocniony + folia bƒÖbelkowa - gwarancja bezpiecznej dostawy</li>
 <li><strong>üáµüá± Wysy≈Çka:</strong> InPost Paczkomaty, InPost Kurier</li>
 <li><strong>üìç ≈öledzenie przesy≈Çki:</strong> Numer trackingowy wysy≈Çany mailem - zawsze wiesz gdzie jest Twoja przesy≈Çka</li>
 <li><strong>üöö Darmowa dostawa:</strong> Przy zam√≥wieniach powy≈ºej 400 z≈Ç</li>
 <li><strong>‚è∞ Czas dostawy:</strong> 1-3 dni robocze (w zale≈ºno≈õci od wybranej opcji)</li>
 </ul>
 </div>
 </div>

 <div class="accordion-item" data-accordion="security">
 <div class="accordion-header">
 <div class="accordion-title">
 <span>üîí</span>
 <span>Bezpiecze≈Ñstwo i zaufanie</span>
 </div>
 <span class="accordion-icon">‚ñº</span>
 </div>
 <div class="accordion-content">
 <ul style="margin: 12px 0; padding-left: 20px;">
 <li><strong>üîê Bezpieczne p≈Çatno≈õci:</strong> SSL szyfrowanie, obs≈Çuga kart, BLIK, Przelewy24</li>
 <li><strong>üõ°Ô∏è Ochrona danych:</strong> Twoje zdjƒôcia sƒÖ bezpieczne - nie udostƒôpniamy ich osobom trzecim</li>
 <li><strong>üì∏ Usuwanie zdjƒôƒá:</strong> Po realizacji zam√≥wienia mo≈ºesz poprosiƒá o usuniƒôcie swoich zdjƒôƒá</li>
 <li><strong>‚úÖ Certyfikaty:</strong> Dzia≈Çamy zgodnie z RODO i przepisami UE</li>
 <li><strong>üí≥ Bezpieczne p≈Çatno≈õci:</strong> Wszystkie transakcje chronione przez Shopify Payments</li>
 </ul>
 <div style="margin-top: 16px; padding: 12px; background: #F5F5F5; border-radius: 8px; text-align: center;">
 <p style="margin: 0; font-size: 14px; color: #666;">
 üîí <strong>Bezpieczne zakupy</strong> - Twoje dane sƒÖ chronione
 </p>
 </div>
 </div>
 </div>

 <div class="accordion-item" data-accordion="sizes">
 <div class="accordion-header">
 <div class="accordion-title">
 <span>Dostƒôpne rozmiary</span>
 </div>
 <span class="accordion-icon">‚ñº</span>
 </div>
 <div class="accordion-content">
 
 <h4 style="margin: 0 0 15px 0; font-size: 1.1rem; color: #111; border-bottom: 2px solid #1DB954; padding-bottom: 8px;">üñºÔ∏è Plakat / Obraz na p≈Ç√≥tnie</h4>

 <div class="accordion-product-visual">
 <div class="accordion-visual-item">
 <img src="https://customify-s56o.vercel.app/faq/wymiary.png" alt="Dostƒôpne rozmiary" class="accordion-visual-image">
 <div class="accordion-visual-label">üìè Dostƒôpne rozmiary</div>
 </div>
 </div>
 
 <div class="accordion-size-grid">
 <div class="accordion-size-item">
 <div class="accordion-size-name">20 √ó 30 cm</div>
 <div class="accordion-size-description">≈öwietny do ma≈Çych pokoi</div>
 </div>
 <div class="accordion-size-item">
 <div class="accordion-size-name">30 √ó 45 cm</div>
 <div class="accordion-size-description">Doskona≈Çy do ≈õrednich pomieszcze≈Ñ</div>
 </div>
 <div class="accordion-size-item">
 <div class="accordion-size-name">40 √ó 60 cm</div>
 <div class="accordion-size-description">Efektowny na du≈ºe ≈õciany w salonie</div>
 </div>
 <div class="accordion-size-item">
 <div class="accordion-size-name">50 √ó 75 cm</div>
 <div class="accordion-size-description">Idealny do du≈ºych przestrzeni</div>
 </div>
 <div class="accordion-size-item">
 <div class="accordion-size-name">60 √ó 90 cm</div>
 <div class="accordion-size-description">ImponujƒÖcy na ca≈ÇƒÖ ≈õcianƒô</div>
 </div>
 </div>

 <h4 style="margin: 30px 0 15px 0; font-size: 1.1rem; color: #111; border-bottom: 2px solid #1DB954; padding-bottom: 8px;">üî≤ Wydruk na szkle</h4>
 
 <div class="accordion-product-visual">
 <div class="accordion-visual-item">
 <img src="https://customify-s56o.vercel.app/ramki_wymiary.webp" alt="Rozmiary ramek na szkle" class="accordion-visual-image">
 <div class="accordion-visual-label">üìè Rozmiary ramek na szkle</div>
 </div>
 </div>
 
 <div class="accordion-size-grid" style="margin-top: 15px;">
 <div class="accordion-size-item">
 <div class="accordion-size-name">A5 (15 √ó 21 cm)</div>
 <div class="accordion-size-description">Najpopularniejszy rozmiar</div>
 </div>
 <div class="accordion-size-item">
 <div class="accordion-size-name">A4 (21 √ó 30 cm)</div>
 <div class="accordion-size-description">Wiƒôkszy, bardziej efektowny</div>
 </div>
 </div>
 </div>
 </div>

 <div class="accordion-item" data-accordion="howto">
 <div class="accordion-header">
 <div class="accordion-title">
 <span>üí°</span>
 <span>Jak to dzia≈Ça?</span>
 </div>
 <span class="accordion-icon">‚ñº</span>
 </div>
 <div class="accordion-content">
 <div class="accordion-step">
 <div class="accordion-step-number">1</div>
 <div class="accordion-step-content">
 <strong>Wgraj swoje zdjƒôcie</strong><br>
 JPG, PNG lub GIF do 10MB. Najlepiej w wysokiej rozdzielczo≈õci.<br>
 <em style="color: #666; font-size: 0.9em;">Nie musisz siƒô martwiƒá o jako≈õƒá - sprawdzamy ka≈ºde zdjƒôcie przed wydrukiem i poprawiamy je, aby by≈Ço idealne!</em>
 </div>
 </div>
 <div class="accordion-step">
 <div class="accordion-step-number">2</div>
 <div class="accordion-step-content">
 <strong>Wybierz styl artystyczny</strong><br>
 Dostƒôpne style do wyboru w zak≈Çadce powy≈ºej.
 </div>
 </div>
 <div class="accordion-step">
 <div class="accordion-step-number">3</div>
 <div class="accordion-step-content">
 <strong>Wybierz rozmiar wydruku</strong><br>
 Wybierz idealny rozmiar dla Twojej przestrzeni.
 </div>
 </div>
 <div class="accordion-step">
 <div class="accordion-step-number">4</div>
 <div class="accordion-step-content">
 <strong>AI przekszta≈Çci Twoje zdjƒôcie</strong><br>
 Najnowocze≈õniejsza technologia sztucznej inteligencji w 30-60 sekund.
 </div>
 </div>
 <div class="accordion-step">
 <div class="accordion-step-number">5</div>
 <div class="accordion-step-content">
 <strong>Drukujemy i wysy≈Çamy</strong><br>
 Ka≈ºde zdjƒôcie jest sprawdzane i poprawiane przed wydrukiem. Wysokiej jako≈õci nadruk, bezpiecznie zapakowany.
 </div>
 </div>
 </div>
 </div>

 </div>
 </div>

 <script>
 document.addEventListener('DOMContentLoaded', function() {
 console.log('üõí [CART] Initializing cart accordion...');
 
 // Znajd≈∫ wszystkie accordion items na stronie koszyka
 const accordionItems = document.querySelectorAll('.accordion-item');
 
 if (!accordionItems || accordionItems.length === 0) {
 console.log('‚ö†Ô∏è [CART] No accordion items found');
 return;
 }
 
 console.log('‚úÖ [CART] Found', accordionItems.length, 'accordion items');
 
 // Dodaj event listener do ka≈ºdego accordion header
 accordionItems.forEach((item, index) => {
 const header = item.querySelector('.accordion-header');
 
 if (!header) {
 console.log('‚ö†Ô∏è [CART] No header found for item', index);
 return;
 }
 
 // Event listener - toggle klasy expanded
 header.addEventListener('click', () => {
 const isExpanded = item.classList.contains('expanded');
 
 if (isExpanded) {
 // Zwi≈Ñ
 item.classList.remove('expanded');
 console.log('üîΩ [CART] Collapsed:', item.dataset.accordion);
 } else {
 // Rozwi≈Ñ
 item.classList.add('expanded');
 console.log('üîº [CART] Expanded:', item.dataset.accordion);
 }
 });
 
 console.log('‚úÖ [CART] Accordion item', index, 'setup complete');
 });
 
 console.log('‚úÖ [CART] Cart accordion setup complete!');
 });
 </script>
 {% endif %}

 <div class="customify-footer-poradnik">
 <a href="/blogs/poradnik" class="customify-footer-poradnik__link">Poradnik</a>
 </div>

 {% sections 'footer-group' %}

 <script>
 document.addEventListener('DOMContentLoaded', function() {
 // Sprawd≈∫ czy jeste≈õmy na stronie kontakt
 if (window.location.pathname.includes('/pages/kontakt') || window.location.pathname.includes('/policies/contact-information')) {
 // Czekaj chwilƒô, ≈ºeby DOM siƒô za≈Çadowa≈Ç
 setTimeout(function() {
 // Znajd≈∫ g≈Ç√≥wnƒÖ tre≈õƒá strony - szukaj po r√≥≈ºnych selektorach
 let targetElement = null;
 
 // Pr√≥buj znale≈∫ƒá g≈Ç√≥wnƒÖ sekcjƒô z tre≈õciƒÖ
 const selectors = [
 '#MainContent',
 'main',
 '.main-content',
 '.page-content',
 '.rte',
 '.page__content',
 '.page-content-wrapper',
 '[class*="policy"]',
 '[class*="content"]',
 'article',
 '.content-for-layout',
 '[class*="page"]'
 ];
 
 for (const selector of selectors) {
 const element = document.querySelector(selector);
 if (element && element.offsetHeight > 0) {
 targetElement = element;
 break;
 }
 }
 
 // Je≈õli nie znaleziono, szukaj po nag≈Ç√≥wku h1
 if (!targetElement) {
 const h1 = document.querySelector('h1');
 if (h1) {
 // Znajd≈∫ najbli≈ºszy kontener z tre≈õciƒÖ
 targetElement = h1.closest('div, section, article, main') || h1.parentElement;
 }
 }
 
 // Ostatecznie u≈ºyj body, ale znajd≈∫ miejsce przed footerem
 if (!targetElement) {
 const footer = document.querySelector('footer, [class*="footer"]');
 if (footer) {
 targetElement = footer;
 } else {
 targetElement = document.body;
 }
 }
 
 if (targetElement) {
 // Utw√≥rz formularz kontaktowy
 const contactFormHTML = `
 <div id="contact-form-container" style="
 max-width: 600px;
 margin: 40px auto;
 padding: 30px;
 background: #fff;
 border-radius: 8px;
 box-shadow: 0 2px 8px rgba(0,0,0,0.1);
 ">
 <h2 style="
 font-size: 24px;
 font-weight: 600;
 margin-bottom: 20px;
 color: #333;
 ">Wy≈õlij wiadomo≈õƒá</h2>
 
 <form id="contactForm" style="display: flex; flex-direction: column; gap: 16px;">
 <div>
 <label for="contactName" style="display: block; margin-bottom: 6px; font-weight: 500; color: #555;">
 Imiƒô i nazwisko *
 </label>
 <input 
 type="text" 
 id="contactName" 
 name="name" 
 required
 style="
 width: 100%;
 padding: 12px;
 border: 1px solid #ddd;
 border-radius: 4px;
 font-size: 16px;
 box-sizing: border-box;
 "
 >
 </div>
 
 <div>
 <label for="contactEmail" style="display: block; margin-bottom: 6px; font-weight: 500; color: #555;">
 Email *
 </label>
 <input 
 type="email" 
 id="contactEmail" 
 name="email" 
 required
 style="
 width: 100%;
 padding: 12px;
 border: 1px solid #ddd;
 border-radius: 4px;
 font-size: 16px;
 box-sizing: border-box;
 "
 >
 </div>
 
 <div>
 <label for="contactSubject" style="display: block; margin-bottom: 6px; font-weight: 500; color: #555;">
 Temat
 </label>
 <input 
 type="text" 
 id="contactSubject" 
 name="subject"
 style="
 width: 100%;
 padding: 12px;
 border: 1px solid #ddd;
 border-radius: 4px;
 font-size: 16px;
 box-sizing: border-box;
 "
 >
 </div>
 
 <div>
 <label for="contactMessage" style="display: block; margin-bottom: 6px; font-weight: 500; color: #555;">
 Wiadomo≈õƒá *
 </label>
 <textarea 
 id="contactMessage" 
 name="message" 
 required
 rows="6"
 style="
 width: 100%;
 padding: 12px;
 border: 1px solid #ddd;
 border-radius: 4px;
 font-size: 16px;
 font-family: inherit;
 box-sizing: border-box;
 resize: vertical;
 "
 ></textarea>
 </div>
 
 <button 
 type="submit"
 style="
 background: #000;
 color: #fff;
 padding: 14px 28px;
 border: none;
 border-radius: 4px;
 font-size: 16px;
 font-weight: 600;
 cursor: pointer;
 transition: background 0.2s;
 "
 onmouseover="this.style.background='#333'"
 onmouseout="this.style.background='#000'"
 >
 Wy≈õlij wiadomo≈õƒá
 </button>
 
 <div id="contactFormMessage" style="
 margin-top: 12px;
 padding: 12px;
 border-radius: 4px;
 display: none;
 "></div>
 </form>
 </div>
 `;
 
 // Je≈õli targetElement to footer, dodaj przed nim
 if (targetElement.tagName === 'FOOTER' || targetElement.className.includes('footer')) {
 targetElement.insertAdjacentHTML('beforebegin', contactFormHTML);
 } else {
 // W przeciwnym razie dodaj na ko≈Ñcu elementu
 targetElement.insertAdjacentHTML('beforeend', contactFormHTML);
 }
 
 // Obs≈Çuga formularza
 const form = document.getElementById('contactForm');
 const messageDiv = document.getElementById('contactFormMessage');
 
 if (form) {
 form.addEventListener('submit', async function(e) {
 e.preventDefault();
 
 const formData = {
 name: document.getElementById('contactName').value,
 email: document.getElementById('contactEmail').value,
 subject: document.getElementById('contactSubject').value || 'Kontakt ze strony',
 message: document.getElementById('contactMessage').value
 };
 
 // Wy≈ÇƒÖcz przycisk podczas wysy≈Çania
 const submitBtn = form.querySelector('button[type="submit"]');
 submitBtn.disabled = true;
 submitBtn.textContent = 'Wysy≈Çanie...';
 
 try {
 const response = await fetch('https://customify-s56o.vercel.app/api/contact-form', {
 method: 'POST',
 headers: {
 'Content-Type': 'application/json'
 },
 body: JSON.stringify(formData)
 });
 
 const result = await response.json();
 
 if (response.ok && result.success) {
 messageDiv.style.display = 'block';
 messageDiv.style.background = '#E8F5E9';
 messageDiv.style.color = '#2E7D32';
 messageDiv.textContent = '‚úÖ ' + result.message;
 form.reset();
 } else {
 throw new Error(result.error || 'B≈ÇƒÖd wysy≈Çania wiadomo≈õci');
 }
 } catch (error) {
 messageDiv.style.display = 'block';
 messageDiv.style.background = '#FFEBEE';
 messageDiv.style.color = '#C62828';
 messageDiv.textContent = '‚ùå B≈ÇƒÖd: ' + error.message;
 } finally {
 submitBtn.disabled = false;
 submitBtn.textContent = 'Wy≈õlij wiadomo≈õƒá';
 }
 }); // Zamknij addEventListener
 } // Zamknij if (form)
 } // Zamknij if (targetElement)
 }, 500); // Czekaj 500ms na za≈Çadowanie DOM
 }
 });
 </script>

 </body>
</html>{% comment %} Cache bust: 1761686705 {% endcomment %}
